(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-58babbc0"],{"00a4":function(e,t,o){},"048a":function(e,t,o){"use strict";o("00a4")},"0bb4":function(e,t,o){},"3a8c":function(e,t,o){"use strict";function n(e){return parseInt(e.split("-")[2])||0}o.d(t,"a",(function(){return n}))},"40e3":function(e,t,o){"use strict";o.d(t,"c",(function(){return d})),o.d(t,"a",(function(){return O})),o.d(t,"b",(function(){return j}));var n=o("4971"),a=o("2ef0"),r=o("1c74"),c=o("5a0c"),l=o.n(c),i=o("8baf"),s=o("0da4"),u=o.n(s);function d(e){try{return e.replace(/<(?:.|\n)*?>/gm," ").replace(/\n/g," ").replace(/\t/g," ").replace(/\s{2,}/g," ").replace(/=/g," ").replace(/,/g," ").trim()}catch(t){return e}}function p(){const e=r["e"].getUserName();return{encryption:{userPassword:e,ownerPassword:e,userPermissions:["print"]}}}function b(e,t){return t||!1!==e.exportable}function m(e,t=!1){return e.filter(e=>b(e,t)).map(e=>e.label)}function v(e,t,o=!1){return t.map(t=>e.filter(e=>b(e,o)).map(e=>{let o=Object(a["get"])(t,e.path);return"function"===typeof e.formatter&&o&&(o=e.formatter(o,t)),d(e.drillable&&Array.isArray(o)?o.length:o)}))}function f(e){const{columns:t,rows:o,quarter:a,period:c,filters:i,safeMode:s}=e,u=m(t,s),d=v(t,Object(n["sortRows"])(o,(null===i||void 0===i?void 0:i.sort)||[]),s);let p=u.join(",")+"\n";return p+=d.map(e=>e.join(",")).join("\n"),p+="\nDate Created:  "+l()().format("DD/MMM/YYYY HH:MM:ss"),a&&(p+="\nQuarter: "+a),c&&(p+="\nQuarter: "+c),p+="\ne-Mastercard Version : "+r["e"].getAppVersion(),p+="\nAPI Version "+r["e"].getApiVersion(),p+="\nSite UUID: "+r["e"].getSiteUUID(),p}function O(e){const t=new Blob([f(e)],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=window.URL.createObjectURL(t),o.setAttribute("download",e.filename+".csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function j(e){const{filename:t,canHorizontalPageBreak:o,columns:a,rows:r,filters:c,safeMode:l}=e,s=[m(a,l)],b=v(a,Object(n["sortRows"])(r,(null===c||void 0===c?void 0:c.sort)||[]),l),f=l?p():{},O=new i["default"]({...f}),j=O.splitTextToSize(d(t),180),h=j.length<=1?20:10*j.length;O.text(j,14,10);const C={startY:h,head:s,body:b};o&&(C.tableWidth="wrap",C.horizontalPageBreak=!0,C.horizontalPageBreakRepeat=0),u()(O,C);const w=t+".pdf";O.save(w)}},"564f":function(e,t,o){"use strict";var n=o("7a23");function a(e,t,o,a,r,c){const l=Object(n["resolveComponent"])("IonIcon"),i=Object(n["resolveComponent"])("IonButton"),s=Object(n["resolveComponent"])("IonButtons"),u=Object(n["resolveComponent"])("IonTitle"),d=Object(n["resolveComponent"])("IonToolbar"),p=Object(n["resolveComponent"])("IonHeader"),b=Object(n["resolveComponent"])("data-table"),m=Object(n["resolveComponent"])("IonContent"),v=Object(n["resolveComponent"])("IonPage");return Object(n["openBlock"])(),Object(n["createBlock"])(v,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(p,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(d,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(s,{slot:"end"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i,{slot:"end",onClick:t[0]||(t[0]=t=>e.modal.hide()),"icon-only":""},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(l,{icon:e.close},null,8,["icon"])]),_:1})]),_:1}),Object(n["createVNode"])(u,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(n["createVNode"])(m,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(b,{rows:e.rows,"async-rows":e.asyncRows,columns:e.columns,"row-actions-buttons":e.rowActionButtons,"actions-buttons":e.actionBtns,color:"custom"},null,8,["rows","async-rows","columns","row-actions-buttons","actions-buttons"])]),_:1})]),_:1})}o("14d9");var r=o("d867"),c=o("4971"),l=o("ff79"),i=o("da44"),s=o("5a0c"),u=o.n(s),d=o("40e3"),p=Object(n["defineComponent"])({name:"DrilldownTable",components:{DataTable:c["DataTable"],IonButton:r["IonButton"],IonPage:r["IonPage"],IonHeader:r["IonHeader"],IonContent:r["IonContent"],IonToolbar:r["IonToolbar"],IonButtons:r["IonButtons"],IonTitle:r["IonTitle"],IonIcon:r["IonIcon"]},props:{title:{type:String,default:"Report"},rows:{type:Array,default:()=>[]},asyncRows:{type:Function},columns:{type:Array,default:()=>[]},rowActionButtons:{type:Array,default:()=>[]},actionButtons:{type:Array,default:()=>[]},canExportCsv:{type:Boolean,default:!0},period:{type:String,default:""}},setup(e){const t=Object(n["computed"])(()=>{const t=[...e.actionButtons];return e.canExportCsv&&t.push({label:"CSV",color:"primary",action:async(t,o,n,a)=>Object(d["a"])({rows:o,filters:n,columns:a,period:e.period.includes("Custom")?e.period.substring(6):e.period,filename:`${e.title}-${u()().format("DD-MMM-YYYY")}`})}),t});return{close:l["close"],modal:i["a"],actionBtns:t}}}),b=o("6b0d"),m=o.n(b);const v=m()(p,[["render",a]]);t["a"]=v},"5efc":function(e,t,o){"use strict";o.r(t);var n=o("7a23");function a(e,t,o,a,r,c){const l=Object(n["resolveComponent"])("SelectInput"),i=Object(n["resolveComponent"])("ion-col"),s=Object(n["resolveComponent"])("DateRangePicker"),u=Object(n["resolveComponent"])("ion-button"),d=Object(n["resolveComponent"])("ion-row"),p=Object(n["resolveComponent"])("cohort-v"),b=Object(n["resolveComponent"])("cohort-h"),m=Object(n["resolveComponent"])("cohort-ft"),v=Object(n["resolveComponent"])("ion-grid");return Object(n["openBlock"])(),Object(n["createBlock"])(v,null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(d,null,{default:Object(n["withCtx"])(()=>{var o,a;return[Object(n["createVNode"])(i,{size:"2"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(l,{modelValue:e.quarter,"onUpdate:modelValue":t[0]||(t[0]=t=>e.quarter=t),options:e.quarters},null,8,["modelValue","options"])]),_:1}),"Custom"===(null===(o=e.quarter.value)||void 0===o?void 0:o.label)?(Object(n["openBlock"])(),Object(n["createBlock"])(i,{key:0,size:"3"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(s,{modelValue:e.dateRange,"onUpdate:modelValue":[t[1]||(t[1]=t=>e.dateRange=t),e.onDateRangeChange]},null,8,["modelValue","onUpdate:modelValue"])]),_:1})):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(i,{size:"Custom"===(null===(a=e.quarter.value)||void 0===a?void 0:a.label)?7:10},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(u,{class:"ion-float-right",color:"primary",onClick:e.exportToCsv},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Export CSV")]),_:1},8,["onClick"]),Object(n["createVNode"])(u,{class:"ion-float-right",color:"primary",onClick:e.printSpec},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Print Report")]),_:1},8,["onClick"]),Object(n["createVNode"])(u,{class:"ion-float-right",color:"secondary",onClick:e.disaggregateReport},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Disaggregated")]),_:1},8,["onClick"]),Object(n["createVNode"])(u,{class:"ion-float-right",color:"warning",onClick:t[2]||(t[2]=t=>e.fetchData(!0))},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Fresh Report")]),_:1}),Object(n["createVNode"])(u,{class:"ion-float-right",color:"success",onClick:e.fetchData},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])("Archived Report")]),_:1},8,["onClick"])]),_:1},8,["size"])]}),_:1}),Object(n["createVNode"])(d,{class:"his-card"},{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(),Object(n["createBlock"])(i,{size:"12",key:e.componentKey,id:"report-content"},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(p,{indicators:e.indicators,style:{"font-weight":"600"}},null,8,["indicators"]),Object(n["createVNode"])(b,{reportparams:e.period,clinicName:e.clinicName},null,8,["reportparams","clinicName"]),Object(n["createVNode"])(m,{onOnClickIndicator:e.onDrilldown,indicators:e.indicators,site:"E-Mastercard"},null,8,["onOnClickIndicator","indicators"])]),_:1}))]),_:1})]),_:1})}o("14d9"),o("13d5");var r=o("b211"),c=o("da44"),l=o("564f"),i=o("b5e4"),s=o("2ef0"),u=o("7717"),d=o("5969"),p=o("b31c"),b=o("bdc2"),m=o("364b"),v=o("0795"),f=o("d867"),O=o("bef6"),j=o("ba82"),h=o("1c74"),C=o("be95"),w=o("9283"),g=o("0011"),y=o("3a8c"),k=o("5a0c"),V=o.n(k),I=o("6605"),x=Object(n["defineComponent"])({name:"Cohort",components:{DateRangePicker:u["a"],CohortH:b["a"],CohortV:m["a"],CohortFt:v["a"],IonCol:f["IonCol"],IonRow:f["IonRow"],IonGrid:f["IonGrid"],SelectInput:C["a"]},setup(){const e=Object(I["i"])(),t=Object(n["ref"])(0),o=Object(n["reactive"])({value:"",placeholder:"Select Quarter"}),a=Object(n["ref"])(""),u=Object(n["ref"])(),b=Object(n["reactive"])({}),m=Object(n["ref"])({}),v=Object(n["ref"])({}),f=Object(n["ref"])(""),C=p["a"].getLocationName(),k=new p["a"],x=[{label:"Custom",value:"Custom"},...d["a"].getReportQuarters(6).map(e=>({label:e.name,value:e.name,other:e}))];Object(n["watch"])(o,()=>{var e;"Custom"===(null===(e=o.value)||void 0===e?void 0:e.label)&&Object.assign(b,{start:"",end:""})});const B=e=>{Object.assign(b,e)},N=()=>{u.value?e.push("/emc_moh_cohort_disaggregated?"+u.value):Object(i["e"])("Please select a period")},D=async t=>{const o=[{path:"arv_number",label:"ARV Number",preSort:y["a"],initialSort:!0},{path:"given_name",label:"First Name",exportable:!1},{path:"family_name",label:"Last Name",exportable:!1},{path:"birthdate",label:"Date of Birth",formatter:w["c"].toStandardHisDisplayFormat},{path:"gender",label:"Gender",formatter:g["g"]},{path:"outcome",label:"Outcome"}],n=Object(s["find"])(v.value,{name:t});if(!n)return;const a=await k.getCohortDrillDown(n.id),r=[{label:"select",action:t=>e.push("/emc/patient/"+t["person_id"])}];await c["a"].show(l["a"],{title:n["indicator_name"]||"Drill down",rowActionButtons:r,columns:o,rows:a})},E=(e,t,o)=>{k.setQuarter(e),k.setStartDate(t),k.setEndDate(o)},S=e=>e.reduce((e,t)=>(e[t.name]=parseInt(t.contents),e),{}),_=async(e=!1)=>{var n;if(Object(s["isEmpty"])(o.value)&&Object(s["isEmpty"])(b)||"Custom"===o.value&&Object(s["isEmpty"])(b))return Object(i["e"])("Please select report period");r["a"].show();let c={},l="",d="";var p,j,h,C;(m.value={},v.value={},k.setRegenerate(e),"Custom"===(null===(n=o.value)||void 0===n?void 0:n.label))?(l=b.start,d=b.end,E(o.value,l,d),a.value="Custom "+k.getDateIntervalPeriod(),c=k.datePeriodRequestParams()):(l=w["c"].toStandardHisFormat(null===(p=o.value)||void 0===p?void 0:p.other.start),d=w["c"].toStandardHisFormat(null===(j=o.value)||void 0===j?void 0:j.other.end),E(null===(h=o.value)||void 0===h?void 0:h.label,l,d),a.value=null===(C=o.value)||void 0===C?void 0:C.label,c=k.qaurterRequestParams());u.value=O["a"].parameterizeObjToString({start_date:l,end_date:d,quarter:o.value.label});const g=await k.requestCohort(c);if(null!==g&&void 0!==g&&g.ok){const e=setInterval(async()=>{c.regenerate=!1;const o=await k.requestCohort(c);if(200===(null===o||void 0===o?void 0:o.status)){const n=await o.json();f.value=n.id,v.value=n.values,m.value=S(n.values),await r["a"].hide(),k.cacheCohort(n.values),clearInterval(e),t.value++}},3e3)}},P=async()=>{const e=open("","","width:1024px, height:768px"),t=document.getElementById("report-content");t&&e&&(e.document.write(`\n            <html>\n              <head>\n                <title>Print Cohort</title>\n                <link rel="stylesheet" media="print" href="/assets/css/cohort.css" />\n              </head>\n              <body>\n                ${t.innerHTML}\n              </body>\n            </html>\n          `),setTimeout(()=>{e.print(),e.close()},3500))},T=()=>{var e;const t=["Indicator","Value"],n=Object.keys(m.value).map(e=>[e,m.value[e]]),r=`MOH ${h["e"].getLocationName()} cohort report ${a.value}`;Object(j["a"])([t],[...n,["Date Created: "+V()().format("DD/MMM/YYYY HH:MM:ss")],["Quarter: "+(null!==(e=o.value)&&void 0!==e&&e.label.match(/custom/i)?`${b.start} - ${b.end}`:o.value.value)],["HIS-Core Version: "+h["e"].getCoreVersion()],["API Version: "+h["e"].getApiVersion()],["Site: "+h["e"].getLocationName()],["Site UUID: "+h["e"].getSiteUUID()]],r)};return{period:a,quarter:o,quarters:x,dateRange:b,clinicName:C,indicators:m,componentKey:t,fetchData:_,onDrilldown:D,disaggregateReport:N,printSpec:P,exportToCsv:T,onDateRangeChange:B}}}),B=(o("c833"),o("6b0d")),N=o.n(B);const D=N()(x,[["render",a]]);t["default"]=D},6361:function(e,t,o){"use strict";o("0bb4")},7322:function(e,t,o){"use strict";var n,a;o.d(t,"a",(function(){return n})),o.d(t,"b",(function(){return a})),function(e){e["Documents"]="DOCUMENTS",e["Data"]="DATA",e["Library"]="LIBRARY",e["Cache"]="CACHE",e["External"]="EXTERNAL",e["ExternalStorage"]="EXTERNAL_STORAGE"}(n||(n={})),function(e){e["UTF8"]="utf8",e["ASCII"]="ascii",e["UTF16"]="utf16"}(a||(a={}))},7717:function(e,t,o){"use strict";var n=o("7a23");const a={class:"date-picker-wrapper"},r=["value"],c=["value"];function l(e,t,o,l,i,s){const u=Object(n["resolveComponent"])("ion-icon"),d=Object(n["resolveComponent"])("date-picker");return Object(n["openBlock"])(),Object(n["createBlock"])(d,{modelValue:e.range,"onUpdate:modelValue":t[0]||(t[0]=t=>e.range=t),"is-range":"",masks:e.masks,popover:e.popover},{default:Object(n["withCtx"])(({inputValue:t,inputEvents:o})=>[Object(n["createElementVNode"])("div",a,[Object(n["createElementVNode"])("input",Object(n["mergeProps"])({value:t.start,class:"box date-picker-input"},Object(n["toHandlers"])(o.start,!0),{placeholder:"DD/MMM/YYYY"}),null,16,r),Object(n["createVNode"])(u,{icon:e.arrowForward,class:"date-picker-icon"},null,8,["icon"]),Object(n["createElementVNode"])("input",Object(n["mergeProps"])({value:t.end,class:"box date-picker-input"},Object(n["toHandlers"])(o.start,!0),{placeholder:"DD/MMM/YYYY"}),null,16,c)])]),_:1},8,["modelValue","masks","popover"])}var i=o("d867"),s=o("ff79"),u=o("0261"),d=o("9283"),p=Object(n["defineComponent"])({name:"DateRangePicker",components:{IonIcon:i["IonIcon"],DatePicker:u["b"]},props:{modelValue:{type:Object,default:()=>({start:"",end:""})}},emits:["update:modelValue"],setup(e,{emit:t}){const o=Object(n["ref"])({input:"DD/MMM/YYYY"}),a=Object(n["ref"])({visibility:"click"}),r=Object(n["computed"])({get:()=>e.modelValue,set:({start:e,end:o})=>t("update:modelValue",{start:d["c"].toStandardHisFormat(e),end:d["c"].toStandardHisFormat(o)})});return{arrowForward:s["arrowForward"],range:r,masks:o,popover:a}}}),b=(o("6361"),o("6b0d")),m=o.n(b);const v=m()(p,[["render",l],["__scopeId","data-v-4991088d"]]);t["a"]=v},ba82:function(e,t,o){"use strict";o.d(t,"b",(function(){return k})),o.d(t,"a",(function(){return V})),o.d(t,"c",(function(){return I}));o("13d5"),o("5b81");var n=o("8baf"),a=o("0da4"),r=o.n(a),c=o("1547"),l=o("7322");const i=Object(c["c"])("Filesystem",{web:()=>o.e("chunk-2d0a4885").then(o.bind(null,"079a")).then(e=>new e.FilesystemWeb)});var s=o("2ed9"),u=o("b5e4");const d=Object(c["c"])("BlobWriter");function p(e){return window.btoa(Array.from(new Uint8Array(e)).map((function(e){return String.fromCharCode(e)})).join(""))}function b({path:e,directory:t,blob:o,recursive:n}){return i.writeFile({directory:t,path:e,recursive:n,data:""}).then((function(){return new Promise((function(n,a){function r(e){a(e.target.error)}const c=window.indexedDB.open("Disc");c.onerror=r,c.onsuccess=function(){const a=c.result,l=a.transaction("FileStorage","readwrite");l.onerror=r;const i=l.objectStore("FileStorage"),s=`/${t}/${e.replace(/^\//,"")}`,u=i.get(s);u.onsuccess=function(){u.result.size=o.size,u.result.content=o;const e=i.put(u.result);e.onsuccess=function(){n(void 0)}}}}))}))}function m({path:e,directory:t,blob:o,recursive:n}){return i.writeFile({directory:t,path:e,recursive:n,data:""}).then((function n(){if(0===o.size)return Promise.resolve();const a=393216,r=o.slice(0,a);return o=o.slice(a),new Response(r).arrayBuffer().then((function(o){return i.appendFile({directory:t,path:e,data:p(o)})})).then(n)}))}function v(e){const{path:t,directory:o,blob:n,fast_mode:a=!1,recursive:r,on_fallback:l}=e;return"web"===c["a"].getPlatform()?a?b(e):m(e):Promise.all([d.get_config(),i.getUri({path:t,directory:o})]).then((function([e,t]){const o=t.uri.replace("file://","");return fetch(e.base_url+o+(r?"?recursive=true":""),{headers:{authorization:e.auth_token},method:"put",body:n}).then((function(e){if(204!==e.status)throw new Error("Bad HTTP status: "+e.status);return t.uri}))})).catch((function(t){return void 0!==l&&l(t),m(e)}))}var f=Object.freeze(v),O=o("6b70"),j=function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return j(t,e),t.prototype.fromURL=function(e,t){return Object(O["b"])(this,"fromURL",{otherPromise:!0},arguments)},t.prototype.fromData=function(e,t){return Object(O["b"])(this,"fromData",{otherPromise:!0},arguments)},t.pluginName="PDFGenerator",t.plugin="cordova-pdf-generator",t.pluginRef="cordova.plugins.pdf",t.repo="https://github.com/cesarvr/pdf-generator",t.platforms=["Android","iOS"],t}(O["a"]),C=new h,w=o("1c74");function g(e){return e.reduce((e,t)=>e+t.map(e=>`"${e}"`).join(",")+"\n","")}function y(e,t,o){let n=null;const a="HIS-Core/"+e.replaceAll("/","_");Object(u["d"])(`Exporting file to "Documents/${a}"...`),n="blob"===o?f({path:a,blob:t,directory:l["a"].Documents,recursive:!0}):i.writeFile({path:a,data:t,directory:l["a"].Documents,encoding:l["b"].UTF8,recursive:!0}),null!=n&&n.then(()=>Object(u["d"])(`File exported to "Documents/${a}"!`,3e3)).catch(e=>Object(u["c"])(e))}function k(e){const{activePlatformProfile:t}=Object(s["e"])();if(t.value.fileExport===s["a"].FILE_SYSTEM)C.fromData(e,{documentSize:"a4",type:"share"}).catch(e=>Object(u["c"])(e));else if(t.value.fileExport===s["a"].WEB){const t=open("","","width:1024px, height:768px");t&&(null===t||void 0===t||t.document.write(e),setTimeout(()=>{t.print(),t.close()},3500))}else Object(u["e"])("Platform not supported")}function V(e,t,o="document"){const n=g(e.concat(t)),{activePlatformProfile:a}=Object(s["e"])(),r=o+".csv",c=w["e"].isPocSite();if(c&&a.value.fileExport!==s["a"].WEB)a.value.fileExport===s["a"].FILE_SYSTEM?y(r,n,"text"):Object(u["e"])("Platform not supported");else{const e=new Blob([n],{type:"text/csv;charset=utf-8;"}),t=document.createElement("a");t.setAttribute("id","csv"),t.href=window.URL.createObjectURL(e),t.setAttribute("download",o+".csv"),document.body.appendChild(t),t.click(),t.remove()}}function I(e,t,o="document",a=!1,c={}){const l=new n["default"]({...c}),i=l.splitTextToSize(o,180),d=i.length<=1?20:10*i.length;l.text(i,14,10);const p={startY:d,head:[e[e.length-1]],body:t};a&&(p.tableWidth="wrap",p.horizontalPageBreak=!0,p.horizontalPageBreakRepeat=0),r()(l,p);const{activePlatformProfile:b}=Object(s["e"])(),m=o+".pdf";b.value.fileExport===s["a"].WEB?l.save(m):b.value.fileExport===s["a"].FILE_SYSTEM?y(m,l.output(),"blob"):Object(u["c"])("Platform not supported")}},be95:function(e,t,o){"use strict";var n=o("7a23");const a={key:0,class:"text-danger"},r={key:1,class:"ion-float-right ion-margin-end checkbox-label"},c={class:"inner-input-box"},l={key:0,class:"input-options"},i={class:"input-icon"};function s(e,t,o,s,u,d){const p=Object(n["resolveComponent"])("ion-checkbox"),b=Object(n["resolveComponent"])("ion-label"),m=Object(n["resolveComponent"])("ion-input"),v=Object(n["resolveComponent"])("ion-icon"),f=Object(n["resolveComponent"])("ion-chip"),O=Object(n["resolveComponent"])("ion-item"),j=Object(n["resolveComponent"])("ion-list"),h=Object(n["resolveComponent"])("ion-note");return Object(n["openBlock"])(),Object(n["createElementBlock"])(n["Fragment"],null,[e.model.label?(Object(n["openBlock"])(),Object(n["createBlock"])(b,{key:0,class:"ion-padding-bottom bold"},{default:Object(n["withCtx"])(()=>[Object(n["createElementVNode"])("span",null,Object(n["toDisplayString"])(e.model.label),1),e.model.required?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",a," *")):Object(n["createCommentVNode"])("",!0),e.allowCustom?(Object(n["openBlock"])(),Object(n["createElementBlock"])("span",r,[Object(n["createTextVNode"])(" Add Custom "+Object(n["toDisplayString"])(e.model.label)+"? ",1),Object(n["createVNode"])(p,{modelValue:e.isCustom,"onUpdate:modelValue":t[0]||(t[0]=t=>e.isCustom=t),onIonChange:t[1]||(t[1]=t=>e.model.value="")},null,8,["modelValue"])])):Object(n["createCommentVNode"])("",!0)]),_:1})):Object(n["createCommentVNode"])("",!0),e.isCustom?(Object(n["openBlock"])(),Object(n["createBlock"])(m,{key:1,class:Object(n["normalizeClass"])(["box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}]),modelValue:e.customOption,"onUpdate:modelValue":t[2]||(t[2]=t=>e.customOption=t),placeholder:e.model.placeholder||e.model.label,disabled:e.model.disabled,onIonFocus:t[3]||(t[3]=()=>e.model.error=""),onIonBlur:e.validate,onIonInput:e.onCustomValue},null,8,["class","modelValue","placeholder","disabled","onIonBlur","onIonInput"])):(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",{key:2,class:Object(n["normalizeClass"])(["outer-input-box box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}])},[Object(n["createElementVNode"])("div",c,[Object(n["createElementVNode"])("div",{style:{display:"flex","flex-wrap":"wrap",width:"100%"},onClick:t[6]||(t[6]=(...t)=>e.onShowOptions&&e.onShowOptions(...t))},[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.tags,(t,o)=>(Object(n["openBlock"])(),Object(n["createBlock"])(f,{key:o},{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(b,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(t.label),1)]),_:2},1024),Object(n["createVNode"])(v,{icon:e.closeCircle,color:"danger",onClick:o=>e.diselect(t),style:{"z-index":"20"}},null,8,["icon","onClick"])]),_:2},1024))),128)),Object(n["createVNode"])(m,{disabled:e.model.disabled,placeholder:e.showPlaceholder?e.model.placeholder||"select option":"",modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=t=>e.filter=t),class:"search-input",ref:"searchInput",onKeydown:t[5]||(t[5]=t=>e.handleKeyDown(t))},null,8,["disabled","placeholder","modelValue"])]),e.showOptions?(Object(n["openBlock"])(),Object(n["createElementBlock"])("div",l,[Object(n["createVNode"])(j,null,{default:Object(n["withCtx"])(()=>[(Object(n["openBlock"])(!0),Object(n["createElementBlock"])(n["Fragment"],null,Object(n["renderList"])(e.filteredOptions,(t,o)=>{var a;return Object(n["openBlock"])(),Object(n["createBlock"])(O,{key:o,lines:o+1===e.filteredOptions.length?"none":"",color:t.value===(null===(a=e.focusedOption)||void 0===a?void 0:a.value)?"light":"",onClick:o=>e.onSelect(t)},{default:Object(n["withCtx"])(()=>[e.multiple?(Object(n["openBlock"])(),Object(n["createBlock"])(p,{key:0,class:"input-option-checkbox",slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e},null,8,["modelValue","onUpdate:modelValue"])):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(b,null,{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(t.label),1)]),_:2},1024)]),_:2},1032,["lines","color","onClick"])}),128))]),_:1})])):Object(n["createCommentVNode"])("",!0),Object(n["createElementVNode"])("div",i,[e.filter||e.tags.length>0?(Object(n["openBlock"])(),Object(n["createBlock"])(v,{key:0,icon:e.close,onClick:e.resetHandler},null,8,["icon","onClick"])):Object(n["createCommentVNode"])("",!0),Object(n["createVNode"])(v,{icon:e.showOptions?e.chevronUp:e.chevronDown,onClick:t[7]||(t[7]=t=>e.showOptions?e.onCloseOptions():e.onShowOptions())},null,8,["icon"])])])],2)),e.model.error?(Object(n["openBlock"])(),Object(n["createBlock"])(h,{key:3,color:"danger"},{default:Object(n["withCtx"])(()=>[Object(n["createTextVNode"])(Object(n["toDisplayString"])(e.model.error),1)]),_:1})):Object(n["createCommentVNode"])("",!0)],64)}o("14d9");var u=o("d867"),d=o("ff79"),p=o("2ef0"),b=Object(n["defineComponent"])({name:"SelectInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},allowCustom:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},infiniteScrolling:{type:Boolean,default:!1}},components:{IonLabel:u["IonLabel"],IonInput:u["IonInput"],IonNote:u["IonNote"],IonIcon:u["IonIcon"],IonCheckbox:u["IonCheckbox"],IonList:u["IonList"],IonChip:u["IonChip"],IonItem:u["IonItem"]},emits:["update:modelValue"],setup(e,{emit:t}){const o=Object(n["ref"])(!1),a=Object(n["ref"])(""),r=Object(n["ref"])(),c=Object(n["ref"])(!1),l=Object(n["ref"])(),i=Object(n["ref"])(""),s=Object(n["ref"])([]),u=Object(n["ref"])(1),b=Object(n["computed"])(()=>e.multiple?s.value.filter(({isChecked:e})=>e):r.value?[r.value]:[]),m=Object(n["computed"])(()=>!i.value&&Object(p["isEmpty"])(b.value)&&!c.value),v=Object(n["computed"])({get:()=>e.modelValue,set:e=>t("update:modelValue",e)}),f=()=>{i.value="",r.value=void 0,s.value.forEach(e=>e.isChecked=!1)},O=()=>{if(f(),Object(p["isEmpty"])(v.value.value))return;if(Array.isArray(v.value.value)&&e.multiple)return v.value.value.forEach(e=>{const t=s.value.findIndex(({value:t})=>t===e.value);-1===t?s.value.push({...e,isChecked:!0}):s.value[t].isChecked=!0});const t=s.value.find(e=>e.value===v.value.value);r.value=t||{label:v.value.value,value:v.value.value}},j=async()=>{const t="function"===typeof e.asyncOptions?await e.asyncOptions(i.value):e.options.filter(({label:e})=>e.toLowerCase().includes(i.value.toLowerCase()));b.value.forEach(e=>{const o=t.findIndex(t=>t.value===e.value);-1===o?t.push(e):t[o].isChecked=!0}),s.value=t},h=async()=>{if(v.value.required&&Object(p["isEmpty"])(v.value.value))return v.value.error="This field is required";if(v.value.validation){const t=await v.value.validation({label:v.value.value,value:v.value.value},e.form);if(t&&t.length)return v.value.error+=t.toString()}return v.value.error=""},C=()=>{c.value=!1,v.value.value=e.multiple?b.value:Object(p["isEmpty"])(b.value)?void 0:b.value[0],i.value="",h()},w=()=>{v.value.disabled||(c.value=!0,v.value.error="")},g=()=>{v.value.value={label:a.value,value:a.value}},y=t=>{e.multiple||(r.value=t,C()),v.value.value=e.multiple?b.value:Object(p["isEmpty"])(b.value)?void 0:b.value[0],i.value=""},k=t=>e.multiple?t.isChecked=!1:r.value=void 0,V=e=>{e.preventDefault();const t=s.value.indexOf(l.value)+1;l.value=s.value[t]||s.value[0]},I=e=>{e.preventDefault();const t=s.value.indexOf(l.value)-1;l.value=s.value[t]||s.value[s.value.length-1]},x=e=>{switch(c.value||(c.value=!0),e.key){case"ArrowDown":V(e);break;case"ArrowUp":I(e);break;case" ":case"Enter":y(l.value);break;case"Escape":C();break}};return Object(n["watch"])(i,async()=>{u.value++,await j()}),Object(n["watch"])([()=>e.options,()=>e.asyncOptions],async()=>j()),Object(n["watch"])(()=>e.modelValue.value,e=>Object(p["isEmpty"])(e)&&O(),{deep:!0,immediate:!0}),Object(n["watch"])(c,e=>e&&(l.value=r.value||s.value[0])),Object(n["onMounted"])(async()=>{await j(),O(),addEventListener("click",e=>{const t=e.target.closest(".inner-input-box");!t&&c.value&&C()})}),Object(n["onBeforeUnmount"])(()=>removeEventListener("click",e=>console.log(e))),{validate:h,onSelect:y,resetHandler:f,onShowOptions:w,onCloseOptions:C,diselect:k,onCustomValue:g,handleKeyDown:x,model:v,customOption:a,isCustom:o,chevronDown:d["chevronDown"],chevronUp:d["chevronUp"],close:d["close"],closeCircle:d["closeCircle"],selectedOption:r,showOptions:c,focusedOption:l,showPlaceholder:m,filteredOptions:s,filter:i,tags:b}}}),m=(o("048a"),o("6b0d")),v=o.n(m);const f=v()(b,[["render",s],["__scopeId","data-v-b64db9c4"]]);t["a"]=f},c833:function(e,t,o){"use strict";o("e593")},da44:function(e,t,o){"use strict";o.d(t,"a",(function(){return a}));var n=o("d867");const a={async show(e,t,o="custom-modal",a=!0){const r=await n["modalController"].create({component:e,cssClass:o,backdropDismiss:a,componentProps:t});r.present();const{data:c}=await r.onWillDismiss();if(c)return c},async hide(e){await n["modalController"].dismiss(e)}}},e593:function(e,t,o){}}]);
//# sourceMappingURL=chunk-58babbc0.404de2f8.js.map