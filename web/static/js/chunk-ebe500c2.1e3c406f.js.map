{"version":3,"sources":["webpack:///./src/apps/EMC/views/tools/PatientMerging.vue?bec2","webpack:///./src/components/DataViews/ArtPatientCard.vue?b448","webpack:///./src/components/DataViews/ArtPatientCard.vue?f051","webpack:///./src/components/DataViews/ArtPatientCard.vue","webpack:///./src/components/DataViews/ArtPatientCard.vue?99d2","webpack:///./src/apps/EMC/views/tools/PatientMerging.vue?56c2","webpack:///./src/apps/EMC/views/tools/PatientMerging.vue","webpack:///./src/apps/EMC/views/tools/PatientMerging.vue?ddf6"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_openBlock","_createElementBlock","class","_normalizeClass","stateClass","_createElementVNode","_createTextVNode","_toDisplayString","patient","npid","arvNum","name","birthdate","gender","homeDistrict","homeVillage","currentDistrict","currentVillage","defineComponent","props","type","Object","required","isActive","Boolean","computed","this","__exports__","_hoisted_1","_component_ion_button","_resolveComponent","_component_ion_col","_component_ion_card_title","_component_ion_searchbar","_component_ion_card_header","_component_patient_card","_component_ion_card_content","_component_ion_card","_component_ion_row","_component_ion_grid","_component_Layout","_createBlock","default","_withCtx","_createVNode","size","disabled","enableMergeBtn","onClick","merge","_","_Fragment","_renderList","patients","key","category","color","style","placeholder","modelValue","query","$event","onKeyup","_withKeys","searchPatient","results","result","index","onPatient","isChecked","components","Layout","IonGrid","IonRow","IonCol","PatientCard","IonSearchbar","setup","router","useRouter","reactive","every","length","some","parseSearchText","async","nameOrArvNumber","match","value","sitePrefix","GLOBAL_PROP","buildSearchByNameQuery","tempName","split","filter","entry","test","Patientservice","search","findByOtherID","map","p","i","id","getID","getFullName","docID","getDocID","getBirthdate","getArvNumber","getNationalID","getGender","getHomeDistrict","getHomeVillage","getCurrentDistrict","getCurrentVillage","error","console","log","forEach","alertConfirmation","primaryPatient","find","mergedPatient","mergePatients","primary","secondary","push","params","patientId","e","toastDanger"],"mappings":"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","file":"js/chunk-ebe500c2.1e3c406f.js","sourcesContent":["export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./PatientMerging.vue?vue&type=style&index=0&id=5d477e2b&lang=css\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--0-1!./ArtPatientCard.vue?vue&type=style&index=0&id=154d9c56&scoped=true&lang=css\"","import { toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createElementBlock(\"div\", {\n    class: _normalizeClass([\"his-card clickable\", _ctx.stateClass])\n  }, [\n    _createElementVNode(\"li\", null, [\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" NPID : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.npid), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Arv# : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.arvNum), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Name : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.name), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Birth date : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.birthdate), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Gender : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.gender), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Home District : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.homeDistrict), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Home Village : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.homeVillage), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Current District : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.currentDistrict), 1)\n      ]),\n      _createElementVNode(\"ul\", null, [\n        _createTextVNode(\" Current Village : \"),\n        _createElementVNode(\"b\", null, _toDisplayString(_ctx.patient.currentVillage), 1)\n      ])\n    ])\n  ], 2))\n}","\nimport { defineComponent } from 'vue'\n\nexport default defineComponent({\n    props: {\n        patient: {\n            type: Object,\n            required: true\n        },\n        isActive: {\n            type: Boolean\n        }\n    },\n    computed: {\n        stateClass(): any {\n            return {\n                'active-card-color': this.isActive,\n                'inactive-card-color': !this.isActive\n            }\n        }\n    }\n})\n","import { render } from \"./ArtPatientCard.vue?vue&type=template&id=154d9c56&scoped=true&ts=true\"\nimport script from \"./ArtPatientCard.vue?vue&type=script&lang=ts\"\nexport * from \"./ArtPatientCard.vue?vue&type=script&lang=ts\"\n\nimport \"./ArtPatientCard.vue?vue&type=style&index=0&id=154d9c56&scoped=true&lang=css\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-154d9c56\"]])\n\nexport default __exports__","import { createTextVNode as _createTextVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, withKeys as _withKeys, createBlock as _createBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"ion-margin-start\" }\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_ion_button = _resolveComponent(\"ion-button\")!\n  const _component_ion_col = _resolveComponent(\"ion-col\")!\n  const _component_ion_card_title = _resolveComponent(\"ion-card-title\")!\n  const _component_ion_searchbar = _resolveComponent(\"ion-searchbar\")!\n  const _component_ion_card_header = _resolveComponent(\"ion-card-header\")!\n  const _component_patient_card = _resolveComponent(\"patient-card\")!\n  const _component_ion_card_content = _resolveComponent(\"ion-card-content\")!\n  const _component_ion_card = _resolveComponent(\"ion-card\")!\n  const _component_ion_row = _resolveComponent(\"ion-row\")!\n  const _component_ion_grid = _resolveComponent(\"ion-grid\")!\n  const _component_Layout = _resolveComponent(\"Layout\")!\n\n  return (_openBlock(), _createBlock(_component_Layout, null, {\n    default: _withCtx(() => [\n      _createVNode(_component_ion_grid, null, {\n        default: _withCtx(() => [\n          _createVNode(_component_ion_row, null, {\n            default: _withCtx(() => [\n              _createVNode(_component_ion_col, {\n                size: \"12\",\n                class: \"padding\"\n              }, {\n                default: _withCtx(() => [\n                  _createElementVNode(\"h2\", _hoisted_1, [\n                    _createTextVNode(\" Patient Merging \"),\n                    _createVNode(_component_ion_button, {\n                      class: \"ion-float-right ion-margin-end\",\n                      disabled: !_ctx.enableMergeBtn,\n                      onClick: _ctx.merge\n                    }, {\n                      default: _withCtx(() => [\n                        _createTextVNode(\" Merge Selected Patients \")\n                      ]),\n                      _: 1\n                    }, 8, [\"disabled\", \"onClick\"])\n                  ])\n                ]),\n                _: 1\n              }),\n              (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_ctx.patients, (patient) => {\n                return (_openBlock(), _createBlock(_component_ion_col, {\n                  size: \"6\",\n                  key: patient.category\n                }, {\n                  default: _withCtx(() => [\n                    _createVNode(_component_ion_card, null, {\n                      default: _withCtx(() => [\n                        _createVNode(_component_ion_card_header, { color: \"light\" }, {\n                          default: _withCtx(() => [\n                            _createVNode(_component_ion_card_title, { class: \"ion-margin-bottom\" }, {\n                              default: _withCtx(() => [\n                                _createTextVNode(_toDisplayString(patient.category) + \" patients \", 1)\n                              ]),\n                              _: 2\n                            }, 1024),\n                            _createVNode(_component_ion_searchbar, {\n                              style: {\"width\":\"100%\",\"height\":\"45px\"},\n                              class: \"box-input ion-no-padding ion-margin-end\",\n                              placeholder: \"Type Name or ARV Number and press enter\",\n                              modelValue: patient.query,\n                              \"onUpdate:modelValue\": ($event: any) => ((patient.query) = $event),\n                              onKeyup: _withKeys(($event: any) => (_ctx.searchPatient(patient)), [\"enter\"])\n                            }, null, 8, [\"modelValue\", \"onUpdate:modelValue\", \"onKeyup\"])\n                          ]),\n                          _: 2\n                        }, 1024),\n                        _createVNode(_component_ion_card_content, {\n                          color: \"light\",\n                          style: {\"height\":\"70vh\",\"overflow-y\":\"auto\"}\n                        }, {\n                          default: _withCtx(() => [\n                            (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(patient.results, (result, index) => {\n                              return (_openBlock(), _createBlock(_component_patient_card, {\n                                onClick: ($event: any) => (_ctx.onPatient(result, patient.category)),\n                                key: index,\n                                patient: result,\n                                isActive: result.isChecked\n                              }, null, 8, [\"onClick\", \"patient\", \"isActive\"]))\n                            }), 128))\n                          ]),\n                          _: 2\n                        }, 1024)\n                      ]),\n                      _: 2\n                    }, 1024)\n                  ]),\n                  _: 2\n                }, 1024))\n              }), 128))\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }))\n}","\nimport { computed, defineComponent, reactive } from \"vue\";\nimport Layout from \"@/apps/EMC/Components/Layout.vue\";\nimport { IonGrid, IonRow, IonCol, IonSearchbar } from \"@ionic/vue\";\nimport { Patientservice } from \"@/services/patient_service\";\nimport GLOBAL_PROP from \"@/apps/GLOBAL_APP/global_prop\";\nimport { useRouter } from \"vue-router\";\nimport  PatientCard from \"@/components/DataViews/ArtPatientCard.vue\"\nimport { alertConfirmation, toastDanger } from \"@/utils/Alerts\";\n\ninterface MergePatient {\n  query: string;\n  results: any[];\n  category: \"primary\" | \"secondary\";\n}\n\nexport default defineComponent({\n  components: {\n    Layout,\n    IonGrid,\n    IonRow,\n    IonCol,\n    // IonButton,\n    PatientCard,\n    IonSearchbar,\n  },\n  setup() {\n    const router = useRouter()\n    const patients = reactive<MergePatient[]>([\n      {\n        category: \"primary\",\n        query: \"\",\n        results: [],\n      },\n      {\n        category: \"secondary\",\n        query: \"\",\n        results: [],\n      },\n    ]);\n\n    const enableMergeBtn = computed(() => {\n      return patients.every((patient) => patient.results.length > 0 && patient.results.some((result) => result.isChecked));\n    })\n\n    const parseSearchText = async (nameOrArvNumber: string) => {\n      if (nameOrArvNumber.match(/^(\\w+-ARV-\\w+)$/)) {\n        return { type: \"arv_number\", value: nameOrArvNumber };\n      }\n      if (nameOrArvNumber.match(/^(\\d+)$/)) {\n        const sitePrefix = await GLOBAL_PROP.sitePrefix();\n        return {\n          type: \"arv_number\",\n          value: `${sitePrefix}-ARV-${nameOrArvNumber}`,\n        };\n      }\n      return { type: \"name\", value: nameOrArvNumber };\n    };\n\n    const buildSearchByNameQuery = (name: string) => {\n      const query: Record<string, any> = {};\n      const tempName = name.split(\" \").filter(entry => /\\S/.test(entry));\n\n      if (tempName.length > 0) {\n        query['given_name'] = tempName[0];\n        tempName[1] ? (query['family_name'] = tempName[1]) : null;\n        if (tempName[2]) {\n          query['middle_name'] = tempName[1];\n          query['family_name'] = tempName[2];\n        }\n      }\n\n      return query;\n    }\n\n    const searchPatient = async (patient: MergePatient) => {\n      if (patient.query) {\n        try {\n          const { type, value } = await parseSearchText(patient.query);\n          const results: any[] = (type === \"name\")\n            ? await Patientservice.search(buildSearchByNameQuery(value))\n            : (type === 'arv_number')\n            ? await Patientservice.findByOtherID(4, value)\n            : []\n          patient.results = results.map((p: any, i: number) => {\n            const patient = new Patientservice(p)\n            return {\n              index: i,\n              id: patient.getID(),\n              name: patient.getFullName(),\n              docID: patient.getDocID(),\n              birthdate: patient.getBirthdate(),\n              arvNum: patient.getArvNumber(),\n              npid: patient.getNationalID(),\n              gender: patient.getGender(),\n              homeDistrict: patient.getHomeDistrict(),\n              homeVillage: patient.getHomeVillage(),\n              currentDistrict: patient.getCurrentDistrict(),\n              currentVillage: patient.getCurrentVillage(),\n              isChecked: false\n            }\n          })\n        } catch (error) {\n          console.log(`${error}`)\n        } \n      }\n    };\n\n    const onPatient = (result: any, category: \"primary\" | \"secondary\") => {\n      if(category === 'primary') {\n        patients[0].results.forEach(p => {\n          if(p.id === result.id) {\n            p.isChecked = !p.isChecked\n          } else {\n            p.isChecked = false\n          }\n        })\n        if(result.isChecked){\n          // uncheck the patient in the secondary list\n          patients[1].results.forEach(p => {\n            if(p.id === result.id) {\n              p.isChecked = false\n            }\n          })\n        }\n      } else {\n        if(result.isChecked) return result.isChecked = false\n        // check only if the patient is not already checked in the primary list\n        result.isChecked = !patients[0].results.some(p => p.isChecked && p.id === result.id)\n      }\n    }\n\n    const merge = async () => {\n      if(!(await alertConfirmation(\"Are you sure you want to merge these patients?\"))) return\n      try {\n        const primaryPatient = patients[0].results.find(p => p.isChecked)\n        const mergedPatient = await Patientservice.mergePatients({\n          primary: {\n            'patient_id': primaryPatient.id,\n            'doc_id': primaryPatient.docID,\n          },\n          secondary: patients[1].results.filter(p => p.isChecked).map(p => ({\n            'patient_id': p.id,\n            'doc_id': p.docID,\n          }))\n        })\n        router.push({ name: \"EMC Mastercard\", params: { patientId: mergedPatient['patient_id'] } })\n      } catch (e) {\n        toastDanger(`${e}`)\n      }\n    }\n\n    return {\n      patients,\n      enableMergeBtn,\n      searchPatient,\n      onPatient,\n      merge,\n    };\n  },\n});\n","import { render } from \"./PatientMerging.vue?vue&type=template&id=5d477e2b&ts=true\"\nimport script from \"./PatientMerging.vue?vue&type=script&lang=ts\"\nexport * from \"./PatientMerging.vue?vue&type=script&lang=ts\"\n\nimport \"./PatientMerging.vue?vue&type=style&index=0&id=5d477e2b&lang=css\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}