{"version":3,"sources":["webpack:///./src/views/NewUser.vue?d2c9","webpack:///./src/views/NewUser.vue","webpack:///./src/views/NewUser.vue?5596","webpack:///./src/components/Forms/HisStandardForm.vue?f008","webpack:///./src/components/Forms/HisStandardForm.vue","webpack:///./src/components/Forms/HisStandardForm.vue?6820","webpack:///./src/services/person_service.ts"],"names":["render","_ctx","_cache","$props","$setup","$data","$options","_component_his_standard_form","_resolveComponent","_openBlock","_createBlock","key","formKey","fields","skipSummary","activeField","fieldComponent","onOnIndex","$event","onFinishAction","onFinish","defineComponent","components","HisStandardForm","data","activity","presets","programs","userData","isSessionPasswordChange","form","watch","route","query","includes","this","update_password","toUserData","UserService","getCurrentUser","getAvailableApps","getFields","immediate","deep","methods","_","computeValues","create","update","$router","push","Store","invalidate","$nextTick","e","RecordConflictError","isEmpty","errors","toastWarning","toastDanger","user","createUser","person","updateUser","id","getProgramName","app","find","programID","applicationName","mapToOption","listOptions","map","item","label","value","getAllRoles","filter","r","role","split","other","userObj","names","user_id","given_name","family_name","username","roles","HisDate","toStandardHisDisplayFormat","date_created","deactivated_on","p","editConditionCheck","attributes","toLcase","val","toString","toLowerCase","helpText","type","FieldType","TT_SELECT","condition","isAdmin","validation","Validation","required","unload","options","async","users","getAllUsers","u","config","showKeyboard","TT_TABLE_VIEWER","dynamicHelpText","created","f","c","table","statusRowIndex","columns","deactivateButton","status","name","style","width","fontWeight","color","action","deactivateUser","rows","toastSuccess","activateUser","navButton","targetField","rowBtns","length","join","hiddenFooterBtns","overrideDefaultFooterBtns","nextBtn","onClick","back","TT_TEXT","computedValue","defaultValue","isName","PersonService","searchGivenName","searchFamilyName","getRoles","proxyID","v","i","defaultComputedOutput","TT_MULTIPLE_SELECT","program","isChecked","validateSeries","hasLengthRangeOf","casing","inputType","verify_password","new_password","__exports__","_resolveDynamicComponent","formType","cancelDestinationPath","onOnFinish","onIndex","TouchScreenForm","emits","props","Function","Boolean","default","String","Object","formData","computedData","$emit","Service","constructor","super","postJson","putJson","getProgramID","getJson","personId"],"mappings":"yIAEM,SAAUA,EAAOC,EAAUC,EAAYC,EAAYC,EAAYC,EAAWC,GAC9E,MAAMC,EAA+BC,8BAAkB,qBAEvD,OAAQC,yBAAcC,yBAAaH,EAA8B,CAC/DI,IAAKV,EAAKW,QACVC,OAAQZ,EAAKY,OACbC,aAAa,EACbC,YAAad,EAAKe,eAClBC,UAAWf,EAAO,KAAOA,EAAO,GAAMgB,GAAiBjB,EAAKe,eAAe,IAC3EG,eAAgBlB,EAAKmB,UACpB,KAAM,EAAG,CAAC,SAAU,cAAe,mB,sICGzBC,+BAAgB,CAC7BC,WAAY,CAAEC,wBACdC,KAAM,KAAM,CACVZ,QAAS,EACTC,OAAQ,GACRY,SAAU,GACVC,QAAS,GACTC,SAAU,GACVC,SAAU,GACVZ,eAAgB,GAChBa,yBAAyB,EACzBd,YAAa,GACbe,KAAM,KAERC,MAAO,CACL,OAAU,CACN,cAAcC,GACV,IAAKA,EACD,OAEJ,MAAM,MAAEC,GAAUD,EACd,CAAC,OAAQ,OAAOE,SAASD,EAAMR,UAC/BU,KAAKV,SAAWQ,EAAMR,SAEtBU,KAAKV,SAAW,MAKhBQ,EAAMG,kBACND,KAAKP,SAAWO,KAAKE,iBACVC,OAAYC,kBAEvBJ,KAAKN,yBAA0B,EAC/BM,KAAKpB,YAAc,eACnBoB,KAAKnB,eAAiBmB,KAAKpB,aAE/BoB,KAAKR,SAAWW,OAAYE,mBAC5BL,KAAKtB,OAASsB,KAAKM,aAEvBC,WAAW,EACXC,MAAM,IAGZC,QAAS,CACP,eAAeC,EAAQC,GACnB,IACI,OAAOX,KAAKV,UACR,IAAK,YACKU,KAAKY,OAAOD,GAClBX,KAAKV,SAAW,OAChB,MACJ,IAAK,aACKU,KAAKa,OAAOF,GACdX,KAAKN,yBACLM,KAAKc,QAAQC,KAAK,KAEtB,MAERC,OAAMC,WAAW,aACjBjB,KAAKpB,YAAc,YACnBoB,KAAKkB,UAAU,IAAMlB,KAAKnB,eAAiBmB,KAAKpB,aAChDoB,KAAKvB,SAAW,EAClB,MAAO0C,GACDA,aAAaC,SAAwBC,qBAAQF,EAAEG,QAC/CC,eAAaJ,EAAEG,QAEfE,eAAY,GAAGL,KAI3B,aAAa9B,GACT,MAAM,KAAEoC,SAAetB,OAAYuB,WAAWrC,GAC9C,GAAIoC,EACA,OAAOzB,KAAKP,SAAWO,KAAKE,WAAWuB,GAE3C,KAAM,6FAEV,aAAapC,GACT,MAAMsC,QAAexB,OAAYyB,WAAW5B,KAAKP,SAASoC,GAAIxC,GAC9D,GAAIsC,EACA,OAAO3B,KAAKP,SAAWO,KAAKE,WAAWyB,GAE3C,KAAM,iFAEVG,eAAeD,GACX,MAAME,EAAMC,kBAAKhC,KAAKR,SAAU,CAAEyC,UAAWJ,IAC7C,OAAOE,EAAMA,EAAIG,gBAAkB,IAEvCC,YAAYC,GACR,OAAOA,EAAYC,IAAKC,IAAS,CAAQC,MAAOD,EAAME,MAAOF,MAEjE,iBACI,aAAcnC,OAAYsC,eAAeC,OAAQC,IAC7C,IACI,OAAQ3C,KAAKP,SAASmD,KAAKC,MAAM,KAAK9C,SAAS4C,EAAEC,MACnD,MAAMzB,GACJ,OAAO,KAEZkB,IAAKM,IAAM,CACVJ,MAAOI,EAAEC,KACTJ,MAAOG,EAAEC,KACTE,MAAOH,MAGfzC,WAAW6C,GACP,MAAMC,EAAQD,EAAQpB,OAAOqB,MAAM,GACnC,MAAO,CACH,GAAMD,EAAQE,QACd,WAAcD,EAAME,WACpB,YAAeF,EAAMG,YACrB,SAAYJ,EAAQK,SACpB,KAAQL,EAAQM,MAAMhB,IAAKM,GAAWA,EAAEC,MACxC,QAAWU,OAAQC,2BAA2BR,EAAQS,cACtD,OAAUT,EAAQU,eAAiB,WAAa,SAChD,SAAYV,EAAQvD,SAAS6C,IAAKqB,GAAWA,EAAE,iBAGvDC,mBAAmBC,EAAW,IAC1B,MAAsB,SAAlB5D,KAAKV,UACEsE,EAAW7D,SAASC,KAAKpB,cAIxCiF,QAAQC,GACJ,OAAOA,EAAItB,MAAMuB,WAAWC,eAEhC1D,UAAW,WACP,MAAO,CACH,CACIuB,GAAI,cACJoC,SAAU,kBACVC,KAAMC,OAAUC,UAChBC,UAAW,IAAwB,SAAlBrE,KAAKV,UACfa,OAAYmE,UACnBC,WAAaT,GAAaU,OAAWC,SAASX,GAC9CY,OAAQ,EAAE5B,WAAmB9C,KAAKP,SAAWO,KAAKE,WAAW4C,GAC7D6B,QAASC,UACL,MAAMC,QAAmB1E,OAAY2E,cACrC,OAAOD,EAAMxC,IAAK0C,IAAM,CACpBxC,MAAOwC,EAAE3B,SACTZ,MAAOuC,EAAE9B,QACTH,MAAOiC,MAGfC,OAAQ,CACJC,cAAc,IAGtB,CACIpD,GAAI,YACJoC,SAAU,mBACVC,KAAMC,OAAUe,gBAChBC,gBAAiB,IAAM,SAASnF,KAAKP,SAAS2D,wBAAwBpD,KAAKP,SAAS2F,UACpFf,UAAW,IAAwB,SAAlBrE,KAAKV,UAAuBa,OAAYmE,UACzDK,QAASC,MAAOS,EAAQC,EAAQC,KAC5B,MAAMC,EAAiB,EACjBC,EAAU,CAAC,aAAc,SAAU,WACnCC,EAAoBC,IAAc,CACpCC,KAAiB,WAAXD,EAAsB,aAAe,WAC3CzB,KAAM,SACN2B,MAAO,CAAEC,MAAO,MAAOC,WAAY,QACnCC,MAAkB,WAAXL,EAAsB,SAAW,UACxCM,OAAQrB,UACJ,IACmB,WAAXe,UACMxF,OAAY+F,eAAelG,KAAKP,SAASoC,IAC/C7B,KAAKP,SAASkG,OAAS,WACvBJ,EAAMY,KAAKX,GAAkB,CAAC,SAAU,WAAYE,EAAiB,aACrEU,eAAa,4BAA6B,MAE/B,aAAXT,UACMxF,OAAYkG,aAAarG,KAAKP,SAASoC,IAC7C7B,KAAKP,SAASkG,OAAS,SACvBJ,EAAMY,KAAKX,GAAkB,CAAC,SAAU,SAAUE,EAAiB,WACnEU,eAAa,0BAA2B,MAE9C,MAAMjF,GACJI,eAAa,GAAGJ,OAItBmF,EAAY,CAACV,EAAcW,KAAwB,CACrDX,OACA1B,KAAM,SACN8B,MAAO,QACPH,MAAO,CACHE,WAAY,OACZD,MAAO,OAEXG,OAAQ,KACJjG,KAAKpB,YAAc2H,EACnBvG,KAAKnB,eAAiBmB,KAAKpB,eAG7B4H,EAAU,CAACF,EAAU,kBAAmB,UAC1CtG,KAAKP,SAASmD,KAAK6D,OAAS,GAC5BD,EAAQzF,KAAKuF,EAAU,cAAe,iBAE1C,MAAMH,EAAO,CACT,CAAC,cAAe,GAAGnG,KAAKP,SAASyD,cAAclD,KAAKP,SAAS0D,cAAemD,EAAU,YAAa,cAAe,IAClH,CAAC,kBAAmB,UAAWA,EAAU,kBAAmB,gBAAiB,IAC7E,CAAC,cAAetG,KAAKP,SAASmD,KAAK8D,KAAK,YAAaF,GACrD,CAAC,gBAAiBxG,KAAKP,SAASkG,OAASD,EAAiB1F,KAAKP,SAASkG,QAAS,IACjF,CAAC,kBAAmB3F,KAAKP,SAASD,SAAS6C,IAAKqB,GAAc1D,KAAK8B,eAAe4B,IAAIgD,KAAK,SACvFJ,EAAU,eAAgB,YAAa,KAE/C,MAAO,CAAC,CACJ/D,MAAO,GACPC,MAAO,GACPM,MAAO,CAAE2C,UAASU,WAG1BnB,OAAQ,CACJ2B,iBAAkB,CACd,SAEJC,0BAA2B,CACvBC,QAAS,CACLjB,KAAM,SACNkB,QAAS,IAAM9G,KAAKc,QAAQiG,WAK5C,CACIlF,GAAI,aACJoC,SAAU,aACVC,KAAMC,OAAU6C,QAChBC,cAAgBnD,GAAgBA,EAAItB,MACpC0E,aAAc,IAAMlH,KAAKP,SAASyD,WAClCmB,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,gBAAkBxD,OAAYmE,UACxEC,WAAaT,GAAaU,OAAW2C,OAAOrD,GAC5Ca,QAASC,UACL,IAAKjF,EAAKuD,YAAwC,OAA1BvD,EAAKuD,WAAWV,MAAgB,MAAO,GAE/D,MAAMQ,QAAcoE,OAAcC,gBAAgB1H,EAAKuD,WAAWV,OAClE,OAAOxC,KAAKmC,YAAYa,KAGhC,CACInB,GAAI,cACJoC,SAAU,YACVC,KAAMC,OAAU6C,QAChBC,cAAgBnD,GAAgBA,EAAItB,MACpC0E,aAAc,IAAMlH,KAAKP,SAAS0D,YAClCoB,WAAaT,GAAaU,OAAW2C,OAAOrD,GAC5CO,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,gBAAkBxD,OAAYmE,UACxEK,QAASC,UACL,IAAKjF,EAAKwD,aAA0C,OAA3BxD,EAAKwD,YAAYX,MAAgB,MAAO,GAEjE,MAAMQ,QAAcoE,OAAcE,iBAAiB3H,EAAKwD,YAAYX,OACpE,OAAOxC,KAAKmC,YAAYa,KAGhC,CACInB,GAAI,QACJoC,SAAU,OACVC,KAAMC,OAAUC,UAChB6C,cAAgBnD,GAAgB,CAACA,EAAItB,OACrC6B,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,WAAaxD,OAAYmE,UACnEC,WAAaT,GAAaU,OAAWC,SAASX,GAC9Ca,QAAS,IAAM3E,KAAKuH,WACpBvC,OAAQ,CACJC,cAAc,IAGtB,CACIpD,GAAI,eACJoC,SAAU,eACVuD,QAAS,QACTtD,KAAMC,OAAUC,UAChBG,WAAakD,GAAcjD,OAAWC,SAASgD,GAC/CpD,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,kBAAoBxD,OAAYmE,WAA+B,SAAlBtE,KAAKV,SAC5F2H,cAAgBQ,GAAczH,KAAKP,SAASmD,KAAKF,OAAQgF,GAAcA,GAAKD,EAAElF,OAC9EoC,QAAS,IAAM3E,KAAKmC,YAAYnC,KAAKP,SAASmD,MAC9CoC,OAAQ,CACJC,cAAc,IAGtB,CACIpD,GAAI,oBACJoC,SAAU,iCACVC,KAAMC,OAAUC,UAChB6C,cAAgBnD,GAA8B,QAAdA,EAAIvB,MACpC8B,UAAW,IAAwB,SAAlBrE,KAAKV,UACfU,KAAK2D,mBAAmB,CAAC,WACzBxD,OAAYmE,UACnBqD,sBAAuB,KAAM,EAC7BpD,WAAaT,GAAaU,OAAWC,SAASX,GAC1Ca,QAAS,IAAM,CACf,CACIpC,MAAO,MAAOC,MAAO,QAEzB,CACID,MAAO,KAAMC,MAAO,WAIhC,CACIX,GAAI,WACJoC,SAAU,cACVC,KAAMC,OAAUyD,mBAChBvD,UAAW,IAAMlE,OAAYmE,WAAatE,KAAK2D,mBAAmB,CAAC,aACnEY,WAAaT,GAAkBU,OAAWC,SAASX,GACnDmD,cAAgBnD,GAAkBA,EAAIzB,IAAKqF,GAAcA,EAAElF,OAC3DmC,QAAS,IACE3E,KAAKR,SAAS6C,IAAKwF,IACtB,IAAIC,GAAY,EAIhB,MAHsB,SAAlB9H,KAAKV,WACLwI,EAAY9H,KAAKP,SAASD,SAASO,SAAS8H,EAAQ5F,YAEjD,CACHM,MAAOsF,EAAQ3F,gBACfM,MAAOqF,EAAQ5F,UACf6F,UAAWA,MAK3B,CACIjG,GAAI,WACJoC,SAAU,WACVC,KAAMC,OAAU6C,QAChB3C,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,yBACnCxD,OAAYmE,UACnB2C,cAAgBnD,GAAgB9D,KAAK6D,QAAQC,GAC7CS,WAAaT,GAAaU,OAAWuD,eAAe,CAChD,IAAMvD,OAAWC,SAASX,GAC1B,IAAMU,OAAWwD,iBAAiBlE,EAAK,EAAG,MAE9CkB,OAAQ,CACJiD,OAAQ,cAGhB,CACIpG,GAAI,eACJ2F,QAAS,WACTvD,SAAU,eACVC,KAAMC,OAAU6C,QAChBC,cAAgBnD,GAAgB9D,KAAK6D,QAAQC,GAC7CO,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,iBAC1CY,WAAaT,GAAaU,OAAWuD,eAAe,CAChD,IAAMvD,OAAWC,SAASX,GAC1B,IAAMU,OAAWwD,iBAAiBlE,EAAK,EAAG,MAE9CkB,OAAQ,CACJkD,UAAW,aAGnB,CACIrG,GAAI,kBACJ2F,QAAS,WACTvD,SAAU,mBACVC,KAAMC,OAAU6C,QAChBC,cAAgBnD,GAAgB9D,KAAK6D,QAAQC,GAC7CO,UAAW,IAAMrE,KAAK2D,mBAAmB,CAAC,iBAC1CY,WAAY,CAACT,EAAUuB,IAAWb,OAAWuD,eAAe,CACxD,IAAMvD,OAAWC,SAASX,GAC1B,KACI,GAAI9D,KAAK6D,QAAQwB,EAAE8C,kBAAoBnI,KAAK6D,QAAQwB,EAAE+C,cAClD,MAAO,CAAC,mDAGpBpD,OAAQ,CACJkD,UAAW,kB,qBCvX/B,MAAMG,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASxK,KAErD,gB,kDCLT,SAAUA,EAAOC,EAAUC,EAAYC,EAAYC,EAAYC,EAAWC,GAC9E,OAAQG,yBAAcC,yBAAa+J,qCAAyBxK,EAAKyK,UAAW,CAC1E7J,OAAQZ,EAAKY,OACbC,YAAab,EAAKa,YAClBC,YAAad,EAAKc,YAClB4J,sBAAuB1K,EAAK0K,sBAC5BC,WAAY3K,EAAKmB,SACjBA,SAAUnB,EAAKkB,eACfF,UAAWhB,EAAK4K,SACf,KAAM,GAAI,CAAC,SAAU,cAAe,cAAe,wBAAyB,aAAc,WAAY,c,gBCN5FxJ,+BAAgB,CAC3B0G,KAAM,kBACNzG,WAAY,CAAEwJ,wBACdC,MAAO,CACH,WACA,WAEJvJ,KAAM,KAAM,CACRkJ,SAAU,sBAEdM,MAAO,CACH7J,eAAgB,CACZkF,KAAM4E,UAEVnK,YAAa,CACTuF,KAAM6E,QACNC,SAAS,GAEbpK,YAAa,CACTsF,KAAM+E,QAEVvK,OAAQ,CACJwF,KAAMgF,OACNzE,UAAU,GAEd+D,sBAAuB,CACnBtE,KAAM+E,OACNxE,UAAU,IAGlBhE,QAAS,CACLxB,SAASkK,EAAeC,GACpBpJ,KAAKqJ,MAAM,WAAYF,EAAUC,IAErCV,QAAQhB,GACJ1H,KAAKqJ,MAAM,UAAW3B,O,qBCnClC,MAAMW,EAA2B,IAAgB,EAAQ,CAAC,CAAC,SAASxK,KAErD,U,gGCiBT,MAAOuJ,UAAsBkC,OAE/BC,YAAY5H,GACR6H,QAAO,qCACPxJ,KAAK2B,OAASA,EAGlBf,SAAW,OAAO0I,OAAQG,SAAS,UAAWzJ,KAAK2B,QAEnDd,OAAOgB,GAAc,OAAOyH,OAAQI,QAAQ,UAAU7H,EAAM,IACrD7B,KAAK2B,OAAQ,WAAc2H,OAAQK,iBAG1C,wBAAwB/D,GACpB,OAAO4D,MAAMI,QAAQ,sBAAuB,CAAC,cAAiBhE,IAGlE,uBAAuBA,GACnB,OAAO4D,MAAMI,QAAQ,qBAAsB,CAAC,cAAiBhE,IAGjE,+BAA+BiE,GAC3B,MAAM7G,QAAcwG,MAAMI,QAAQ,WAAWC,WAC7C,OAAO7G,GAASA,EAAMyD,OAASzD,EAAM,GAAGE,WAAa,IAAMF,EAAM,GAAGG,YAAc","file":"js/chunk-7ca49a5f.3145b44a.js","sourcesContent":["import { resolveComponent as _resolveComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  const _component_his_standard_form = _resolveComponent(\"his-standard-form\")!\n\n  return (_openBlock(), _createBlock(_component_his_standard_form, {\n    key: _ctx.formKey,\n    fields: _ctx.fields,\n    skipSummary: true,\n    activeField: _ctx.fieldComponent,\n    onOnIndex: _cache[0] || (_cache[0] = ($event: any) => (_ctx.fieldComponent='')),\n    onFinishAction: _ctx.onFinish\n  }, null, 8, [\"fields\", \"activeField\", \"onFinishAction\"]))\n}","\nimport { defineComponent } from \"vue\";\nimport { FieldType } from \"@/components/Forms/BaseFormElements\"\nimport { Field, Option } from \"@/components/Forms/FieldInterface\"\nimport HisStandardForm from \"@/components/Forms/HisStandardForm.vue\";\nimport Validation from \"@/components/Forms/validations/StandardValidations\"\nimport { UserService } from \"@/services/user_service\"\nimport { PersonService } from \"@/services/person_service\"\nimport HisDate from \"@/utils/Date\"\nimport { toastWarning, toastSuccess, toastDanger } from \"@/utils/Alerts\"\nimport { RecordConflictError } from \"@/services/service\";\nimport { isEmpty } from \"lodash\";\nimport { find } from \"lodash\";\nimport Store from \"@/composables/ApiStore\"\n\nexport default defineComponent({\n  components: { HisStandardForm },\n  data: () => ({\n    formKey: 0 as number,\n    fields: [] as Array<Field>,\n    activity: '' as 'edit' | 'add',\n    presets: {} as any,\n    programs: {} as any,\n    userData: {} as any,\n    fieldComponent: '' as string,\n    isSessionPasswordChange: false as boolean,\n    activeField: '' as string,\n    form: {} as Record<string, Option> | Record<string, null>\n  }),\n  watch: {\n    '$route': {\n        async handler(route: any) {\n            if (!route) {\n                return\n            }\n            const { query } = route\n            if (['edit', 'add'].includes(query.activity)) {\n                this.activity = query.activity\n            } else {\n                this.activity = 'add'\n            }\n            /**\n             * Jump straight to update the current user's password\n             */\n            if (query.update_password) {\n                this.userData = this.toUserData(\n                    (await UserService.getCurrentUser())\n                )\n                this.isSessionPasswordChange = true\n                this.activeField = 'new_password'\n                this.fieldComponent = this.activeField\n            }\n            this.programs = UserService.getAvailableApps()\n            this.fields = this.getFields()\n        },\n        immediate: true,\n        deep: true\n    }\n  },\n  methods: {\n    async onFinish(_: any, computeValues: any) {\n        try {\n            switch(this.activity) {\n                case 'add':\n                    await this.create(computeValues)\n                    this.activity = 'edit'\n                    break;\n                case 'edit':\n                    await this.update(computeValues)\n                    if (this.isSessionPasswordChange) {\n                        this.$router.push('/')\n                    }\n                    break;\n            }\n            Store.invalidate('PROVIDERS')\n            this.activeField = 'user_info'\n            this.$nextTick(() => this.fieldComponent = this.activeField)\n            this.formKey += 1\n        } catch (e) {\n            if (e instanceof RecordConflictError && !isEmpty(e.errors)) {\n                toastWarning(e.errors)\n            } else {\n                toastDanger(`${e}`)\n            }\n        }\n    },\n    async create(data: any) {\n        const { user } = await UserService.createUser(data)\n        if (user) {\n            return this.userData = this.toUserData(user)\n        }\n        throw 'Unable to create new user, Possibly the user already exists or incorrect info was entered'\n    },\n    async update(data: any) {\n        const person = await UserService.updateUser(this.userData.id, data)\n        if (person) {\n            return this.userData = this.toUserData(person)\n        }\n        throw 'Unable to update user, possibly server error or incorrect information entered'\n    },\n    getProgramName(id: number) {\n        const app = find(this.programs, { programID: id })\n        return app ? app.applicationName : ''\n    },\n    mapToOption(listOptions: Array<string>): Array<Option> {\n        return listOptions.map((item: any) => ({ label: item, value: item })) \n    },\n    async getRoles() {\n        return (await UserService.getAllRoles()).filter((r: any) => {\n            try {\n                return !this.userData.role.split(',').includes(r.role)\n            } catch(e) {\n                return true\n            }\n        }).map((r: any) => ({\n            label: r.role,\n            value: r.role,\n            other: r\n        }))\n    },\n    toUserData(userObj: any) {\n        const names = userObj.person.names[0]\n        return {\n            'id': userObj.user_id,\n            'given_name': names.given_name,\n            'family_name': names.family_name,\n            'username': userObj.username,\n            'role': userObj.roles.map((r: any) => r.role),\n            'created': HisDate.toStandardHisDisplayFormat(userObj.date_created),\n            'status': userObj.deactivated_on ? 'Inactive' : 'Active',\n            'programs': userObj.programs.map((p: any) => p['program_id'])\n        }\n    },\n    editConditionCheck(attributes=[] as Array<string>): boolean {\n        if (this.activity === 'edit') {\n            return attributes.includes(this.activeField)\n        }\n        return true\n    },\n    toLcase(val: Option): string {\n        return val.value.toString().toLowerCase()\n    },\n    getFields: function(): Array<Field> {\n        return [\n            {\n                id: 'select_user',\n                helpText: \"Select Username\",\n                type: FieldType.TT_SELECT,\n                condition: () => this.activity === 'edit' \n                    && UserService.isAdmin(),\n                validation: (val: any) => Validation.required(val),\n                unload: ({other}: Option) => this.userData = this.toUserData(other),\n                options: async () => {\n                    const users: any = await UserService.getAllUsers()\n                    return users.map((u: any) => ({\n                        label: u.username,\n                        value: u.user_id,\n                        other: u\n                    }))\n                },\n                config: {\n                    showKeyboard: true\n                }\n            },\n            {\n                id: 'user_info',\n                helpText: 'User information',\n                type: FieldType.TT_TABLE_VIEWER,\n                dynamicHelpText: () => `User: ${this.userData.username} | Added On: ${this.userData.created}`,\n                condition: () => this.activity === 'edit' && UserService.isAdmin(),\n                options: async (f: any, c: any, table: any) => {\n                    const statusRowIndex = 3\n                    const columns = ['Attributes', 'Values', 'Actions']\n                    const deactivateButton = (status: string) => ({\n                        name: status === 'Active' ? 'Deactivate' : 'Activate' ,\n                        type: 'button',\n                        style: { width: '65%', fontWeight: 'bold' },\n                        color: status === 'Active' ? 'danger' : 'success',\n                        action: async () => {\n                            try {\n                                if (status === 'Active') {\n                                    await UserService.deactivateUser(this.userData.id)\n                                    this.userData.status = 'Inactive'\n                                    table.rows[statusRowIndex] = ['Status', 'Inactive', deactivateButton('Inactive')],\n                                    toastSuccess('User has been deactivated', 400)\n                                }\n                                if (status === 'Inactive') {\n                                    await UserService.activateUser(this.userData.id)\n                                    this.userData.status = 'Active'\n                                    table.rows[statusRowIndex] = ['Status', 'Active', deactivateButton('Active')],\n                                    toastSuccess('User has been activated', 400)\n                                }\n                            } catch(e) {\n                                toastWarning(`${e}`)\n                            }\n                        }\n                    })\n                    const navButton = (name: string, targetField: string) => ({ \n                        name, \n                        type: 'button',\n                        color: 'light',\n                        style: {\n                            fontWeight: 'bold',\n                            width: '65%'\n                        },\n                        action: () => {\n                            this.activeField = targetField\n                            this.fieldComponent = this.activeField\n                        }\n                    })\n                    const rowBtns = [navButton('Add/Append Role', 'roles')]\n                    if (this.userData.role.length > 1) {\n                        rowBtns.push(navButton('Remove Role', 'remove_roles'))\n                    }\n                    const rows = [\n                        ['<b>Name</b>', `${this.userData.given_name} ${this.userData.family_name}`, navButton('Edit Name', 'given_name'), ''],\n                        ['<b>Password</b>', '*******', navButton('Change password', 'new_password'), ''],\n                        ['<b>Role</b>', this.userData.role.join('<br/>'), ...rowBtns],\n                        ['<b>Status</b>', this.userData.status,  deactivateButton(this.userData.status), ''],\n                        ['<b>Programs</b>', this.userData.programs.map((p: number) => this.getProgramName(p)).join('<br/>'),  \n                            navButton('Edit Program', 'programs'), ''],\n                    ]\n                    return [{\n                        label: '',\n                        value: '',\n                        other: { columns, rows }\n                    }]\n                },\n                config: {\n                    hiddenFooterBtns: [\n                        'Clear',\n                    ],\n                    overrideDefaultFooterBtns: {\n                        nextBtn: {\n                            name: 'Finish',\n                            onClick: () => this.$router.back()\n                        }\n                    }\n                }\n            },\n            {\n                id: 'given_name',\n                helpText: 'First name',\n                type: FieldType.TT_TEXT,\n                computedValue: (val: Option) => val.value,\n                defaultValue: () => this.userData.given_name,\n                condition: () => this.editConditionCheck(['given_name']) && UserService.isAdmin(),\n                validation: (val: any) => Validation.isName(val),\n                options: async (form: any) => {\n                    if (!form.given_name || form.given_name.value === null) return []\n\n                    const names = await PersonService.searchGivenName(form.given_name.value)\n                    return this.mapToOption(names)\n                }\n            },\n            {\n                id: 'family_name',\n                helpText: \"Last name\",\n                type: FieldType.TT_TEXT,\n                computedValue: (val: Option) => val.value,\n                defaultValue: () => this.userData.family_name,\n                validation: (val: any) => Validation.isName(val),\n                condition: () => this.editConditionCheck(['given_name']) && UserService.isAdmin(),\n                options: async (form: any) => {\n                    if (!form.family_name || form.family_name.value === null) return []\n\n                    const names = await PersonService.searchFamilyName(form.family_name.value)\n                    return this.mapToOption(names)\n                }\n            },\n            {\n                id: 'roles',\n                helpText: \"Role\",\n                type: FieldType.TT_SELECT,\n                computedValue: (val: Option) => [val.value],\n                condition: () => this.editConditionCheck(['roles']) && UserService.isAdmin(),\n                validation: (val: any) => Validation.required(val),\n                options: () => this.getRoles(),\n                config: {\n                    showKeyboard: true\n                }\n            },\n            {\n                id: 'remove_roles',\n                helpText: \"Remove Roles\",\n                proxyID: 'roles',\n                type: FieldType.TT_SELECT,\n                validation: (v: Option) => Validation.required(v),\n                condition: () => this.editConditionCheck(['remove_roles']) && UserService.isAdmin() && this.activity === 'edit',\n                computedValue: (v: Option) => this.userData.role.filter((i: string) => i != v.label),\n                options: () => this.mapToOption(this.userData.role),\n                config: {\n                    showKeyboard: true\n                }\n            },\n            {\n                id: 'must_append_roles',\n                helpText: \"Would you like to append role?\",\n                type: FieldType.TT_SELECT,\n                computedValue: (val: Option) => val.label === 'Yes' ? true : false,\n                condition: () => this.activity === 'edit' \n                    && this.editConditionCheck(['roles']) \n                    && UserService.isAdmin(),\n                defaultComputedOutput: () => false,\n                validation: (val: any) => Validation.required(val),\n                    options: () => [\n                    {\n                        label: 'Yes', value: 'true'\n                    },\n                    {\n                        label: 'No', value: 'false'\n                    }\n                ]\n            },\n            {\n                id: 'programs',\n                helpText: \"Select Apps\",\n                type: FieldType.TT_MULTIPLE_SELECT,\n                condition: () => UserService.isAdmin() && this.editConditionCheck(['programs']),\n                validation: (val: Option[]) => Validation.required(val),\n                computedValue: (val: Option[]) => val.map((i: Option) => i.value),\n                options: () => {\n                    return this.programs.map((program: any) => {\n                        let isChecked = false\n                        if (this.activity === 'edit') {\n                            isChecked = this.userData.programs.includes(program.programID)\n                        }\n                        return {\n                            label: program.applicationName,\n                            value: program.programID,\n                            isChecked: isChecked\n                        }\n                    })\n                },\n            },\n            {\n                id: 'username',\n                helpText: \"Username\",\n                type: FieldType.TT_TEXT,\n                condition: () => this.editConditionCheck(['nothing to see here']) \n                    && UserService.isAdmin(),\n                computedValue: (val: Option) => this.toLcase(val),\n                validation: (val: any) => Validation.validateSeries([\n                    () => Validation.required(val),\n                    () => Validation.hasLengthRangeOf(val, 4, 15)\n                ]),\n                config: {\n                    casing: 'lowercase'\n                },\n            },\n            {\n                id: 'new_password',\n                proxyID: \"password\",\n                helpText: \"New Password\",\n                type: FieldType.TT_TEXT,\n                computedValue: (val: Option) => this.toLcase(val),\n                condition: () => this.editConditionCheck(['new_password']),\n                validation: (val: any) => Validation.validateSeries([\n                    () => Validation.required(val),\n                    () => Validation.hasLengthRangeOf(val, 4, 15)\n                ]),\n                config: {\n                    inputType: 'password'\n                }\n            },\n            {\n                id: 'verify_password',\n                proxyID: \"password\",\n                helpText: \"Confirm Password\",\n                type: FieldType.TT_TEXT,\n                computedValue: (val: Option) => this.toLcase(val),\n                condition: () => this.editConditionCheck(['new_password']),\n                validation: (val: any, f: any) => Validation.validateSeries([\n                    () => Validation.required(val),\n                    () => {\n                        if (this.toLcase(f.verify_password) != this.toLcase(f.new_password))\n                            return ['New password does not match current password']\n                    }\n                ]),\n                config: {\n                    inputType: 'password'\n                }\n            }\n        ]\n    }\n  }\n})\n","import { render } from \"./NewUser.vue?vue&type=template&id=3210454e&ts=true\"\nimport script from \"./NewUser.vue?vue&type=script&lang=ts\"\nexport * from \"./NewUser.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nexport function render(_ctx: any,_cache: any,$props: any,$setup: any,$data: any,$options: any) {\n  return (_openBlock(), _createBlock(_resolveDynamicComponent(_ctx.formType), {\n    fields: _ctx.fields,\n    skipSummary: _ctx.skipSummary,\n    activeField: _ctx.activeField,\n    cancelDestinationPath: _ctx.cancelDestinationPath,\n    onOnFinish: _ctx.onFinish,\n    onFinish: _ctx.onFinishAction,\n    onOnIndex: _ctx.onIndex\n  }, null, 40, [\"fields\", \"skipSummary\", \"activeField\", \"cancelDestinationPath\", \"onOnFinish\", \"onFinish\", \"onOnIndex\"]))\n}","\nimport TouchScreenForm from \"@/components/Forms/TouchScreenForm.vue\";\nimport { defineComponent, PropType } from \"vue\";\nimport { Field } from \"./FieldInterface\";\n\nexport default defineComponent({\n    name: \"HisStandardForm\",\n    components: { TouchScreenForm },\n    emits: [\n        'onFinish',\n        'onIndex'\n    ],\n    data: () => ({\n        formType: 'touch-screen-form' as string\n    }),\n    props: {\n        onFinishAction: {\n            type: Function\n        },\n        skipSummary: {\n            type: Boolean,\n            default: false\n        },\n        activeField: {\n            type: String\n        },\n        fields: {\n            type: Object as PropType<Field[]>,\n            required: true\n        },\n        cancelDestinationPath: {\n            type: String,\n            required: false,\n        }\n    },\n    methods: {\n        onFinish(formData: any, computedData: any) {\n            this.$emit('onFinish', formData, computedData)\n        },\n        onIndex(i: number) {\n            this.$emit('onIndex', i)\n        }\n    }\n})\n","import { render } from \"./HisStandardForm.vue?vue&type=template&id=6daa0375&ts=true\"\nimport script from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\nexport * from \"./HisStandardForm.vue?vue&type=script&lang=ts\"\n\nimport exportComponent from \"/home/daniel/local-repos/HIS-Core/node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { Person } from \"@/interfaces/person\"\nimport { Service } from \"./service\"\n\nexport interface NewPerson {\n    person_id?: number;\n    given_name: string;\n    family_name: string;\n    gender: string;\n    birthdate: string;\n    birthdate_estimated: boolean;\n    home_district: string;\n    home_traditional_authority: string;\n    home_village: string;\n    current_district: string;\n    current_traditional_authority: string;\n    current_village: string;\n    landmark: string;\n    cell_phone_number: string;\n    occupation: string;\n    facility_name: string;\n    patient_type?: string;\n    relationship?: string;\n}\n\nexport class PersonService extends Service{\n    person: Person | NewPerson\n    constructor(person: NewPerson | Person){\n        super()\n        this.person = person\n    }\n\n    create() { return Service.postJson('/people', this.person) }\n\n    update(id: number) { return Service.putJson(`people/${id}`, {\n        ...this.person, 'program_id': Service.getProgramID()\n    })}\n\n    static searchFamilyName(name: string) {\n        return super.getJson('/search/family_name', {'search_string': name})\n    }\n\n    static searchGivenName(name: string) {\n        return super.getJson('/search/given_name', {'search_string': name})\n    }\n\n    static async getPersonFullName(personId: string | number) {\n        const names = await super.getJson(`/people/${personId}/names`)\n        return names && names.length ? names[0].given_name + ' ' + names[0].family_name : ''\n    }\n}\n"],"sourceRoot":""}