(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0f68ebc1"],{"4f4b":function(e,t,a){"use strict";a.r(t);var n=a("7a23"),i=a("7920"),r=a("2706"),o=a("d95e"),c=a("e86e"),l=a("cc6f");class u extends l["a"]{constructor(e,t){super(e,114,t)}}class s extends l["a"]{constructor(e,t){super(e,40,t)}}var d=a("5713"),f=a("e343"),b=a("93c7"),m=a("2ef0"),h=a("b5e4"),p=a("d867"),v=Object(n["defineComponent"])({__name:"DischargePatient",setup(e){let t,a;const l=Object(n["ref"])([]),{goToNextTask:v,patientDashboardUrl:y}=Object(b["a"])((e,n)=>{a=new s(n,e),t=new u(n,e),l.value=[w(),O(),j()]});async function g(e,n){await a.createEncounter();const i=await Object(f["d"])({...n},"outcome");await a.saveObservationList(i);const r=await Object(f["d"])({...n},"referral");Object(m["isEmpty"])(r)||(await t.createEncounter(),await t.saveObservationList(r)),v()}function w(){return{id:"outcome_status",helpText:"Select Discharge Outcome",type:o["b"].TT_SELECT,validation:e=>r["a"].required(e),computedValue:e=>({tag:"outcome",obs:a.buildValueCoded("outcome",e.value)}),options:()=>[{label:"Referred (Within the Facility)",value:"Patient transferred internally"},{label:"Dead",value:"Died in treatment"},{label:"Abscorded",value:"Absconded"},{label:"Alive (Discharged home)",value:"Discharged home"},{label:"Transferred (Another health facility)",value:"Discharged to another facility"}]}}function O(){return{id:"facility_name",helpText:"Select Facility name",type:o["b"].TT_SELECT,validation:e=>r["a"].required(e),computedValue:e=>({tag:"referral",obs:t.buildValueText("Referred",e.label)}),condition:e=>"Discharged to another facility"===e.outcome_status.value,options:(e,t="")=>Object(c["b"])(t),config:{showKeyboard:!0,isFilterDataViaApi:!0}}}function j(){return{id:"internal_sections",helpText:"Select Ward/internal section",type:o["b"].TT_SELECT,validation:e=>r["a"].required(e),computedValue:e=>({tag:"referral",obs:t.buildValueText("Specialist clinic",e.label)}),condition:e=>"Patient transferred internally"===e.outcome_status.value,options:()=>d["a"].getInternalSections(),config:{showKeyboard:!0,footerBtns:[{name:"Add Section",slot:"end",color:"success",onClick:async(e,t,a)=>{if("string"!=typeof a.filter||a.filter.length<3)return Object(h["e"])("Please enter a valid section name");if(a.filtered.some(e=>e.label.toLowerCase()===a.filter.toLowerCase()))return Object(h["e"])("Section already existing");if(await Object(h["a"])("Do you want to add internal section?")){const e=await d["a"].createInternalSection(a.filter.toUpperCase());e?(a.filter=e.name,a.listData=[{label:e.name,value:e.id},...a.listData]):Object(h["c"])("Unable to add "+a.filter)}}}]}}}return(e,t)=>(Object(n["openBlock"])(),Object(n["createBlock"])(Object(n["unref"])(p["IonPage"]),null,{default:Object(n["withCtx"])(()=>[Object(n["createVNode"])(i["a"],{cancelDestinationPath:Object(n["unref"])(y),fields:l.value,onFinishAction:g,skipSummary:""},null,8,["cancelDestinationPath","fields"])]),_:1}))}});const y=v;t["default"]=y},e343:function(e,t,a){"use strict";a.d(t,"d",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return l}));a("13d5"),a("14d9");var n=a("2ef0");function i(e,t=""){const a=Object.values(e).filter(e=>e&&(e.tag===t||""===t)).reduce((e,t)=>{const a=t.obs?t.obs:t;return Array.isArray(a)?e=e.concat(a):"function"===typeof a?e.push(a()):e.push(a),e},[]);return Promise.all(a)}function r(e){return e.map(e=>({label:e,value:e}))}function o(e,t="name",a="name"){return e.map(e=>({label:e[t],value:e[a],other:e}))}function c(e,t,a=!1){return e.map(e=>{var i;const r=Object(n["find"])(t,{label:e});return{label:e,value:null!==(i=null===r||void 0===r?void 0:r.value)&&void 0!==i?i:"",other:{values:a?l():u()}}})}function l(){return r(["Yes","No","Unknown"])}function u(){return r(["Yes","No"])}},e86e:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return c})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return u})),a.d(t,"a",(function(){return s})),a.d(t,"h",(function(){return d})),a.d(t,"i",(function(){return f})),a.d(t,"j",(function(){return b})),a.d(t,"e",(function(){return m}));var n=a("5713"),i=a("2ef0");async function r(e=""){const t=await n["a"].getFacilities({name:e});return t.filter(e=>!Object(i["isEmpty"])(e)&&""!=e.name.trim()).map(e=>({label:e.name,value:e.location_id,other:e}))}async function o(e=""){const t=await n["a"].getLabs({search_name:e});return t.map(e=>({label:e,value:e}))}async function c(e=""){const t=await n["a"].getFacilities({name:e,tag:"Facility adult sections"});return t.map(e=>({label:e.name,value:e.name,other:e}))}async function l(){const e=await n["a"].getSpecialistClinics();return e.map(e=>({label:e.name,value:e.name,other:e}))}async function u(){const e=await n["a"].getRegions();return e.map(e=>({label:e.name,value:e.region_id,other:e}))}async function s(e){const t=await n["a"].getDistricts(e);return t.map(e=>({label:e.name,value:e.district_id,other:e}))}async function d(e,t=""){const a=await n["a"].getTraditionalAuthorities(e,t);return a.map(e=>({label:e.name,value:e.traditional_authority_id,other:e}))}async function f(e,t=""){const a=await n["a"].getVillages(e,t);return a.map(e=>({label:e.name,value:e.village_id,other:e}))}async function b(e="a",t=1){const a=await n["a"].getVillagesByName(e,t);return a.map(e=>({label:e.name,value:e.village_id,other:e}))}function m(){const e=["Catholic Church","CCAP","Seventh Day","Mosque","Primary School","Borehole","Secondary School","College","Market","Football Ground","Other"];return e.map(e=>({label:e,value:e,other:{code:e}}))}}}]);
//# sourceMappingURL=chunk-0f68ebc1.7ea087a4.js.map