(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7975ad03"],{"1d33":function(e,t,n){"use strict";n.r(t);var a=n("7a23"),i=n("7920"),o=n("cc6f"),s=n("8158");class c extends o["a"]{constructor(e,t){super(e,41,t)}static async getDiagnosis(e="",t=1,n=10){const a=s["a"].getConceptID("Qech outpatient diagnosis list");return o["a"].getJson("diagnosis",{id:a,name:e,page:t,page_size:n})}}class r extends o["a"]{constructor(e,t){super(e,105,t)}}var u=n("2706"),l=n("d95e"),d=n("2ef0"),b=n("9b7c"),f=n("b5e4"),p=n("1c74"),v=n("93c7"),g=n("e343"),w=n("d867"),O=Object(a["defineComponent"])({__name:"Diagnosis",setup(e){let t,n;const o=Object(a["ref"])("No"),s=Object(a["ref"])([]),{goToNextTask:O,patientDashboardUrl:m}=Object(v["a"])((e,a)=>{b["a"].getLatestMalariaTestResult(a).then(e=>o.value=e),t=new r(a,e),n=new c(a,e),s.value=[y("Primary"),y("Secondary"),T()]});async function j(e,a){await n.createEncounter();const i=await Object(g["d"])({...a,obs_datetime:p["e"].getSessionDate()},"diagnosis");await n.saveObservationList(i);const o=await Object(g["d"])({...a},"notes");Object(d["isEmpty"])(o)||(await t.createEncounter(),await t.saveObservationList(o)),O()}async function h(e){const t=e.some(({label:e})=>/Malaria/i.test(e));return!t||("Positive"===o.value||await Object(f["a"])(`Patient has ${o.value} malaria test result. Do you want to continue?`))}function y(e){return{id:e.toLowerCase()+"_diagnosis",helpText:e+" Diagnosis",type:l["b"].TT_INFINITE_SCROLL_MULTIPLE_SELECT,validation:t=>"Primary"===e?u["a"].required(t):null,options:async(e,t="",n=1,a=10)=>{const i=await c.getDiagnosis(t,n,a);return Object(g["a"])(i,"name","concept_id")},beforeNext:async e=>await h(e),computedValue:t=>({tag:"diagnosis",obs:t.map(({value:t})=>n.buildValueCoded(e+" Diagnosis",t))}),config:{isFilterDataViaApi:!0,showKeyboard:!0}}}function T(){return{id:"clinical_notes",helpText:"Clinical notes",type:l["b"].TT_TEXT,computedValue:e=>Object(d["isEmpty"])(e)?null:{tag:"notes",obs:t.buildValueText("Clinical notes construct",e.value)}}}return(e,t)=>(Object(a["openBlock"])(),Object(a["createBlock"])(Object(a["unref"])(w["IonPage"]),null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(i["a"],{cancelDestinationPath:Object(a["unref"])(m),fields:s.value,onFinishAction:j},null,8,["cancelDestinationPath","fields"])]),_:1}))}});const m=O;t["default"]=m},e343:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return r}));n("13d5"),n("14d9");var a=n("2ef0");function i(e,t=""){const n=Object.values(e).filter(e=>e&&(e.tag===t||""===t)).reduce((e,t)=>{const n=t.obs?t.obs:t;return Array.isArray(n)?e=e.concat(n):"function"===typeof n?e.push(n()):e.push(n),e},[]);return Promise.all(n)}function o(e){return e.map(e=>({label:e,value:e}))}function s(e,t="name",n="name"){return e.map(e=>({label:e[t],value:e[n],other:e}))}function c(e,t,n=!1){return e.map(e=>{var i;const o=Object(a["find"])(t,{label:e});return{label:e,value:null!==(i=null===o||void 0===o?void 0:o.value)&&void 0!==i?i:"",other:{values:n?r():u()}}})}function r(){return o(["Yes","No","Unknown"])}function u(){return o(["Yes","No"])}}}]);
//# sourceMappingURL=chunk-7975ad03.006cd15d.js.map