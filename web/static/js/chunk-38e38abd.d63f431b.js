(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38e38abd"],{"00a4":function(e,t,o){},"048a":function(e,t,o){"use strict";o("00a4")},"403e":function(e,t,o){"use strict";function a(e){return e.map(e=>({value:e,label:e}))}o.d(t,"d",(function(){return a})),o.d(t,"b",(function(){return n})),o.d(t,"c",(function(){return l})),o.d(t,"a",(function(){return c})),o.d(t,"e",(function(){return r})),o.d(t,"f",(function(){return i}));const n=[{label:"Male",value:"M"},{label:"Female",value:"F"}],l=(a(["TB NOT suspected","TB suspected","Confirmed TB NOT on treatment","Confirmed TB on treatment"]),[...a(["Current","Last 2 years","More than 2 years","Never"])]),c=[{label:"Rapid antibody test",value:"HIV rapid test"},{label:"DNA PCR",value:"HIV DNA polymerase chain reaction"},{label:"Not done",value:"Not done"}],r=a(["Currently on IPT","Currently on 3HP (RFP + INH)","Currently on INH 300 / RFP 300 (3HP)","Complete course of 3HP in the past (3 months RFP+INH)","Complete course of IPT in the past (min. 6 months of INH)","Aborted course of 3HP (RFP + INH) in the past","Aborted course of INH 300 / RFP 300 (3HP) in the past","Aborted course of IPT in the past","Never taken IPT or 3HP"]),i=a(["Workplace transfer/lost job-related reasons","Relocation to another place/home village","Transport due to long distance","School","Business","Marriage","Unknown","Clinic not helping","Other"])},"76df":function(e,t,o){"use strict";o.d(t,"a",(function(){return n}));var a=o("7f35");async function n(e,t="action-sheet-modal"){const o=await Object(a["c"])("Are you sure you want to void record?","Please specify reason for voiding this record",["Mistake/ Wrong Entry","Duplicate","System Error"],[{name:"Cancel",slot:"start"},{name:"Void",color:"danger",slot:"end",role:"action"}],"",t);o.selection&&"Void"===o.action&&await e(o.selection)}},be95:function(e,t,o){"use strict";var a=o("7a23");const n={key:0,class:"text-danger"},l={key:1,class:"ion-float-right ion-margin-end checkbox-label"},c={class:"inner-input-box"},r={key:0,class:"input-options"},i={class:"input-icon"};function s(e,t,o,s,u,d){const b=Object(a["resolveComponent"])("ion-checkbox"),p=Object(a["resolveComponent"])("ion-label"),m=Object(a["resolveComponent"])("ion-input"),v=Object(a["resolveComponent"])("ion-icon"),O=Object(a["resolveComponent"])("ion-chip"),h=Object(a["resolveComponent"])("ion-item"),j=Object(a["resolveComponent"])("ion-list"),f=Object(a["resolveComponent"])("ion-note");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[e.model.label?(Object(a["openBlock"])(),Object(a["createBlock"])(p,{key:0,class:"ion-padding-bottom bold"},{default:Object(a["withCtx"])(()=>[Object(a["createElementVNode"])("span",null,Object(a["toDisplayString"])(e.model.label),1),e.model.required?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",n," *")):Object(a["createCommentVNode"])("",!0),e.allowCustom?(Object(a["openBlock"])(),Object(a["createElementBlock"])("span",l,[Object(a["createTextVNode"])(" Add Custom "+Object(a["toDisplayString"])(e.model.label)+"? ",1),Object(a["createVNode"])(b,{modelValue:e.isCustom,"onUpdate:modelValue":t[0]||(t[0]=t=>e.isCustom=t),onIonChange:t[1]||(t[1]=t=>e.model.value="")},null,8,["modelValue"])])):Object(a["createCommentVNode"])("",!0)]),_:1})):Object(a["createCommentVNode"])("",!0),e.isCustom?(Object(a["openBlock"])(),Object(a["createBlock"])(m,{key:1,class:Object(a["normalizeClass"])(["box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}]),modelValue:e.customOption,"onUpdate:modelValue":t[2]||(t[2]=t=>e.customOption=t),placeholder:e.model.placeholder||e.model.label,disabled:e.model.disabled,onIonFocus:t[3]||(t[3]=()=>e.model.error=""),onIonBlur:e.validate,onIonInput:e.onCustomValue},null,8,["class","modelValue","placeholder","disabled","onIonBlur","onIonInput"])):(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",{key:2,class:Object(a["normalizeClass"])(["outer-input-box box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}])},[Object(a["createElementVNode"])("div",c,[Object(a["createElementVNode"])("div",{style:{display:"flex","flex-wrap":"wrap",width:"100%"},onClick:t[6]||(t[6]=(...t)=>e.onShowOptions&&e.onShowOptions(...t))},[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.tags,(t,o)=>(Object(a["openBlock"])(),Object(a["createBlock"])(O,{key:o},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(p,null,{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.label),1)]),_:2},1024),Object(a["createVNode"])(v,{icon:e.closeCircle,color:"danger",onClick:o=>e.diselect(t),style:{"z-index":"20"}},null,8,["icon","onClick"])]),_:2},1024))),128)),Object(a["createVNode"])(m,{disabled:e.model.disabled,placeholder:e.showPlaceholder?e.model.placeholder||"select option":"",modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=t=>e.filter=t),class:"search-input",ref:"searchInput",onKeydown:t[5]||(t[5]=t=>e.handleKeyDown(t))},null,8,["disabled","placeholder","modelValue"])]),e.showOptions?(Object(a["openBlock"])(),Object(a["createElementBlock"])("div",r,[Object(a["createVNode"])(j,null,{default:Object(a["withCtx"])(()=>[(Object(a["openBlock"])(!0),Object(a["createElementBlock"])(a["Fragment"],null,Object(a["renderList"])(e.filteredOptions,(t,o)=>{var n;return Object(a["openBlock"])(),Object(a["createBlock"])(h,{key:o,lines:o+1===e.filteredOptions.length?"none":"",color:t.value===(null===(n=e.focusedOption)||void 0===n?void 0:n.value)?"light":"",onClick:o=>e.onSelect(t)},{default:Object(a["withCtx"])(()=>[e.multiple?(Object(a["openBlock"])(),Object(a["createBlock"])(b,{key:0,class:"input-option-checkbox",slot:"start",modelValue:t.isChecked,"onUpdate:modelValue":e=>t.isChecked=e},null,8,["modelValue","onUpdate:modelValue"])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(p,null,{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.label),1)]),_:2},1024)]),_:2},1032,["lines","color","onClick"])}),128))]),_:1})])):Object(a["createCommentVNode"])("",!0),Object(a["createElementVNode"])("div",i,[e.filter||e.tags.length>0?(Object(a["openBlock"])(),Object(a["createBlock"])(v,{key:0,icon:e.close,onClick:e.resetHandler},null,8,["icon","onClick"])):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(v,{icon:e.showOptions?e.chevronUp:e.chevronDown,onClick:t[7]||(t[7]=t=>e.showOptions?e.onCloseOptions():e.onShowOptions())},null,8,["icon"])])])],2)),e.model.error?(Object(a["openBlock"])(),Object(a["createBlock"])(f,{key:3,color:"danger"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(Object(a["toDisplayString"])(e.model.error),1)]),_:1})):Object(a["createCommentVNode"])("",!0)],64)}o("14d9");var u=o("d867"),d=o("ff79"),b=o("2ef0"),p=Object(a["defineComponent"])({name:"SelectInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},allowCustom:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},infiniteScrolling:{type:Boolean,default:!1}},components:{IonLabel:u["IonLabel"],IonInput:u["IonInput"],IonNote:u["IonNote"],IonIcon:u["IonIcon"],IonCheckbox:u["IonCheckbox"],IonList:u["IonList"],IonChip:u["IonChip"],IonItem:u["IonItem"]},emits:["update:modelValue"],setup(e,{emit:t}){const o=Object(a["ref"])(!1),n=Object(a["ref"])(""),l=Object(a["ref"])(),c=Object(a["ref"])(!1),r=Object(a["ref"])(),i=Object(a["ref"])(""),s=Object(a["ref"])([]),u=Object(a["ref"])(1),p=Object(a["computed"])(()=>e.multiple?s.value.filter(({isChecked:e})=>e):l.value?[l.value]:[]),m=Object(a["computed"])(()=>!i.value&&Object(b["isEmpty"])(p.value)&&!c.value),v=Object(a["computed"])({get:()=>e.modelValue,set:e=>t("update:modelValue",e)}),O=()=>{i.value="",l.value=void 0,s.value.forEach(e=>e.isChecked=!1)},h=()=>{if(O(),Object(b["isEmpty"])(v.value.value))return;if(Array.isArray(v.value.value)&&e.multiple)return v.value.value.forEach(e=>{const t=s.value.findIndex(({value:t})=>t===e.value);-1===t?s.value.push({...e,isChecked:!0}):s.value[t].isChecked=!0});const t=s.value.find(e=>e.value===v.value.value);l.value=t||{label:v.value.value,value:v.value.value}},j=async()=>{const t="function"===typeof e.asyncOptions?await e.asyncOptions(i.value):e.options.filter(({label:e})=>e.toLowerCase().includes(i.value.toLowerCase()));p.value.forEach(e=>{const o=t.findIndex(t=>t.value===e.value);-1===o?t.push(e):t[o].isChecked=!0}),s.value=t},f=async()=>{if(v.value.required&&Object(b["isEmpty"])(v.value.value))return v.value.error="This field is required";if(v.value.validation){const t=await v.value.validation({label:v.value.value,value:v.value.value},e.form);if(t&&t.length)return v.value.error+=t.toString()}return v.value.error=""},C=()=>{c.value=!1,v.value.value=e.multiple?p.value:Object(b["isEmpty"])(p.value)?void 0:p.value[0],i.value="",f()},y=()=>{v.value.disabled||(c.value=!0,v.value.error="")},w=()=>{v.value.value={label:n.value,value:n.value}},g=t=>{e.multiple||(l.value=t,C()),v.value.value=e.multiple?p.value:Object(b["isEmpty"])(p.value)?void 0:p.value[0],i.value=""},k=t=>e.multiple?t.isChecked=!1:l.value=void 0,V=e=>{e.preventDefault();const t=s.value.indexOf(r.value)+1;r.value=s.value[t]||s.value[0]},I=e=>{e.preventDefault();const t=s.value.indexOf(r.value)-1;r.value=s.value[t]||s.value[s.value.length-1]},N=e=>{switch(c.value||(c.value=!0),e.key){case"ArrowDown":V(e);break;case"ArrowUp":I(e);break;case" ":case"Enter":g(r.value);break;case"Escape":C();break}};return Object(a["watch"])(i,async()=>{u.value++,await j()}),Object(a["watch"])([()=>e.options,()=>e.asyncOptions],async()=>j()),Object(a["watch"])(()=>e.modelValue.value,e=>Object(b["isEmpty"])(e)&&h(),{deep:!0,immediate:!0}),Object(a["watch"])(c,e=>e&&(r.value=l.value||s.value[0])),Object(a["onMounted"])(async()=>{await j(),h(),addEventListener("click",e=>{const t=e.target.closest(".inner-input-box");!t&&c.value&&C()})}),Object(a["onBeforeUnmount"])(()=>removeEventListener("click",e=>console.log(e))),{validate:f,onSelect:g,resetHandler:O,onShowOptions:y,onCloseOptions:C,diselect:k,onCustomValue:w,handleKeyDown:N,model:v,customOption:n,isCustom:o,chevronDown:d["chevronDown"],chevronUp:d["chevronUp"],close:d["close"],closeCircle:d["closeCircle"],selectedOption:l,showOptions:c,focusedOption:r,showPlaceholder:m,filteredOptions:s,filter:i,tags:p}}}),m=(o("048a"),o("6b0d")),v=o.n(m);const O=v()(p,[["render",s],["__scopeId","data-v-b64db9c4"]]);t["a"]=O},de0e:function(e,t,o){"use strict";o.r(t);var a=o("7a23");const n={style:{"max-width":"250px"},class:"ion-margin-end ion-margin-vertical"},l=Object(a["createElementVNode"])("h1",{class:"ion-margin"},"Patients Search Results",-1);function c(e,t,o,c,r,i){const s=Object(a["resolveComponent"])("ion-searchbar"),u=Object(a["resolveComponent"])("SelectInput"),d=Object(a["resolveComponent"])("ion-button"),b=Object(a["resolveComponent"])("ion-col"),p=Object(a["resolveComponent"])("ion-row"),m=Object(a["resolveComponent"])("data-table"),v=Object(a["resolveComponent"])("ion-grid");return Object(a["openBlock"])(),Object(a["createBlock"])(v,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(p,{class:"his-card"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{size:"10",style:{display:"flex","justify-content":"flex-start"}},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{style:{width:"350px",height:"2.75rem"},class:"box-input ion-no-padding ion-margin-end ion-margin-vertical",placeholder:"Search by Name or ARV Number",modelValue:e.searchText,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchText=t),onKeyup:Object(a["withKeys"])(e.searchPatient,["enter"])},null,8,["modelValue","onKeyup"]),Object(a["createElementVNode"])("div",n,[Object(a["createVNode"])(u,{modelValue:e.gender,"onUpdate:modelValue":t[1]||(t[1]=t=>e.gender=t),options:e.genderOptions,onKeyup:Object(a["withKeys"])(e.searchPatient,["enter"])},null,8,["modelValue","options","onKeyup"])]),Object(a["createVNode"])(d,{class:"ion-margin-vertical",onClick:e.searchPatient},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("Search")]),_:1},8,["onClick"]),Object(a["createVNode"])(d,{class:"ion-margin-vertical",onClick:e.resetQuery,color:"secondary"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("Reset")]),_:1},8,["onClick"])]),_:1}),Object(a["createVNode"])(b,null,{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,{class:"ion-margin-vertical",href:"/emc/patient/registration",color:"success",style:{float:"right"}},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" Add New Patient ")]),_:1})]),_:1})]),_:1}),Object(a["createVNode"])(p,{class:"his-card ion-margin-top",style:{padding:"0 !important"}},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{size:"12",style:{"min-height":"320px"},class:"ion-no-padding"},{default:Object(a["withCtx"])(()=>[l,Object(a["createVNode"])(m,{rows:e.tableRows,columns:e.tableColumns,config:e.tableConfig,"row-actions-buttons":e.TableRowActions,color:"custom"},null,8,["rows","columns","config","row-actions-buttons"])]),_:1})]),_:1})]),_:1})}o("14d9");var r=o("d867"),i=o("23e6"),s=o("cc74"),u=o("b5e4"),d=o("6605"),b=o("403e"),p=o("be95"),m=o("b211"),v=o("4971"),O=o("76df"),h=o("9283"),j=o("5a0c"),f=o.n(j),C=o("0011"),y=o("c1e4"),w=Object(a["defineComponent"])({components:{IonGrid:r["IonGrid"],IonRow:r["IonRow"],IonCol:r["IonCol"],SelectInput:p["a"],IonButton:r["IonButton"],IonSearchbar:r["IonSearchbar"],DataTable:v["DataTable"]},setup(){const e=Object(d["i"])(),t=Object(a["ref"])(""),o=Object(a["ref"])(document.getElementById("selectInput")),n=Object(a["reactive"])({value:"",placeholder:"select gender"}),l=Object(a["ref"])([]),c=[{label:"ARV Number",path:"arv_number"},{path:"given_name",label:"First name"},{path:"family_name",label:"Last name"},{path:"gender",label:"Gender",formatter:C["i"]},{path:"birthdate",label:"Date of Birth (AGE)",formatter:e=>`${f()(e).format(h["a"])} (${h["c"].getAgeInYears(e)})`}],r={showSearchField:!1,showSubmitButton:!1},p=async e=>{if(e.match(/^(\w+-ARV-\w+)$/))return{type:"arv_number",value:e};if(e.match(/^(\d+)$/)){const t=await s["c"].sitePrefix();return{type:"arv_number",value:`${t}-ARV-${e}`}}return{type:"name",value:e}},v=(e,t)=>{const o={},a=e.split(" ").filter(e=>/\S/.test(e));return a.length>0&&(o["given_name"]=a[0],o["family_name"]=a[2]||a[1]||"",o["middle_name"]=a[2]?a[1]:""),t&&(o.gender=t),o},j=async()=>{if(t.value){m["a"].show();try{const{type:e,value:o}=await p(t.value),a="name"===e?await i["a"].search(v(o,n.value.value)):"arv_number"===e?await i["a"].findByOtherID(4,o):[];await m["a"].hide(),l.value=a.map(e=>{const t=new i["a"](e);return{arv_number:t.getArvNumber(),given_name:t.getGivenName(),family_name:t.getFamilyName(),gender:t.getGender(),birthdate:t.getBirthdate(),personId:t.getID()}})}catch(e){Object(u["e"])(""+e),await m["a"].hide()}}},w=()=>{t.value="",n.value="",l.value=[]},g=()=>({label:"void",color:"danger",action:async e=>{Object(O["a"])(async t=>{try{await i["a"].voidPatient(e.personId,t),await j()}catch(o){Object(u["c"])(""+o)}},"void-modal")}}),k=Object(a["computed"])(()=>{const t=[{label:"Select",action:t=>e.push("/emc/patient/"+t.personId)}];return y["a"].isDataManager()&&t.push(g()),t});return{searchText:t,gender:n,tableRows:l,tableColumns:c,tableConfig:r,genderOptions:b["b"],selectInput:o,TableRowActions:k,searchPatient:j,resetQuery:w}}}),g=(o("e75c"),o("6b0d")),k=o.n(g);const V=k()(w,[["render",c]]);t["default"]=V},e065:function(e,t,o){},e75c:function(e,t,o){"use strict";o("e065")}}]);
//# sourceMappingURL=chunk-38e38abd.d63f431b.js.map