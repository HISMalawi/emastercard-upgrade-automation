(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-687eedc0"],{3800:function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"k",(function(){return a})),n.d(e,"f",(function(){return o})),n.d(e,"n",(function(){return s})),n.d(e,"e",(function(){return r})),n.d(e,"b",(function(){return c})),n.d(e,"m",(function(){return l})),n.d(e,"j",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"a",(function(){return g})),n.d(e,"l",(function(){return h})),n.d(e,"c",(function(){return T})),n.d(e,"i",(function(){return p})),n.d(e,"g",(function(){return m}));const i=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","Del"],["","Done",""]],a=[["1","2","3"],["4","5","6"],["7","8","9"],["Del","0","."],["Unknown","",""]],o=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0",""]],s=[["1","2","3"],["4","5","6"],["7","8","9"],[".","0","Del"],["Clear","%","/"]],r=[["1","2","3"],["4","5","6"],["7","8","9"],["Del.","0","Clear"]],c=[["1","2","3","<"],["4","5","6",">"],["7","8","9","="],["","0",""]],l=[["1","2","3","+","-","/","*"],["4","5","6","%","=","<",">","Qwerty"],["7","8","9",".",","],["","0",""]],u=[["1","2","3"],["4","5","6"],["7","8","9"],["","0",""]],d=[["1","2","3","4","5","6","7"],["8","9","10","11","12","13","14"],["15","16","17","18","19","20","21"],["22","23","24","25","26","27","28"],["29","30","31"]],g=[["a","b","c","d","e","f","g","h","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],h=[["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","'"],["z","x","c","v","b","n","m",",",".","A-Z"]],T=[["1","2","3","4","5","6","7","8","9","0"],["a","b","c","d","e","f","g","h","-","."],["i","j","k","l","m","n","o","p","q"],["r","s","t","u","v","w","x","y","z"]],p=[["1","2","3","4","5","6","7","8","9","0","Del"],["q","w","e","r","t","y","u","i","o","p","Clear"],["a","s","d","f","g","h","j","k","l",".","Caps"],["z","x","c","v","b","n","m","<",">","/","Enter"]],m=[["1","2","3","4","5","6","7","8","9","0"],["q","w","e","r","t","y","u","i","o","p"],["a","s","d","f","g","h","j","k","l","Del."],["z","x","c","v","b","n","m","Caps","Login"]]},"6be2":function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return u})),n.d(e,"h",(function(){return g})),n.d(e,"a",(function(){return h}));var i=n("3800");const a=[i["m"],[["","Delete"]]],o=[i["j"],[["Delete"]]],s=[i["j"],[["Delete","Unknown"]]],r=[i["j"],[["N/A"],["Delete","Unknown"]]],c=[i["j"],[["Delete"]]],l=[i["j"],[["Unknown","Delete"],["Qwerty","A-Z"]]],u=[i["h"],[["Unknown"]]],d=[i["a"],[["0-9","Delete"],["Qwerty","Unknown"],["","Space"]]],g=[i["l"],[["","Delete"],["?123","0-9"],["Space","Unknown"]]],h=[{btn:"0-9",keyboard:l},{btn:"?123",keyboard:a},{btn:"A-Z",keyboard:d},{btn:"Qwerty",keyboard:g}]},7365:function(t,e,n){"use strict";n("14d9"),n("13d5");var i,a=n("7a23"),o=n("ad60"),s=n("2ef0"),r=n("0fa1"),c=n("7f35"),l=n("9283");(function(t){t["SET_PROVIDER"]="SET_PROVIDER",t["CHANGE_SESSION_DATE"]="change_session_date",t["GO_TO_PATIENT_DASHBOARD"]="go_to_patient_dashboard",t["CHANGE_PATIENT_OUTCOME"]="change_outcome",t["CONTINUE"]="continue",t["EXIT"]="exit"})(i||(i={}));const u=t=>l["c"].toStandardHisDisplayFormat(t),d={"Warn if attempting to create new encounters for a deceased patient":{priority:1,actions:{alert:async({outcomeStartDate:t})=>{const e=await Object(c["a"])("Data Integrity Issue Found","Patient died on "+u(t),"Proceeding with this outcome might affect accuracy of some reports",[{name:"Cancel",slot:"end",color:"primary"},{name:"Change outcome",slot:"end",color:"primary"},{name:"Continue Anyway",slot:"end",color:"danger"}]);return"Cancel"===e?i.GO_TO_PATIENT_DASHBOARD:"Change outcome"===e?i.CHANGE_PATIENT_OUTCOME:i.CONTINUE}},conditions:{outcome(t){return"Patient died"===t},outcomeStartDate(t,{sessionDate:e}){return e>=t}}},"A patient's date of birth must not be less than Session Date":{priority:2,actions:{alert:async({birthDate:t,sessionDate:e})=>{const n=await Object(c["a"])("Data integrity issue found","",`Session date ${u(e)} is less than birth date of ${u(t)}`,[{name:"Cancel",slot:"end",color:"danger"},{name:"Change session date",slot:"end",color:"success"}]);return"Change session date"===n?i.CHANGE_SESSION_DATE:i.GO_TO_PATIENT_DASHBOARD}},conditions:{birthDate(t,{sessionDate:e}){return e<t}}},"Select Encounter provider when in back data entry":{priority:3,actions:{selection:async({providers:t,encounterName:e,sessionDate:n,apiDate:a})=>{const o=await Object(c["c"])("Please select a provider for "+e,`BDE: ${u(n)} | Current: ${u(a)}`,t,[{name:"Cancel",color:"danger",slot:"start",role:"default"},{name:"Confirm",slot:"end",role:"action"}]);return"Cancel"===o.action?{value:-1,flowState:i.GO_TO_PATIENT_DASHBOARD}:{value:o.selection,flowState:i.SET_PROVIDER}}},conditions:{isBdeMode(t){return t}}}};var g=n("c21d"),h=n("7920"),T=n("b5e4"),p=n("8e8b"),m=Object(a["defineComponent"])({components:{HisStandardForm:h["a"]},data:()=>({patient:{},fields:[],patientID:"",providerID:-1,providers:[],facts:{sessionDate:"",apiDate:"",encounterName:"N/A",providers:[],isBdeMode:!1,birthDate:"",outcome:"",outcomeStartDate:""},ready:!1}),watch:{$route:{handler(t){t.params.patient_id&&this.patientID!=t.params.patient_id&&(this.patientID=parseInt(t.params.patient_id),p["a"].get("ACTIVE_PATIENT",{patientID:this.patientID}).then(t=>{this.patient=t,this.setEncounterFacts().then(()=>{this.checkEncounterGuidelines().then(()=>{this.ready=!0})})}))},immediate:!0,deep:!0}},computed:{cancelDestination(){return this.patientDashboardUrl()}},methods:{runflowState(t,e=null){const n={};if(n[i.SET_PROVIDER]=t=>{const[e]=t.split(" "),n=Object(s["find"])(this.providers,{username:e});return n&&(this.providerID=n.person_id),i.CONTINUE},n[i.CHANGE_SESSION_DATE]=()=>(this.$router.push("/session/date?patient_dashboard_redirection_id="+this.patientID),i.EXIT),n[i.CHANGE_PATIENT_OUTCOME]=()=>(this.$router.push("/patient/programs/"+this.patientID),i.EXIT),n[i.GO_TO_PATIENT_DASHBOARD]=()=>(this.gotoPatientDashboard(),i.EXIT),t in n)return n[t](e)},async checkEncounterGuidelines(){const t=Object(g["a"])(this.facts,d);for(const s in t){var e,n;const r=t[s];if(null!==r&&void 0!==r&&null!==(e=r.actions)&&void 0!==e&&e.alert){var a;const t=this.runflowState(await(null===r||void 0===r||null===(a=r.actions)||void 0===a?void 0:a.alert(this.facts)));if(t===i.EXIT)return}if(null!==r&&void 0!==r&&null!==(n=r.actions)&&void 0!==n&&n.selection){var o;const t=await(null===r||void 0===r||null===(o=r.actions)||void 0===o?void 0:o.selection(this.facts));this.runflowState(t.flowState,t.value)}}},async setEncounterFacts(){try{const t=await p["a"].get("PATIENT_PROGRAM",{patientID:this.patientID});this.facts.outcome=t.outcome,this.facts.outcomeStartDate=t.startDate}catch(t){console.error(t),Object(T["c"])(""+t)}this.facts.sessionDate=o["a"].getSessionDate(),this.facts.apiDate=o["a"].getCachedApiDate(),this.facts.isBdeMode=o["a"].isBDE(),this.facts.birthDate=this.patient.getBirthdate(),this.facts.encounterName=this.$route.name?this.$route.name.toString().toUpperCase():"N/A",o["a"].isBDE()&&(this.providers=await p["a"].get("PROVIDERS"),this.facts.providers=this.providers.sort((t,e)=>{const n=t.username.toUpperCase(),i=e.username.toUpperCase();return n<i?-1:n>i?1:0}).map(t=>{var e;let n=""+t.username;if(!Object(s["isEmpty"])(null===t||void 0===t||null===(e=t.person)||void 0===e?void 0:e.names)){var i;const[e]=(null===(i=t.person)||void 0===i?void 0:i.names)||[];n+=` (${e.given_name} ${e.family_name})`}return n}))},toOption(t,e={}){return{label:t,value:t,other:e}},mapStrToOptions(t){return t.map(t=>({label:t,value:t}))},patientDashboardUrl(){return"/patient/dashboard/"+this.patientID},gotoPatientDashboard(){return this.$router.push({path:this.patientDashboardUrl()})},nextTask(){return Object(r["b"])(this.patientID,this.$router)},yesNoOptions(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"}]},toYesNoOption(t,e={}){return{label:t,value:"",other:{...e,values:this.yesNoOptions()}}},mapOptions(t){return t.map(t=>({label:t,value:t}))},yesNoUnknownOptions(){return[{label:"Yes",value:"Yes"},{label:"No",value:"No"},{label:"Unknown",value:"Unknown"}]},resolveObs(t,e=""){const n=Object.values(t).filter(t=>t&&(t.tag===e||""===e)).reduce((t,e)=>{const n=e.obs?e.obs:e;return Array.isArray(n)?t=t.concat(n):"function"===typeof n?t.push(n()):t.push(n),t},[]);return Promise.all(n)},inArray(t,e){try{return t.filter(t=>e(t)).length>0}catch(n){return!1}},validateSeries(t){try{for(const e in t){const n=t[e]();if(n)return n}}catch(e){return[e]}}}});const _=m;e["a"]=_},7920:function(t,e,n){"use strict";var i=n("7a23");function a(t,e,n,a,o,s){return Object(i["openBlock"])(),Object(i["createBlock"])(Object(i["resolveDynamicComponent"])(t.formType),{fields:t.fields,skipSummary:t.skipSummary,activeField:t.activeField,cancelDestinationPath:t.cancelDestinationPath,onOnFinish:t.onFinish,onFinish:t.onFinishAction,onOnIndex:t.onIndex},null,40,["fields","skipSummary","activeField","cancelDestinationPath","onOnFinish","onFinish","onOnIndex"])}var o=n("9441"),s=Object(i["defineComponent"])({name:"HisStandardForm",components:{TouchScreenForm:o["a"]},emits:["onFinish","onIndex"],data:()=>({formType:"touch-screen-form"}),props:{onFinishAction:{type:Function},skipSummary:{type:Boolean,default:!1},activeField:{type:String},fields:{type:Object,required:!0},cancelDestinationPath:{type:String,required:!1}},methods:{onFinish(t,e){this.$emit("onFinish",t,e)},onIndex(t){this.$emit("onIndex",t)}}}),r=n("d959"),c=n.n(r);const l=c()(s,[["render",a]]);e["a"]=l},"85d6":function(t,e,n){"use strict";n.d(e,"a",(function(){return _}));var i=n("ade3"),a=n("cc6f"),o=n("5713"),s=(n("13d5"),n("8158")),r=n("b5e4");const c="2014-04-01",l={"Adults with stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:t=>4===t}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{reasonForArt:t=>"WHO STAGE IV ADULT"===t}},"Adults with stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:t=>3===t}},"Adults with stage 2 conditions":{concept:"WHO STAGE II ADULT",priority:4,conditions:{stage:t=>2===t}},"Adults with stage 1 conditions":{concept:"WHO STAGE I ADULT",priority:5,conditions:{stage:t=>1===t}}},u={"Children with stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:1,conditions:{stage:t=>4===t}},"Classify as stage 4 when reason for ART is WHO STAGE 4":{concept:"WHO STAGE IV PEDS",priority:2,conditions:{reasonForArt:t=>"WHO STAGE IV PEDS"===t}},"For children with stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:3,conditions:{stage:t=>3===t}},"Children with stage 2 conditions":{concept:"WHO STAGE II PEDS",priority:4,conditions:{stage:t=>2===t}},"Children with stage 1 conditions":{concept:"WHO STAGE I PEDS",priority:5,conditions:{stage:t=>1===t}}},d={"Warn if Severe weight loss is selected when actual patient BMI is acceptable":{priority:1,actions:{alert:async t=>await Object(r["a"])(`Patient's BMI of ${t.bmi} greater than 18.5, do you wish to proceed?`,{confirmBtnLabel:"Yes, keep severe weightloss",cancelBtnLabel:"No, cancel"})},conditions:{selectedCondition(t){return"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===t},bmi:t=>t>18.5}},"Warn for contradicting stage defining conditions":{priority:1,actions:{alert:async t=>{const e=await Object(r["a"])("CONTRADICTING STAGE DEFINING CONDITIONS",{confirmBtnLabel:"Keep Asymptomatic",cancelBtnLabel:"Keep other(s)"});return!!e&&(t.stage=1,t.selectedConditions=[],t.stageThreeConditions=[],t.stageFourConditions=[],t.stageTwoConditions=[],!0)}},conditions:{selectedCondition(t){return"Asymptomatic HIV infection"===t},stage:t=>t>=2}}},g={"For children whose current weight percentile is less than 70":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:t=>"Child has a low weight percentile of "+t.weightPercentile},conditions:{selectedCondition(t){return"Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)"===t},weightPercentile(t){return t<70}}},"Enable Moderate unexplained malnutrition for children whose weight for height is 70-79%":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:t=>"Child has weight percentile of "+t.weightPercentile},conditions:{selectedCondition(t){return"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===t},weightPercentile(t){return t>=70&&t<=79}}},"Disable moderate weight loss when Severe unexplained weight loss is chosen":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:()=>"Severe weight loss/manutrition was already selected"},conditions:{selectedCondition(t){return"Moderate unexplained wasting/malnutrition not responding to treatment (weight-for-height/ -age 70-79% or muac 11-12 cm)"===t},selectedConditions(t){return t.includes("Severe unexplained wasting or malnutrition not responding to treatment (weight-for-height/ -age <70% or MUAC less than 11cm or oedema)")}}}},h={"Adults with a BMI less than 16":{priority:1,actions:{isChecked:!0},description:{color:"danger",show:"always",info:t=>"Adult has a low BMI of "+t.bmi},conditions:{selectedCondition(t){return"Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained"===t},bmi:t=>t<16}},"Adults whose BMI is between 16 and 18":{priority:3,actions:{isChecked:!0},description:{color:"warning",show:"onChecked",info:t=>`BMI of ${t.bmi} is between 16 and 18`},conditions:{selectedCondition:t=>"Moderate weight loss less than or equal to 10 percent, unexplained"===t,bmi:t=>t>=16&&t<=18.5}},"Disable Moderate weight loss if severe weightloss is selected":{priority:2,actions:{isChecked:!1,disabled:!0},description:{color:"secondary",show:"always",info:()=>"Severe weight loss was already selected"},conditions:{selectedCondition(t){return"Moderate weight loss less than or equal to 10 percent, unexplained"===t},selectedConditions(t){return t.includes("Severe weight loss >10% and/or BMI <18.5kg/m^2, unexplained")}}}},T={"Has stage 4 conditions":{concept:"WHO STAGE IV PEDS",priority:1,conditions:{stage:t=>4===t}},"Has stage 3 conditions":{concept:"WHO STAGE III PEDS",priority:2,conditions:{stage:t=>3===t}},"Children under twelve months who tested positive on Rapid test and have presumed severe HIV":{concept:"PRESUMED SEVERE HIV",priority:3,conditions:{ageInMonths(t){return t<12},selectedConditions:t=>{const e=s["a"].getConceptsByCategory("pshd_condition");for(const n in e)if(t.includes(n))return!0;return!1},testType(t){return"HIV rapid test"===t}}},"Children under twelve who tested positive via HIV DNA Polymerase Chain Reaction test":{concept:"HIV DNA polymerase chain reaction",priority:4,conditions:{ageInMonths:t=>t<12,testType:t=>"HIV DNA polymerase chain reaction"===t}},"Children who are less than 24 months":{concept:"HIV infected",priority:5,conditions:{ageInMonths:t=>t<24}},"Children between 24 and 56 months who have stage 2 or 1 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 750",priority:6,conditions:{ageInMonths(t){return t>=24&&t<=56},cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4(t){return t<=750},cd4Modifier(t){return"<"===t||"="===t},stage(t){return t<=2}}},"Children with CD4 count less than 500 and have stage 1 and stage 2 conditions":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:7,conditions:{cd4(t){return t<=500},cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4Modifier(t){return"<"===t||"="===t},stage(t){return t<=2}}},"Children over the date 2014-04-01 who are more than five years old and have cd4 count less than 500":{concept:"CD4 COUNT LESS THAN OR EQUAL TO 500",priority:9,conditions:{cd4Date:t=>new Date(t)<=new Date("2014-04-01"),age(t){return t>5},cd4(t){return t<=500},cd4Modifier(t){return"<"===t||"="===t}}},"Children over date 2014-04-01 and less than Five years old":{concept:"HIV infected",priority:10,conditions:{date(t){return t>="2014-04-01"},age(t){return t<=5}}},"Women who are breast feeding":{concept:"BREASTFEEDING",priority:11,conditions:{gender(t){return"F"===t},breastFeeding(t){return"Yes"===t},stage:t=>t<=2}},"Women who are pregnant":{concept:"PATIENT PREGNANT",priority:12,conditions:{gender(t){return"F"===t},pregnant(t){return"Yes"===t},stage(t){return t<=2}}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:13,conditions:{stage:t=>t<=2}}},p={"Has stage 4 conditions":{concept:"WHO STAGE IV ADULT",priority:1,conditions:{stage:t=>4===t}},"Has HIV wasting syndrome identified in stage 3":{concept:"WHO STAGE IV ADULT",priority:2,conditions:{selectedConditions:t=>{const e=s["a"].getConceptsByCategory("severe_hiv_wasting_syndrome"),n=e.reduce((e,n)=>t.includes(n.name)?e+1:0,0);return n>=2}}},"Has stage 3 conditions":{concept:"WHO STAGE III ADULT",priority:3,conditions:{stage:t=>3===t}},"CD4 less than 350 for adults before 2014":{concept:"cd4 less than or equal to 350",priority:4,conditions:{cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4(t){return t<=350},cd4Modifier(t){return"<"===t||"="===t}}},"CD4 less than 250 for adults after 2014":{concept:"cd4 less than or equal to 250",priority:4,conditions:{cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4(t){return t<=250},cd4Modifier(t){return"<"===t||"="===t}}},"CD4 less than 350 for adults after 2014":{concept:"cd4 less than or equal to 350",priority:5,conditions:{cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4(t){return t<=350},cd4Modifier(t){return"<"===t||"="===t}}},"CD4 less than 500 for adults after 2014":{concept:"cd4 less than or equal to 500",priority:6,conditions:{cd4Date:t=>new Date(t)<=new Date("2014-04-01"),cd4(t){return t<=500},cd4Modifier(t){return"<"===t||"="===t}}},"Women who are breast feeding":{concept:"BREASTFEEDING",priority:8,conditions:{gender(t){return"F"===t},breastFeeding(t){return"Yes"===t},stage:t=>t<=2}},"Women who are pregnant":{concept:"PATIENT PREGNANT",priority:7,conditions:{gender(t){return"F"===t},pregnant(t){return"Yes"===t},stage(t){return t<=2}}},"Asymptomatic patient with either stage one or stage two conditions":{concept:"Asymptomatic",priority:9,conditions:{stage:t=>t<=2}}};var m;(function(t){t["ADULT_STAGE_4"]="stage_4_conditions_adults",t["ADULT_STAGE_3"]="stage_3_conditions_adults",t["ADULT_STAGE_2"]="stage_2_conditions_adults",t["ADULT_STAGE_1"]="stage_1_conditions_adults",t["PEDAID_STAGE_4"]="stage_4_conditions_pedaids",t["PEDAID_STAGE_3"]="stage_3_conditions_pedaids",t["PEDAID_STAGE_2"]="stage_2_conditions_pedaids",t["PEDAID_STAGE_1"]="stage_1_conditions_pedaids"})(m||(m={}));class _ extends a["a"]{constructor(t,e,n){super(t,52,n),Object(i["a"])(this,"age",void 0),Object(i["a"])(this,"confirmatoryTest",void 0),this.age=e,this.confirmatoryTest=null}isAdult(){return this.age>=15}isPedaid(){return this.age<=14}setAge(t){this.age=t}getFacilities(t=""){return o["a"].getFacilities({name:t})}getConfirmatoryTestType(){return this.confirmatoryTest}cd4CountIsValid(t){try{return!!t.match(/^(=|<|>)([0-9]*)$/m)}catch(e){return!1}}getAlertGuidelines(){return d}getWhoStageGuidelines(){return this.isAdult()?l:u}getProgramEligibilityGuidelines(){return this.isAdult()?p:T}getRecommendedConditionGuidelines(){return this.isAdult()?h:g}getStagingConditions(t){const e=this.getStagingCategoryByNum(t);return a["a"].getConceptsByCategory(e)}getAllWhoStages(){return a["a"].getConceptsByCategory("whole_staging_numbers")}getAllReasonsForART(t=this.date,e=!1){return a["a"].getConceptsByCategory("reason_for_art").filter(n=>!(new Date(t)>new Date(c)&&n.name.match(/cd4/i))&&(!e||!n.name.match(/breastfeeding|pregnant/i)))}buildWhoStageObs(t){return this.buildValueCoded("Who stage",t)}buildWhoCriteriaObs(t){return this.buildValueCoded("Who stages criteria present",t)}buildReasonForArtObs(t){return this.buildValueCoded("Reason for ART eligibility",t)}getStagingCategoryByNum(t){switch(t){case 1:return this.isAdult()?m.ADULT_STAGE_1:m.PEDAID_STAGE_1;case 2:return this.isAdult()?m.ADULT_STAGE_2:m.PEDAID_STAGE_2;case 3:return this.isAdult()?m.ADULT_STAGE_3:m.PEDAID_STAGE_3;case 4:return this.isAdult()?m.ADULT_STAGE_4:m.PEDAID_STAGE_4;default:return""}}async loadHivConfirmatoryTestType(){const t=await a["a"].getFirstValueCoded(this.patientID,"Confirmatory hiv test type");t&&(this.confirmatoryTest=t)}}},b446:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return I}));n("14d9"),n("13d5");var i,a=n("d95e"),o=[{label:"Jan",value:1},{label:"Feb",value:2},{label:"Mar",value:3},{label:"Apr",value:4},{label:"May",value:5},{label:"Jun",value:6},{label:"Jul",value:7},{label:"Aug",value:8},{label:"Sep",value:9},{label:"Oct",value:10},{label:"Nov",value:11},{label:"Dec",value:12}],s=n("9283"),r=n("2706"),c=n("3800"),l=n("6be2"),u=n("5a0c"),d=n.n(u),g=n("1c74");function h(t,e,n=!0){const i=[];return n&&i.push("UNKNOWN"),{id:t,helpText:e+" Year",appearInSummary:()=>!1,type:a["b"].TT_TEXT,config:{customKeyboard:[c["j"],[i,["DELETE"]]]}}}function T(t,e){return{id:t,helpText:e+" Month",appearInSummary:()=>!1,type:a["b"].TT_SELECT,options:()=>o}}function p(t,e){return{id:t,helpText:e+" Day",type:a["b"].TT_MONTHLY_DAYS,appearInSummary:()=>!1}}function m(t,e){return{id:t,helpText:e+" Estimated period",type:a["b"].TT_SELECT,appearInSummary:()=>!1,options:()=>[{label:"6 months ago",value:180},{label:"12 months ago",value:365},{label:"18 months ago",value:540},{label:"24 months ago",value:730},{label:"Over 2 years ago",value:730}]}}function _(t,e){return{id:t,helpText:e+" Age Estimate",type:a["b"].TT_NUMBER,appearInSummary:()=>!1,config:{keypad:l["e"]}}}function E(t){return parseInt(t)<10?"0"+t:t}async function f(t,e,n){if(e.defaultValue){const i=await e.defaultValue(t);if(i){const[t,e,a]=i.split("-");switch(n){case"Year":return t||"";case"Month":return parseInt(e)||"";case"Day":return parseInt(a)||""}}}return""}function S(t){return s["c"].toStandardHisDisplayFormat(t)}function b(t,e,n,i){if(e.minDate){const a=e.minDate(n,i);if(new Date(t)<new Date(a))return[`${S(t)} is less than minimum date of ${S(a)}`]}if(e.maxDate){const a=e.maxDate(n,i);if(a&&new Date(t)>new Date(a))return[`${S(t)} is greater than max date of  ${S(a)}`]}}function I(t,e=""){let n="",a="",c="",l="",u=!1;const I="year_"+t.id,A="month_"+t.id,y="day_"+t.id,D="age_estimate_"+t.id,v="duration_estimate_"+t.id,C=h(I,t.helpText,t.estimation.allowUnknown),w=T(A,t.helpText),N=p(y,t.helpText),O=_(D,t.helpText),F=m(v,t.helpText),P="boolean"===typeof t.estimation.allowUnknownMonthDay&&t.estimation.allowUnknownMonthDay,H=e=>!(e[I]&&e[I].value&&["Unknown"].includes(e[I].value))&&(!t.condition||t.condition(e)),R=(t,e)=>{const n=[{type:"year",value:a,default:"YYYY"},{type:"month",value:c,default:"MM"},{type:"day",value:l,default:"DD"}];return n.reduce((n,i)=>{const a=[null,void 0,"Unknown",""];return e===i.type?a.includes(t)?n.push(i.default):n.push(t):a.includes(i.value)?n.push(i.default):n.push(i.value),n},[]).join("-")};"function"===typeof t.init&&(C.init=t.init),C.updateHelpTextOnValue=t=>`${C.helpText} (${R(null===t||void 0===t?void 0:t.label,"year")})`,C.proxyID=t.id,C.unload=t=>a=t.value.toString(),C.config={...C.config,...t.config},C.defaultValue=e=>f(e,t,"Year"),C.condition=e=>!t.condition||t.condition(e),C.validation=(e,n,i)=>{if(t.required&&r["a"].required(e))return["Year cannot be empty"];const a=e?e.value:"";if(!t.estimation.allowUnknown&&a.toString().match(/unknown/i))return["Value unknown is not permitted"];if(a&&!["Unknown"].includes(a)&&isNaN(a)||a<1900)return["Invalid Year"];if(a&&"function"===typeof t.minDate){const e=s["c"].getYear(t.minDate(n,i));if(parseInt(a)<e)return[`Year of ${a} is less than Minimum year of ${e}`]}if(a&&"function"===typeof t.maxDate){const e=t.maxDate(n,i);if(e&&a>s["c"].getYear(e))return[`Year of ${a} exceeds Maximum year of ${s["c"].getYear(e)}`]}return null},C.summaryMapValue=()=>({label:t.summaryLabel||t.helpText,value:n?S(n):"Unknown"}),C.appearInSummary=(e,n)=>n===t.id,C.computedValue=e=>{if(n){const[i,a,o]=n.split("-");return n=`${e.value}-${a}-${o}`,t.computeValue(n,!1)}if(e&&"Unknown"===e.value)return n="",t.computeValue("Unknown",!1)},w.updateHelpTextOnValue=t=>`${w.helpText} (${R(null===t||void 0===t?void 0:t.label,"month")})`,w.proxyID=t.id,w.unload=t=>c=E(t.value.toString()),w.condition=t=>H(t),w.validation=t=>r["a"].required(t),w.defaultValue=e=>f(e,t,"Month"),P&&(w.options=()=>[...o,{label:"Unknown",value:"Unknown"}]),w.computedValue=(e,i)=>{if((""+e.value).match(/unknown/i))return n=i[I].value+"-07-15",t.computeValue(n,!0);if(n){const[i,a,o]=n.split("-"),s=E(""+e.value);return n=`${i}-${s}-${o}`,t.computeValue(n,!1)}},N.proxyID=t.id,N.updateHelpTextOnValue=t=>`${N.helpText} (${R(null===t||void 0===t?void 0:t.label,"day")})`,N.condition=t=>!(""+t[A].value).match(/unknown/i)&&H(t),N.validation=(e,i,o)=>r["a"].required(e)?["Day is required for date"]:(u=!!(""+e.value).match(/unknown/i),l=u?"15":E(""+e.value),n=`${a}-${c}-${l}`,b(n,t,i,o)),N.defaultValue=e=>f(e,t,"Day"),N.computedValue=()=>t.computeValue(n,u),N.unload=(e,n,i,a)=>{t.unload&&t.unload(e,n,i,a)},N.beforeNext=(e,i)=>!t.beforeNext||t.beforeNext(n,i),N.config={year:t=>t[I].value,month:t=>t[A].value},P||(N.config.keyboardActions=[]);const L=(e,n)=>{const i=["Unknown"===e[I].value,!t.condition||t.condition(e),t.estimation.estimationFieldType===n];return i.every(Boolean)};return O.proxyID=t.id,O.validation=(e,i,a)=>{if(e&&e.value>300)return["Age estimate is too high and exceeding hard limit of 300"];if(isNaN(parseInt(e.value.toString())))return["Please enter a valid number"];const o=/^(12[0-7]|1[01][0-9]|[1-9]?[0-9])$/;if(!e.value.toString().match(o))return["Not a valid age estimate"];const s=d()(g["e"].getSessionDate()).subtract(e.value,"years").year();return n=s+"-07-15",b(n,t,i,a)},O.condition=t=>L(t,i.AGE_ESTIMATE_FIELD),O.computedValue=()=>t.computeValue(n,!0),O.beforeNext=(e,i)=>!t.beforeNext||t.beforeNext(n,i),F.proxyID=t.id,F.validation=(e,i,a)=>r["a"].required(e)?["Please select an estimate"]:(n=d()(g["e"].getSessionDate()).subtract(e.value,"day").format(s["b"]),b(n,t,i,a)),F.condition=t=>L(t,i.MONTH_ESTIMATE_FIELD),F.computedValue=()=>t.computeValue(n,!0),F.beforeNext=(e,i)=>!t.beforeNext||t.beforeNext(n,i),[C,w,N,O,F]}(function(t){t["AGE_ESTIMATE_FIELD"]="age-estimate-field",t["MONTH_ESTIMATE_FIELD"]="month-period-estimate-field"})(i||(i={}))},c21d:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("14d9");function i(t,e){const n=[],i=[-1,"",null,void 0];for(const a in e){if(!(a in t))continue;const o=t[a];i.includes(o)?n.push(!1):n.push(e[a](o,t))}return n.every(Boolean)}function a(t){return t.sort((t,e)=>t.priority&&e.priority&&t.priority<e.priority?-1:1)}function o(t){return t.sort((t,e)=>t.weight&&e.weight&&t.weight>e.weight?-1:1)}function s(t,e,n="",s="",r="priority"){const c=[];for(const a in e){const o=e[a],r=[o.target&&n&&o.target!=n,o.targetEvent&&s&&o.targetEvent!=s];r.some(Boolean)||i(t,o.conditions)&&(o.title=a,o.description&&(o.description.text=o.description.info(t)),c.push(o))}return"priority"===r?a(c):o(c)}},d95e:function(t,e,n){"use strict";var i;n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),function(t){t["TT_MULTI_SELECT_GRID"]="HisMultiSelectGrid",t["TT_AGE_INPUT"]="HisAgeInput",t["TT_GROUP_SELECTOR"]="HisGroupSelector",t["TT_DATA_TABLE"]="HisDataTable",t["TT_GRID_SELECTOR"]="HisGridSelector",t["TT_NOTE"]="HisNote",t["TT_BARCODE"]="HisBarcodeInput",t["TT_MONTHLY_DAYS"]="HisMonthlyDays",t["TT_TEXT"]="HisTextInput",t["TT_NUMBER"]="HisNumberInput",t["TT_DATETIME"]="datetime",t["TT_SELECT"]="HisSelect",t["TT_MULTIPLE_SELECT"]="HisMultipleSelect",t["TT_ART_REGIMEN_SELECTION"]="HisArtRegimenSelection",t["TT_NEXT_VISIT_INTERVAL_SELECTION"]="HisNextVisitInterval",t["TT_TABLE_VIEWER"]="HisTableViewer",t["TT_DOSAGE_INPUT"]="HisDosageInput",t["TT_YES_NO"]="YesNoSelect",t["TT_MULTIPLE_YES_NO"]="MultiYesNoSelect",t["TT_SUMMARY"]="HisSummary",t["TT_WEIGHT_CHART"]="HisWeightChart",t["TT_VITALS_ENTRY"]="HisVitalsEntry",t["TT_ADHERENCE_INPUT"]="HisAdherenceInput",t["TT_ART_STAGING_SUMMARY"]="ArtStagingSummary",t["TT_LAB_ORDERS"]="HisLabOrders",t["TT_APPOINTMENTS_ENTRY"]="HisAppointments",t["TT_DISPENSATION_INPUT"]="DrugDispensationSelection",t["TT_PROGRAM_SELECTION"]="ProgramSelection",t["TT_DATE_PICKER"]="HisDatePicker",t["TT_PERSON_RESULT_VIEW"]="PersonSearchView",t["TT_RELATION_SELECTION"]="RelationsSelection",t["TT_FILING_NUMBER_VIEW"]="FilingNumberView",t["TT_CARD_SELECTOR"]="HisCardSelector",t["TT_PERSON_MATCH_VIEW"]="PersonMatchView",t["TT_FULL_DATE"]="HisDateInput",t["TT_BATCH_ENTRY"]="HisBatchEntry",t["TT_BATCH_VERIFICATION"]="HisBatchVerification",t["TT_BATCH_MOVEMENT"]="HisBatchMovement",t["TT_COMPLAINTS_PICKER"]="HisComplaintsPicker",t["TT_RADIOLOGY_PICKER"]="HisRadiologyPicker",t["TT_IP_ADDRESS"]="HisIPAddress",t["TT_TEXT_BANNER"]="HisTextBanner",t["TT_DRUG_DISPENSER"]="GeneralDrugDispenser",t["TT_CLINIC_HOLIDAY_PICKER"]="HisClinicHolidayPicker",t["TT_ANC_PREGNANCY_INPUT_CONFIG"]="AncPregnancyInfoConfig",t["TT_ANC_PREGNANCY_DETAILS_INPUT"]="AncPregnancyDetailsInput",t["TT_ANC_LMP_DATE_INPUT"]="AncLmpDateInput",t["TT_ANC_DRUGSET_INPUT"]="AncDrugSetInput",t["TT_DRUG_TRANSFER_IN"]="DrugTransferInput",t["TT_PRESCRIPTION_INPUT"]="HisPrescriptionInput",t["TT_INFINITE_SCROLL_MULTIPLE_SELECT"]="HisInfiniteScrollMultipleSelect"}(i||(i={}));const a=[i.TT_MULTI_SELECT_GRID,i.TT_AGE_INPUT,i.TT_BARCODE,i.TT_NOTE,i.TT_SELECT,i.TT_CARD_SELECTOR,i.TT_MULTIPLE_SELECT,i.TT_TEXT,i.TT_NUMBER,i.TT_MONTHLY_DAYS,i.TT_ART_REGIMEN_SELECTION,i.TT_NEXT_VISIT_INTERVAL_SELECTION,i.TT_TABLE_VIEWER,i.TT_DOSAGE_INPUT,i.TT_YES_NO,i.TT_MULTIPLE_YES_NO,i.TT_WEIGHT_CHART,i.TT_VITALS_ENTRY,i.TT_APPOINTMENTS_ENTRY,i.TT_COMPLAINTS_PICKER,i.TT_CLINIC_HOLIDAY_PICKER,i.TT_SUMMARY,i.TT_ART_STAGING_SUMMARY,i.TT_ADHERENCE_INPUT,i.TT_LAB_ORDERS,i.TT_PERSON_RESULT_VIEW,i.TT_PROGRAM_SELECTION,i.TT_DATE_PICKER,i.TT_RELATION_SELECTION,i.TT_FILING_NUMBER_VIEW,i.TT_PERSON_MATCH_VIEW,i.TT_FULL_DATE,i.TT_BATCH_ENTRY,i.TT_BATCH_VERIFICATION,i.TT_BATCH_MOVEMENT,i.TT_IP_ADDRESS,i.TT_TEXT_BANNER,i.TT_DISPENSATION_INPUT,i.TT_DATA_TABLE,i.TT_GROUP_SELECTOR,i.TT_ANC_PREGNANCY_INPUT_CONFIG,i.TT_ANC_PREGNANCY_DETAILS_INPUT,i.TT_ANC_LMP_DATE_INPUT,i.TT_DRUG_TRANSFER_IN,i.TT_GRID_SELECTOR,i.TT_ANC_DRUGSET_INPUT,i.TT_RADIOLOGY_PICKER,i.TT_PRESCRIPTION_INPUT,i.TT_INFINITE_SCROLL_MULTIPLE_SELECT,i.TT_DRUG_DISPENSER]},daa6:function(t,e,n){"use strict";n("13d5"),n("14d9");var i=n("7a23"),a=n("d95e"),o=n("85d6"),s=n("7365"),r=n("2706"),c=n("b446"),l=n("9283"),u=n("2ef0"),d=n("3800"),g=n("c21d"),h=n("e86e"),T=Object(i["defineComponent"])({mixins:[s["a"]],data:()=>({staging:{},showStagingWeightChart:!0,canShowStagingFields:!0,bmiObj:{},stagingFacts:{age:-1,bmi:-1,gender:"",stage:-1,cd4:-1,cd4Date:"",date:"",isChildBearing:!1,stageOneConditions:[],stageTwoConditions:[],stageThreeConditions:[],stageFourConditions:[],reasonForArt:"",testType:"",pregnant:"",breastFeeding:"",selectedCondition:"",selectedConditions:[],weightPercentile:-1,ageInMonths:-1,cd4Modifier:"",whoStage:""}}),watch:{ready:{handler(t){t&&(this.staging=new o["a"](this.patient.getID(),this.patient.getAge(),this.providerID))},immediate:!0}},methods:{async initStaging(t){await this.staging.loadHivConfirmatoryTestType(),this.bmiObj=await t.getBMI(),this.stagingFacts.age=t.getAge(),this.stagingFacts.bmi=this.bmiObj["index"],this.stagingFacts.date=o["a"].getSessionDate(),this.stagingFacts.gender=t.isMale()?"M":"F",this.stagingFacts.testType=this.staging.getConfirmatoryTestType(),this.stagingFacts.ageInMonths=t.getAgeInMonths(),this.stagingFacts.isChildBearing=t.isChildBearing(),this.staging.isPedaid()&&(this.stagingFacts.weightPercentile=await t.calculateWeightPercentile())},async submitStaging(t){const e=await this.staging.createEncounter();if(!e)throw"Unable to create staging encounter";const n=await this.resolveObs(t,"staging"),i=await Promise.all([this.buildReasonForArtObs(),this.buildWhoStageObs()]),a=await this.staging.saveObservationList([...n,...i]);if(!a)throw"Unable to save patient observations"},async onStagingCondition({label:t}){var e,n;this.stagingFacts.selectedCondition=t;const i=this.staging.getAlertGuidelines(),a=Object(g["a"])(this.stagingFacts,i);if(Object(u["isEmpty"])(a))return!0;if(null!==(e=a[0])&&void 0!==e&&e.actions&&null!==(n=a[0])&&void 0!==n&&n.actions.alert){var o;const t=await(null===(o=a[0])||void 0===o?void 0:o.actions.alert(this.stagingFacts));return!!t}return!0},getFacilities(t=""){return Object(h["b"])(t)},updateStagingFacts(){const t=[this.stagingFacts.stageOneConditions,this.stagingFacts.stageTwoConditions,this.stagingFacts.stageThreeConditions,this.stagingFacts.stageFourConditions];this.stagingFacts.stage=t.reduce((t,e,n)=>Object(u["isEmpty"])(e)?t:n+1,0),this.stagingFacts.selectedConditions=t.reduce((t,e)=>t.concat(e),[])},buildReasonForArtObs(){return this.staging.buildReasonForArtObs(this.stagingFacts.reasonForArt)},buildWhoStageObs(){return this.staging.buildWhoStageObs(this.stagingFacts.whoStage)},buildStagingOptions(t,e=[]){const n=this.staging.getRecommendedConditionGuidelines();return this.staging.getStagingConditions(t).map(t=>{let i,a=!1,o=e.includes(t.name);this.stagingFacts.selectedCondition=t.name;const s=Object(g["a"])(this.stagingFacts,n);if(!Object(u["isEmpty"])(s)){var r,c;const t=s[0];null!==t&&void 0!==t&&null!==(r=t.actions)&&void 0!==r&&r.isChecked&&(o=!0),null!==t&&void 0!==t&&null!==(c=t.actions)&&void 0!==c&&c.disabled&&(a=!0),i=t.description}return{label:t.name,value:t.concept_id,isChecked:o,disabled:a,description:i}})},setWhoStage(){var t;const e=this.staging.getWhoStageGuidelines(),n=Object(g["a"])(this.stagingFacts,e);this.stagingFacts.whoStage=(null===(t=n[0])||void 0===t?void 0:t.concept)||""},setReasonForArt(){var t;const e=this.staging.getProgramEligibilityGuidelines(),n=Object(g["a"])(this.stagingFacts,e);this.stagingFacts.reasonForArt=(null===(t=n[0])||void 0===t?void 0:t.concept)||""},notAsymptomatic(t){const e=t.stage_1_conditions;if(e){const t=e.filter(t=>t.label.match(/asymptomatic/i)&&t.isChecked);return Object(u["isEmpty"])(t)}return!0},hasTransferLater(t){return"has_transfer_letter"in t&&(t.has_transfer_letter&&"Yes"===t.has_transfer_letter.value)},hasStaging(t){return!!this.hasTransferLater(t)||this.canShowStagingFields},getStagingSummaryField(t="Summary"){return{id:"summary",helpText:t,type:a["b"].TT_ART_STAGING_SUMMARY,condition:t=>this.hasStaging(t),onload:()=>{this.setReasonForArt(),this.setWhoStage()},options:()=>[{label:"WHO Stage",value:this.stagingFacts.whoStage,other:{type:"title-section"}},{label:"Condition on starting ART",value:this.stagingFacts.reasonForArt,other:{type:"title-section"}},...this.stagingFacts.selectedConditions.map(t=>({label:t,value:t}))],config:{title:"Selected stage defining conditions",hiddenFooterBtns:["Clear"]}}},isANCclient(){return"ANC"===o["a"].getSuspendedProgram()},getStagingFields(){return[{id:"pregnancy_status",helpText:"Pregnant / Breastfeeding",type:a["b"].TT_MULTIPLE_YES_NO,validation:t=>r["a"].anyEmpty(t),summaryMapValue:t=>({label:t.label,value:t.value}),computedValue:(t,e)=>{let n=[];return this.isANCclient()&&!this.hasTransferLater(e)&&(this.stagingFacts["pregnant"]="Yes",n.push(this.staging.buildValueCoded("Is patient pregnant","Yes"))),n=n.concat(t.map(t=>{const{value:e,other:n}=t,i=n.factID;return this.stagingFacts[i]=(""+e).match(/Yes/i)?"Yes":"No",this.staging.buildValueCoded(n.concept,e)})),{obs:n,tag:"staging"}},options:t=>{if(Object(u["isEmpty"])(t.pregnancy_status)){const e=[];return this.isANCclient()&&!this.hasTransferLater(t)||e.push({label:"Pregnant?",value:"",other:{values:this.yesNoOptions(),concept:"Is patient pregnant",factID:"pregnant"}}),e.push({label:"Breastfeeding?",value:"",other:{values:this.yesNoOptions(),concept:"Is patient breast feeding",factID:"breastFeeding"}}),e}return t.pregnancy_status},condition:t=>this.hasStaging(t)&&this.stagingFacts.isChildBearing},{id:"patient_weight_chart",helpText:"Weight history",type:a["b"].TT_WEIGHT_CHART,options:async()=>{let t=await this.patient.getWeightHistory();return t=t.map(t=>({x:l["c"].toStandardHisDisplayFormat(t.date),y:t.weight})),[{label:"Weight for patient",value:"Weight trail",other:{values:t,age:this.patient.getAge(),bmi:this.bmiObj}}]},config:{hiddenFooterBtns:["Clear"]},condition:t=>this.hasStaging(t)&&this.showStagingWeightChart},{id:"stage_4_conditions",helpText:"Stage 4 conditions",type:a["b"].TT_MULTIPLE_SELECT,options:()=>this.buildStagingOptions(4,this.stagingFacts.stageFourConditions),onValue:t=>this.onStagingCondition(t),computedValue:t=>({tag:"staging",obs:t.map(t=>this.staging.buildWhoCriteriaObs(t.label))}),unload:t=>{this.stagingFacts.stageFourConditions=t.map(t=>t.label),this.updateStagingFacts()},onConditionFalse:()=>{this.stagingFacts.stageFourConditions=[],this.updateStagingFacts()},condition:t=>this.hasStaging(t)&&this.notAsymptomatic(t)},{id:"stage_3_conditions",helpText:"Stage 3 conditions",type:a["b"].TT_MULTIPLE_SELECT,options:()=>this.buildStagingOptions(3,this.stagingFacts.stageThreeConditions),onValue:t=>this.onStagingCondition(t),computedValue:t=>({tag:"staging",obs:t.map(t=>this.staging.buildWhoCriteriaObs(t.label))}),unload:t=>{this.stagingFacts.stageThreeConditions=t.map(t=>t.label),this.updateStagingFacts()},onConditionFalse:()=>{this.stagingFacts.stageThreeConditions=[],this.updateStagingFacts()},condition:t=>this.hasStaging(t)&&this.notAsymptomatic(t)},{id:"stage_2_conditions",helpText:"Stage 2 conditions",type:a["b"].TT_MULTIPLE_SELECT,options:()=>this.buildStagingOptions(2,this.stagingFacts.stageTwoConditions),onValue:t=>this.onStagingCondition(t),computedValue:t=>({tag:"staging",obs:t.map(t=>this.staging.buildWhoCriteriaObs(t.label))}),unload:t=>{this.stagingFacts.stageTwoConditions=t.map(t=>t.label),this.updateStagingFacts()},onConditionFalse:()=>{this.stagingFacts.stageTwoConditions=[],this.updateStagingFacts()},condition:t=>this.hasStaging(t)&&this.notAsymptomatic(t)},{id:"stage_1_conditions",helpText:"Stage 1 conditions",type:a["b"].TT_MULTIPLE_SELECT,validation:t=>{if(Object(u["isEmpty"])(t)&&Object(u["isEmpty"])(this.stagingFacts.selectedConditions))return["Please provide atleast one staging condition"]},options:()=>this.buildStagingOptions(1,this.stagingFacts.stageOneConditions),onValue:t=>this.onStagingCondition(t),computedValue:t=>{const e=t.map(t=>t.label);return this.stagingFacts.stageOneConditions=e,this.updateStagingFacts(),{tag:"staging",obs:e.map(t=>this.staging.buildWhoCriteriaObs(t))}},condition:t=>this.hasStaging(t)},{id:"cd4_available",helpText:"Recent CD4 count results available?",type:a["b"].TT_SELECT,condition:t=>this.hasStaging(t),validation:t=>r["a"].required(t),options:()=>this.yesNoOptions()},{id:"cd4_count",helpText:"CD4 Count",type:a["b"].TT_TEXT,computedValue:t=>{const e=t.value.toString(),n=e.charAt(0),i=parseInt(e.substring(1));return{tag:"staging",modifier:n,count:i,obs:this.staging.buildValueNumber("CD4 count",i,n)}},unload:(t,e,n,i)=>{const{count:a,modifier:o}=i["cd4_count"];this.stagingFacts.cd4=a,this.stagingFacts.cd4Modifier=o},onConditionFalse:()=>{this.stagingFacts.cd4=-1,this.stagingFacts.cd4Modifier=""},validation:t=>{const e=()=>this.staging.cd4CountIsValid(t.value);return this.validateSeries([()=>r["a"].required(t),()=>e()?null:["Please start with either modifier first: >, <, or ="]])},config:{customKeyboard:[d["b"],[["Unknown","Delete"]]]},condition:t=>this.hasStaging(t)&&"Yes"===t.cd4_available.value},...Object(c["b"])({id:"cd4_result_date",helpText:"Cd4 Results",required:!0,minDate:()=>this.patient.getBirthdate(),maxDate:()=>this.staging.getDate(),condition:t=>this.hasStaging(t)&&"Yes"===t.cd4_available.value,estimation:{allowUnknown:!1},computeValue:(t,e)=>(this.stagingFacts.cd4Date=t,{date:t,tag:"staging",isEstimate:e,obs:this.staging.buildValueDate("Cd4 count datetime",t)})},this.staging.getDate()),{id:"location",helpText:"CD4 Location",type:a["b"].TT_SELECT,defaultValue:()=>o["a"].getLocationName(),computedValue:({label:t})=>({tag:"staging",obs:this.staging.buildValueText("Cd4 count location",t)}),validation:t=>r["a"].required(t),options:(t,e="")=>this.getFacilities(e),config:{showKeyboard:!0,isFilterDataViaApi:!0},condition:t=>this.hasStaging(t)&&"Yes"===t.cd4_available.value}]}}});const p=T;e["a"]=p},e86e:function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"c",(function(){return r})),n.d(e,"g",(function(){return c})),n.d(e,"f",(function(){return l})),n.d(e,"a",(function(){return u})),n.d(e,"h",(function(){return d})),n.d(e,"i",(function(){return g})),n.d(e,"j",(function(){return h})),n.d(e,"e",(function(){return T}));var i=n("5713"),a=n("2ef0");async function o(t=""){const e=await i["a"].getFacilities({name:t});return e.filter(t=>!Object(a["isEmpty"])(t)&&""!=t.name.trim()).map(t=>({label:t.name,value:t.location_id,other:t}))}async function s(t=""){const e=await i["a"].getLabs({search_name:t});return e.map(t=>({label:t,value:t}))}async function r(t=""){const e=await i["a"].getFacilities({name:t,tag:"Facility adult sections"});return e.map(t=>({label:t.name,value:t.name,other:t}))}async function c(){const t=await i["a"].getSpecialistClinics();return t.map(t=>({label:t.name,value:t.name,other:t}))}async function l(){const t=await i["a"].getRegions();return t.map(t=>({label:t.name,value:t.region_id,other:t}))}async function u(t){const e=await i["a"].getDistricts(t);return e.map(t=>({label:t.name,value:t.district_id,other:t}))}async function d(t,e=""){const n=await i["a"].getTraditionalAuthorities(t,e);return n.map(t=>({label:t.name,value:t.traditional_authority_id,other:t}))}async function g(t,e=""){const n=await i["a"].getVillages(t,e);return n.map(t=>({label:t.name,value:t.village_id,other:t}))}async function h(t="a",e=1){const n=await i["a"].getVillagesByName(t,e);return n.map(t=>({label:t.name,value:t.village_id,other:t}))}function T(){const t=["Catholic Church","CCAP","Seventh Day","Mosque","Primary School","Borehole","Secondary School","College","Market","Football Ground","Other"];return t.map(t=>({label:t,value:t,other:{code:t}}))}},f159:function(t,e,n){var i={"./AncDrugSetInput.vue":["c99fb","TouchFormElement0"],"./AncLmpDateInput.vue":["101a","TouchFormElement1"],"./AncPregnancyDetailsInput.vue":["b043","TouchFormElement2"],"./AncPregnancyInfoConfig.vue":["262e","TouchFormElement3"],"./ArtStagingSummary.vue":["43db","TouchFormElement4"],"./BaseTextInput.vue":["36ad","TouchFormElement5"],"./DrugDispensationSelection.vue":["05d5","TouchFormElement6"],"./DrugTransferInput.vue":["de42","TouchFormElement7"],"./FieldMixin.vue":["51c8","TouchFormElement8"],"./FilingNumberView.vue":["c650","TouchFormElement9"],"./GeneralDrugDispenser.vue":["7737","TouchFormElement10"],"./HisAdherenceInput.vue":["f2c3","TouchFormElement11"],"./HisAgeInput.vue":["c05f","TouchFormElement12"],"./HisAppointments.vue":["b2eb","chunk-366b6f0a","TouchFormElement13"],"./HisArtRegimenSelection.vue":["47b9","TouchFormElement14"],"./HisBarcodeInput.vue":["dd65","TouchFormElement15"],"./HisBatchEntry.vue":["f2ab","chunk-fb7a1668","TouchFormElement16"],"./HisBatchMovement.vue":["5148","chunk-fb7a1668","TouchFormElement17"],"./HisBatchVerification.vue":["7b0f","chunk-fb7a1668","TouchFormElement18"],"./HisCardSelector.vue":["0734","TouchFormElement19"],"./HisClinicHolidayPicker.vue":["4030","chunk-366b6f0a","TouchFormElement20"],"./HisComplaintsPicker.vue":["82d1","TouchFormElement21"],"./HisDataTable.vue":["a6ba","TouchFormElement22"],"./HisDateInput.vue":["374c","TouchFormElement23"],"./HisDatePicker.vue":["9b30","chunk-366b6f0a","TouchFormElement24"],"./HisDosageInput.vue":["b34c","TouchFormElement25"],"./HisGridSelector.vue":["112a","TouchFormElement26"],"./HisGroupSelector.vue":["81cf","TouchFormElement27"],"./HisIPAddress.vue":["2a82","TouchFormElement28"],"./HisInfiniteScrollMultipleSelect.vue":["52a3","TouchFormElement29"],"./HisLabOrders.vue":["e614","TouchFormElement30"],"./HisMonthlyDays.vue":["69cf4","TouchFormElement31"],"./HisMultiSelectGrid.vue":["0fa3","TouchFormElement32"],"./HisMultipleSelect.vue":["2fd5","chunk-8a3b8db0","TouchFormElement33"],"./HisNextVisitInterval.vue":["3126","TouchFormElement34"],"./HisNote.vue":["c927","TouchFormElement35"],"./HisNumberInput.vue":["5e75","TouchFormElement36"],"./HisPrescriptionInput.vue":["87e5","TouchFormElement37"],"./HisRadiologyPicker.vue":["adc7","chunk-3c642140","TouchFormElement38"],"./HisSelect.vue":["d11f","TouchFormElement39"],"./HisSummary.vue":["e0bd","TouchFormElement40"],"./HisTableViewer.vue":["8904","TouchFormElement41"],"./HisTextBanner.vue":["952c","TouchFormElement42"],"./HisTextInput.vue":["6ef9","TouchFormElement43"],"./HisVitalsEntry.vue":["e333","TouchFormElement44"],"./HisWeightChart.vue":["26a1","TouchFormElement45"],"./MultiYesNoSelect.vue":["5fd1","TouchFormElement46"],"./PersonMatchView.vue":["6591","TouchFormElement47"],"./PersonSearchView.vue":["28b2","TouchFormElement48"],"./ProgramSelection.vue":["e3b4","TouchFormElement49"],"./RelationsSelection.vue":["0e57","TouchFormElement50"],"./SelectMixin.vue":["82a9","TouchFormElement51"],"./YesNoSelect.vue":["71f2","TouchFormElement52"]};function a(t){if(!n.o(i,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],a=e[0];return Promise.all(e.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="f159",t.exports=a}}]);
//# sourceMappingURL=chunk-687eedc0.2e97ab3e.js.map