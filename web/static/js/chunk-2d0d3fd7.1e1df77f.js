(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3fd7"],{"5eb3":function(e,t,a){"use strict";a.r(t);var o=a("7a23");function i(e,t,a,i,l,r){const n=Object(o["resolveComponent"])("ion-title"),d=Object(o["resolveComponent"])("text-input"),u=Object(o["resolveComponent"])("ion-col"),c=Object(o["resolveComponent"])("DateInput"),s=Object(o["resolveComponent"])("yes-no-input"),m=Object(o["resolveComponent"])("SelectInput"),b=Object(o["resolveComponent"])("NumberInput"),v=Object(o["resolveComponent"])("ion-button"),p=Object(o["resolveComponent"])("ion-row");return Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],null,[Object(o["createVNode"])(n,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])(" HIV Clinic Registration ")]),_:1}),Object(o["createVNode"])(p,{class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(u,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(d,{modelValue:e.form.arvNumber,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.arvNumber=t),form:e.form,prefix:e.sitePrefix+"-ARV-",disabled:!e.isNewPatient},null,8,["modelValue","form","prefix","disabled"])]),_:1}),Object(o["createVNode"])(u,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:e.form.initialVisitDate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.initialVisitDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),Object(o["createVNode"])(u,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(s,{modelValue:e.form.shouldFollowUp,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.shouldFollowUp=t),inline:""},null,8,["modelValue"])]),_:1}),Object(o["createVNode"])(u,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(s,{modelValue:e.form.receivedArvTreatmentBefore,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.receivedArvTreatmentBefore=t),inline:""},null,8,["modelValue"])]),_:1}),"Yes"===e.form.receivedArvTreatmentBefore.value?(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:0},[Object(o["createVNode"])(u,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:e.form.dateLastTakenArvs,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.dateLastTakenArvs=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(o["createVNode"])(u,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(s,{modelValue:e.form.everRegisteredAtClinic,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.everRegisteredAtClinic=t),inline:""},null,8,["modelValue"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0),"Yes"===e.form.everRegisteredAtClinic.value?(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:1},[Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.artInitiationLocation,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.artInitiationLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:e.form.artStartDate,"onUpdate:modelValue":t[7]||(t[7]=t=>e.form.artStartDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(o["createVNode"])(u,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:e.form.initialWeight,"onUpdate:modelValue":t[8]||(t[8]=t=>e.form.initialWeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(o["createVNode"])(u,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:e.form.initialHeight,"onUpdate:modelValue":t[9]||(t[9]=t=>e.form.initialHeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.initialTBStatus,"onUpdate:modelValue":t[10]||(t[10]=t=>e.form.initialTBStatus=t),form:e.form,options:e.initialTbStatusOptions},null,8,["modelValue","form","options"])]),_:1}),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.tptHistory,"onUpdate:modelValue":t[11]||(t[11]=t=>e.form.tptHistory=t),form:e.form,options:e.tptHistoryOptions},null,8,["modelValue","form","options"])]),_:1}),e.tptDrugs.length?(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:0},[Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:e.form.tptStartDate,"onUpdate:modelValue":t[12]||(t[12]=t=>e.form.tptStartDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),e.tptDrugs.includes("INH or H (Isoniazid 300mg tablet)")?(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:0,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:e.form.inhQty,"onUpdate:modelValue":t[13]||(t[13]=t=>e.form.inhQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),e.tptDrugs.includes("Rifapentine (150mg)")?(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:1,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:e.form.rifapentineQty,"onUpdate:modelValue":t[14]||(t[14]=t=>e.form.rifapentineQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),e.tptDrugs.includes("INH 300 / RFP 300 (3HP)")?(Object(o["openBlock"])(),Object(o["createBlock"])(u,{key:2,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(b,{modelValue:e.form.threeHPQty,"onUpdate:modelValue":t[15]||(t[15]=t=>e.form.threeHPQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.tptStartLocation,"onUpdate:modelValue":t[16]||(t[16]=t=>e.form.tptStartLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0)],64)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.confirmatoryTest,"onUpdate:modelValue":t[17]||(t[17]=t=>e.form.confirmatoryTest=t),form:e.form,options:e.HIVTestOptions},null,8,["modelValue","form","options"])]),_:1}),e.isConfirmatoryTestDone?(Object(o["openBlock"])(),Object(o["createElementBlock"])(o["Fragment"],{key:2},[Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(m,{modelValue:e.form.confirmatoryTestLocation,"onUpdate:modelValue":t[18]||(t[18]=t=>e.form.confirmatoryTestLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(o["createVNode"])(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(c,{modelValue:e.form.confirmatoryTestDate,"onUpdate:modelValue":t[19]||(t[19]=t=>e.form.confirmatoryTestDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1})],64)):Object(o["createCommentVNode"])("",!0),Object(o["createVNode"])(u,{size:"12",class:"ion-margin-top"},{default:Object(o["withCtx"])(()=>[Object(o["createVNode"])(v,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("Next")]),_:1},8,["onClick"]),Object(o["createVNode"])(v,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("Clear")]),_:1},8,["onClick"]),e.isNewPatient?Object(o["createCommentVNode"])("",!0):(Object(o["openBlock"])(),Object(o["createBlock"])(v,{key:0,class:"ion-margin-top ion-float-right",size:"large",onClick:t[20]||(t[20]=t=>e.$router.back()),color:"primary"},{default:Object(o["withCtx"])(()=>[Object(o["createTextVNode"])("Back")]),_:1}))]),_:1})]),_:1})],64)}var l=a("d867"),r=a("23e6"),n=a("b5e4"),d=a("9283"),u=a("2ef0"),c=a("0db2"),s=a("5ab5"),m=a("6b6c"),b=a("ad60"),v=a("519d"),p=a("be95"),f=a("e86e"),V=a("f27f"),g=a("403e"),O=a("5a0c"),y=a.n(O),j=a("b515"),N=a("2706"),T=a("5e76"),C=a("8df6"),h=a("3b8c"),w=a("6d32"),D=a("0ba8"),R=a("b5b2"),H=Object(o["defineComponent"])({components:{IonRow:l["IonRow"],IonCol:l["IonCol"],IonTitle:l["IonTitle"],TextInput:c["a"],DateInput:s["a"],YesNoInput:m["a"],SelectInput:p["a"],NumberInput:V["a"]},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},sitePrefix:{type:String,required:!0},observations:{type:Object,default:()=>({})},initialVisitDate:{type:String,default:""}},emits:["onValue","onNext"],setup(e,{emit:t}){const a=Object(o["ref"])([]),i=new v["a"](e.patient.getID(),-1),l=new h["a"](e.patient.getID(),-1),c=new j["a"](e.patient.getID(),-1),s=new C["a"](e.patient.getID(),-1),m=y()().format(d["b"]),p=Object(o["computed"])(()=>{const t=e.patient.getBirthdate();return t?y()(t).format(d["b"]):""}),V=Object(o["reactive"])({arvNumber:{value:"",label:"ARV Number",placeholder:"Enter ARV Number",required:!0,validation:async(t,a)=>{if(a.arvNumber.disabled)return null;const o=N["a"].isNumber(t,"POSITIVE_INTEGERS");if(null!==o)return o;const i=await r["a"].findByOtherID(4,`${e.sitePrefix}-ARV-${t.value}`);return Object(u["isEmpty"])(i)?null:["ARV Number already exists"]}},initialVisitDate:{value:e.initialVisitDate,label:"Registration Date",required:!0},shouldFollowUp:{value:e.observations["Agrees to followup"]?e.observations["Agrees to followup"].match(/yes|home visit/i)?"Yes":"No":"",label:"Agrees to follow up ?",computedValue:e=>({tag:"registration",obs:[i.buildGroupValueCoded("Agrees to followup","Home visit",e),i.buildGroupValueCoded("Agrees to followup","Phone",e)]}),required:!0},receivedArvTreatmentBefore:{value:e.observations["Ever received ART"]||"",label:"Ever received ARVs for treatment or prophylaxis?",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever received ART",e)}),required:!0},dateLastTakenArvs:{value:e.observations["Date ART last taken"]||"",label:"Date last taken ARVs",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART last taken",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&N["a"].required(e)},everRegisteredAtClinic:{value:e.observations["Ever registered at ART clinic"]||"",label:"Ever registred at an ART clinic",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever registered at ART clinic",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&N["a"].required(e)},artInitiationLocation:{value:e.observations["Location of ART initiation"]||"",label:"Location of ART Initiation",computedValue:e=>({tag:"registration",obs:l.buildValueText("Location of ART initiation","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].required(e)},artStartDate:{value:e.observations["Date ART started"]||"",label:"Date started ART",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART started",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].required(e)},initialWeight:{value:e.observations["weight"]||"",label:"Initial Weight",placeholder:"Enter weight",computedValue:e=>({tag:"vitals",obs:c.buildValueNumber("weight",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].validateSeries([()=>N["a"].required(e),()=>c.validator({...e,label:"Weight"})])},initialHeight:{value:e.observations["Height"]||"",label:"Initial Height",placeholder:"Enter height",computedValue:e=>({tag:"vitals",obs:i.buildValueNumber("Height",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].validateSeries([()=>N["a"].required(e),()=>c.validator({...e,label:"Height"})])},initialTBStatus:{value:e.observations["TB Status at Initiation"]||"",label:"Initial TB Status",placeholder:"select TB status",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("TB Status at Initiation","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].required(e)},tptHistory:{value:e.observations["Previous TB treatment history"]||"",label:"TPT History",placeholder:"Select TPT history",computedValue:e=>({tag:"consultation",obs:l.buildValueText("Previous TB treatment history","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&N["a"].required(e)},tptStartDate:{value:e.observations["TPT Drugs Received"]||"",label:"Date started TPT",validation:async(e,t)=>{var a,o,i;return(null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o||null===(i=o.label)||void 0===i?void 0:i.match(/currently/i))&&N["a"].required(e)}},inhQty:{value:"",label:"INH Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&(i.match(/ipt/i)||i.includes("3HP (RFP + INH)"))&&N["a"].required(e)},computedValue:(e,t)=>{var o;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(o=a.value.find(e=>"INH or H (Isoniazid 300mg tablet)"===e.name))||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},rifapentineQty:{value:"",label:"Rifapentine Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("3HP (RFP + INH)")&&N["a"].required(e)},computedValue:(e,t)=>{var o;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(o=a.value.find(e=>"Rifapentine (150mg)"===e.name))||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},threeHPQty:{value:"",label:"INH / RFP Amount Received",validation:async(e,t)=>{var a,o;const i=null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o?void 0:o.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("INH 300 / RFP 300 (3HP)")&&N["a"].required(e)},computedValue:(e,t)=>{var o;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(o=a.value.find(e=>"INH 300 / RFP 300 (3HP)"===e.name))||void 0===o?void 0:o.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},tptStartLocation:{value:e.observations["Location TPT Last Received"]||"",label:"TPT Transfer From",validation:async(e,t)=>{var a,o,i;return(null===(a=t.tptHistory)||void 0===a||null===(o=a.value)||void 0===o||null===(i=o.label)||void 0===i?void 0:i.match(/currently/i))&&N["a"].required(e)},computedValue:e=>({tag:"consultation",obs:l.buildValueText("Location TPT Last Received","string"===typeof e?e:e.label)})},confirmatoryTest:{value:e.observations["Confirmatory hiv test type"]||"",label:"Confirmatory Test",placeholder:"Select confirmatory test",required:!0,computedValue(e){return{tag:"registration",obs:i.buildValueCoded("Confirmatory hiv test type","string"===typeof e?e:e.value)}}},confirmatoryTestLocation:{value:e.observations["Confirmatory HIV test location"]||"",label:"Location of Confirmatory",placeholder:"Select location",validation:async(e,t)=>!("Not done"===t.confirmatoryTest.value.label||"Not done"===t.confirmatoryTest.value)&&N["a"].required(e),computedValue(e){return{tag:"registration",obs:i.buildValueText("Confirmatory HIV test location","string"===typeof e?e:e.label)}}},confirmatoryTestDate:{value:e.observations["Confirmatory HIV test date"]||"",label:"Confirmatory HIV Test Date",validation:async(e,t)=>!("Not done"===t.confirmatoryTest.value.label||"Not done"===t.confirmatoryTest.value)&&N["a"].required(e),computedValue:e=>({tag:"registration",obs:i.buildValueDate("Confirmatory HIV test date",e)})},patientType:{value:"New patient",computedValue:e=>({tag:"patient type",obs:s.buildValueCoded("Type of patient",e)})}}),O=Object(o["computed"])(()=>!("Not done"===V.confirmatoryTest.value.label||"Not done"===V.confirmatoryTest.value));Object(o["watch"])(V.receivedArvTreatmentBefore,e=>{"No"===e.value&&(V.everRegisteredAtClinic.value="")});const H=Object(o["computed"])(()=>{var e;const t="string"===typeof V.tptHistory.value?V.tptHistory.value:null===(e=V.tptHistory.value)||void 0===e?void 0:e.label;if(null!==t&&void 0!==t&&t.match(/currently/i)){if(t.match(/ipt/i))return["INH or H (Isoniazid 300mg tablet)"];if(t.includes("3HP (RFP + INH)"))return["INH or H (Isoniazid 300mg tablet)","Rifapentine (150mg)"];if(t.includes("INH 300 / RFP 300 (3HP)"))return["INH 300 / RFP 300 (3HP)"]}return[]}),x=async()=>{if(await Object(n["a"])("Are you sure you want to clear all fields?"))for(const e in V)"patientType"!==e&&(V[e].value=void 0,V[e].error="");D["b"].emit(R["a"].ON_CLEAR)},I=async()=>{s.setDate(V.initialVisitDate.value),i.setDate(V.initialVisitDate.value),c.setDate(V.initialVisitDate.value),l.setDate(V.initialVisitDate.value),await Object(T["e"])(V,async(e,a)=>{t("onValue",{type:"registration",data:{formData:e,computedData:a,arvNumberEditable:!V.arvNumber.disabled}}),t("onNext")})};return Object(o["onMounted"])(async()=>{const t=e.patient.getArvNumber();if(t&&"Unknown"!==t)V.arvNumber.value=t.split("-")[2],V.arvNumber.disabled=!0;else{const e=await b["a"].getNextSuggestedARVNumber();V.arvNumber.value=e.arv_number.replace(/^\D+|\s/g,"")}w["a"].getCustomIngridients().then(e=>a.value=e)}),{today:m,patientDob:p,form:V,isConfirmatoryTestDone:O,initialTbStatusOptions:g["c"],tptHistoryOptions:g["e"],HIVTestOptions:g["a"],tptDrugs:H,getFacilities:f["b"],onClear:x,onSubmit:I}}}),x=a("6b0d"),I=a.n(x);const A=I()(H,[["render",i]]);t["default"]=A}}]);
//# sourceMappingURL=chunk-2d0d3fd7.1e1df77f.js.map