(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d3fd7"],{"5eb3":function(e,t,o){"use strict";o.r(t);var a=o("7a23");function i(e,t,o,i,l,r){const n=Object(a["resolveComponent"])("ion-title"),u=Object(a["resolveComponent"])("text-input"),d=Object(a["resolveComponent"])("ion-col"),c=Object(a["resolveComponent"])("DateInput"),s=Object(a["resolveComponent"])("yes-no-input"),m=Object(a["resolveComponent"])("SelectInput"),b=Object(a["resolveComponent"])("NumberInput"),v=Object(a["resolveComponent"])("ion-button"),p=Object(a["resolveComponent"])("ion-row");return Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],null,[Object(a["createVNode"])(n,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])(" HIV Clinic Registration ")]),_:1}),Object(a["createVNode"])(p,{class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(d,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(u,{modelValue:e.form.arvNumber,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.arvNumber=t),form:e.form,prefix:e.sitePrefix+"-ARV-",disabled:!e.isNewPatient},null,8,["modelValue","form","prefix","disabled"])]),_:1}),Object(a["createVNode"])(d,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{modelValue:e.form.initialVisitDate,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.initialVisitDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),Object(a["createVNode"])(d,{size:"5",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{modelValue:e.form.shouldFollowUp,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.shouldFollowUp=t),inline:""},null,8,["modelValue"])]),_:1}),Object(a["createVNode"])(d,{size:"7",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{modelValue:e.form.receivedArvTreatmentBefore,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.receivedArvTreatmentBefore=t),inline:""},null,8,["modelValue"])]),_:1}),"Yes"===e.form.receivedArvTreatmentBefore.value?(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:0},[Object(a["createVNode"])(d,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{modelValue:e.form.dateLastTakenArvs,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.dateLastTakenArvs=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(a["createVNode"])(d,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(s,{modelValue:e.form.everRegisteredAtClinic,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.everRegisteredAtClinic=t),inline:""},null,8,["modelValue"])]),_:1})],64)):Object(a["createCommentVNode"])("",!0),"Yes"===e.form.everRegisteredAtClinic.value?(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:1},[Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.artInitiationLocation,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.artInitiationLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{modelValue:e.form.artStartDate,"onUpdate:modelValue":t[7]||(t[7]=t=>e.form.artStartDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1}),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(u,{modelValue:e.form.arvNumberAtPreviousLocation,"onUpdate:modelValue":t[8]||(t[8]=t=>e.form.arvNumberAtPreviousLocation=t),form:e.form},null,8,["modelValue","form"])]),_:1}),Object(a["createVNode"])(d,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:e.form.initialWeight,"onUpdate:modelValue":t[9]||(t[9]=t=>e.form.initialWeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(a["createVNode"])(d,{size:"3",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:e.form.initialHeight,"onUpdate:modelValue":t[10]||(t[10]=t=>e.form.initialHeight=t),form:e.form,min:1,allowUnknown:""},null,8,["modelValue","form"])]),_:1}),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.initialTBStatus,"onUpdate:modelValue":t[11]||(t[11]=t=>e.form.initialTBStatus=t),form:e.form,options:e.initialTbStatusOptions},null,8,["modelValue","form","options"])]),_:1}),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.tptHistory,"onUpdate:modelValue":t[12]||(t[12]=t=>e.form.tptHistory=t),form:e.form,options:e.tptHistoryOptions},null,8,["modelValue","form","options"])]),_:1}),e.tptDrugs.length?(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:0},[Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{modelValue:e.form.tptStartDate,"onUpdate:modelValue":t[13]||(t[13]=t=>e.form.tptStartDate=t),"min-date":e.patientDob,"max-date":e.today,form:e.form},null,8,["modelValue","min-date","max-date","form"])]),_:1}),e.tptDrugs.includes("INH or H (Isoniazid 300mg tablet)")?(Object(a["openBlock"])(),Object(a["createBlock"])(d,{key:0,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:e.form.inhQty,"onUpdate:modelValue":t[14]||(t[14]=t=>e.form.inhQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(a["createCommentVNode"])("",!0),e.tptDrugs.includes("Rifapentine (150mg)")?(Object(a["openBlock"])(),Object(a["createBlock"])(d,{key:1,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:e.form.rifapentineQty,"onUpdate:modelValue":t[15]||(t[15]=t=>e.form.rifapentineQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(a["createCommentVNode"])("",!0),e.tptDrugs.includes("INH 300 / RFP 300 (3HP)")?(Object(a["openBlock"])(),Object(a["createBlock"])(d,{key:2,size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(b,{modelValue:e.form.threeHPQty,"onUpdate:modelValue":t[16]||(t[16]=t=>e.form.threeHPQty=t),form:e.form,min:1},null,8,["modelValue","form"])]),_:1})):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.tptStartLocation,"onUpdate:modelValue":t[17]||(t[17]=t=>e.form.tptStartLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1})],64)):Object(a["createCommentVNode"])("",!0)],64)):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.confirmatoryTest,"onUpdate:modelValue":t[18]||(t[18]=t=>e.form.confirmatoryTest=t),form:e.form,options:e.HIVTestOptions},null,8,["modelValue","form","options"])]),_:1}),e.isConfirmatoryTestDone?(Object(a["openBlock"])(),Object(a["createElementBlock"])(a["Fragment"],{key:2},[Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(m,{modelValue:e.form.confirmatoryTestLocation,"onUpdate:modelValue":t[19]||(t[19]=t=>e.form.confirmatoryTestLocation=t),form:e.form,asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","form","asyncOptions"])]),_:1}),Object(a["createVNode"])(d,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(c,{modelValue:e.form.confirmatoryTestDate,"onUpdate:modelValue":t[20]||(t[20]=t=>e.form.confirmatoryTestDate=t),form:e.form,"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","form","min-date","max-date"])]),_:1})],64)):Object(a["createCommentVNode"])("",!0),Object(a["createVNode"])(d,{size:"12",class:"ion-margin-top"},{default:Object(a["withCtx"])(()=>[Object(a["createVNode"])(v,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("Next")]),_:1},8,["onClick"]),Object(a["createVNode"])(v,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("Clear")]),_:1},8,["onClick"]),e.isNewPatient?Object(a["createCommentVNode"])("",!0):(Object(a["openBlock"])(),Object(a["createBlock"])(v,{key:0,class:"ion-margin-top ion-float-right",size:"large",onClick:t[21]||(t[21]=t=>e.$router.back()),color:"primary"},{default:Object(a["withCtx"])(()=>[Object(a["createTextVNode"])("Back")]),_:1}))]),_:1})]),_:1})],64)}var l=o("d867"),r=o("23e6"),n=o("b5e4"),u=o("9283"),d=o("2ef0"),c=o("0db2"),s=o("5ab5"),m=o("6b6c"),b=o("519d"),v=o("be95"),p=o("e86e"),f=o("f27f"),V=o("403e"),g=o("5a0c"),O=o.n(g),y=o("b515"),j=o("2706"),N=o("5e76"),T=o("8df6"),C=o("3b8c"),h=o("6d32"),w=o("0ba8"),D=o("b5b2"),R=Object(a["defineComponent"])({components:{IonRow:l["IonRow"],IonCol:l["IonCol"],IonTitle:l["IonTitle"],TextInput:c["a"],DateInput:s["a"],YesNoInput:m["a"],SelectInput:v["a"],NumberInput:f["a"]},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},sitePrefix:{type:String,required:!0},observations:{type:Object,default:()=>({})},initialVisitDate:{type:String,default:""}},emits:["onValue","onNext"],setup(e,{emit:t}){const o=Object(a["ref"])([]),i=new b["a"](e.patient.getID(),-1),l=new C["a"](e.patient.getID(),-1),c=new y["a"](e.patient.getID(),-1),s=new T["a"](e.patient.getID(),-1),m=O()().format(u["b"]),v=Object(a["computed"])(()=>{const t=e.patient.getBirthdate();return t?O()(t).format(u["b"]):""}),f=Object(a["reactive"])({arvNumber:{value:"",label:"ARV Number",placeholder:"Enter ARV Number",required:!0,validation:async(t,o)=>{if(o.arvNumber.disabled)return null;const a=j["a"].isNumber(t,"POSITIVE_INTEGERS");if(null!==a)return a;const i=await r["a"].findByOtherID(4,`${e.sitePrefix}-ARV-${t.value}`);return Object(d["isEmpty"])(i)?null:["ARV Number already exists"]}},arvNumberAtPreviousLocation:{value:"",label:"ART Number at previous Location",computedValue:e=>({tag:"registration",obs:i.buildValueText("ART number at previous location",e)})},initialVisitDate:{value:e.initialVisitDate,label:"Registration Date",required:!0},shouldFollowUp:{value:e.observations["Agrees to followup"]?e.observations["Agrees to followup"].match(/yes|home visit/i)?"Yes":"No":"",label:"Agrees to follow up ?",computedValue:e=>({tag:"registration",obs:[i.buildGroupValueCoded("Agrees to followup","Home visit",e),i.buildGroupValueCoded("Agrees to followup","Phone",e)]}),required:!0},receivedArvTreatmentBefore:{value:e.observations["Ever received ART"]||"",label:"Ever received ARVs for treatment or prophylaxis?",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever received ART",e)}),required:!0},dateLastTakenArvs:{value:e.observations["Date ART last taken"]||"",label:"Date last taken ARVs",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART last taken",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&j["a"].required(e)},everRegisteredAtClinic:{value:e.observations["Ever registered at ART clinic"]||"",label:"Ever registred at an ART clinic",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("Ever registered at ART clinic",e)}),validation:async(e,t)=>"Yes"===t.receivedArvTreatmentBefore.value&&j["a"].required(e)},artInitiationLocation:{value:e.observations["Location of ART initiation"]||"",label:"Location of ART Initiation",computedValue:e=>({tag:"registration",obs:l.buildValueText("Location of ART initiation","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&j["a"].required(e)},artStartDate:{value:e.observations["Date ART started"]||"",label:"Date started ART",computedValue:e=>({tag:"registration",obs:i.buildValueDate("Date ART started",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&j["a"].required(e)},initialWeight:{value:e.observations["weight"]||"",label:"Initial Weight",placeholder:"Enter weight",computedValue:e=>({tag:"vitals",obs:c.buildValueNumber("weight",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&"Unknown"!==e.value&&j["a"].validateSeries([()=>j["a"].required(e),()=>c.validator({...e,label:"Weight"})])},initialHeight:{value:e.observations["Height"]||"",label:"Initial Height",placeholder:"Enter height",computedValue:e=>({tag:"vitals",obs:i.buildValueNumber("Height",e)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&"Unknown"!==e.value&&j["a"].validateSeries([()=>j["a"].required(e),()=>c.validator({...e,label:"Height"})])},initialTBStatus:{value:e.observations["TB Status at Initiation"]||"",label:"Initial TB Status",placeholder:"select TB status",computedValue:e=>({tag:"registration",obs:i.buildValueCoded("TB Status at Initiation","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&j["a"].required(e)},tptHistory:{value:e.observations["Previous TB treatment history"]||"",label:"TPT History",placeholder:"Select TPT history",computedValue:e=>({tag:"consultation",obs:l.buildValueText("Previous TB treatment history","string"===typeof e?e:e.label)}),validation:async(e,t)=>"Yes"===t.everRegisteredAtClinic.value&&j["a"].required(e)},tptStartDate:{value:e.observations["TPT Drugs Received"]||"",label:"Date started TPT",validation:async(e,t)=>{var o,a,i;return(null===(o=t.tptHistory)||void 0===o||null===(a=o.value)||void 0===a||null===(i=a.label)||void 0===i?void 0:i.match(/currently/i))&&j["a"].required(e)}},inhQty:{value:"",label:"INH Amount Received",validation:async(e,t)=>{var o,a;const i=null===(o=t.tptHistory)||void 0===o||null===(a=o.value)||void 0===a?void 0:a.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&(i.match(/ipt/i)||i.includes("3HP (RFP + INH)"))&&j["a"].required(e)},computedValue:(e,t)=>{var a;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(a=o.value.find(e=>"INH or H (Isoniazid 300mg tablet)"===e.name))||void 0===a?void 0:a.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},rifapentineQty:{value:"",label:"Rifapentine Amount Received",validation:async(e,t)=>{var o,a;const i=null===(o=t.tptHistory)||void 0===o||null===(a=o.value)||void 0===a?void 0:a.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("3HP (RFP + INH)")&&j["a"].required(e)},computedValue:(e,t)=>{var a;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(a=o.value.find(e=>"Rifapentine (150mg)"===e.name))||void 0===a?void 0:a.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},threeHPQty:{value:"",label:"INH / RFP Amount Received",validation:async(e,t)=>{var o,a;const i=null===(o=t.tptHistory)||void 0===o||null===(a=o.value)||void 0===a?void 0:a.label;return(null===i||void 0===i?void 0:i.match(/currently/i))&&i.includes("INH 300 / RFP 300 (3HP)")&&j["a"].required(e)},computedValue:(e,t)=>{var a;return{tag:"consultation",obs:l.buildObs("TPT Drugs Received",{value_drug:(null===(a=o.value.find(e=>"INH 300 / RFP 300 (3HP)"===e.name))||void 0===a?void 0:a.drug_id)||0,value_datetime:(null===t||void 0===t?void 0:t.tptStartDate.value)||null,value_numeric:e||0})}}},tptStartLocation:{value:e.observations["Location TPT Last Received"]||"",label:"TPT Transfer From",validation:async(e,t)=>{var o,a,i;return(null===(o=t.tptHistory)||void 0===o||null===(a=o.value)||void 0===a||null===(i=a.label)||void 0===i?void 0:i.match(/currently/i))&&j["a"].required(e)},computedValue:e=>({tag:"consultation",obs:l.buildValueText("Location TPT Last Received","string"===typeof e?e:e.label)})},confirmatoryTest:{value:e.observations["Confirmatory hiv test type"]||"",label:"Confirmatory Test",placeholder:"Select confirmatory test",required:!0,computedValue(e){return{tag:"registration",obs:i.buildValueCoded("Confirmatory hiv test type","string"===typeof e?e:e.value)}}},confirmatoryTestLocation:{value:e.observations["Confirmatory HIV test location"]||"",label:"Location of Confirmatory",placeholder:"Select location",validation:async(e,t)=>!("Not done"===t.confirmatoryTest.value.label||"Not done"===t.confirmatoryTest.value)&&j["a"].required(e),computedValue(e){return{tag:"registration",obs:i.buildValueText("Confirmatory HIV test location","string"===typeof e?e:e.label)}}},confirmatoryTestDate:{value:e.observations["Confirmatory HIV test date"]||"",label:"Confirmatory HIV Test Date",validation:async(e,t)=>!("Not done"===t.confirmatoryTest.value.label||"Not done"===t.confirmatoryTest.value)&&j["a"].required(e),computedValue:e=>({tag:"registration",obs:i.buildValueDate("Confirmatory HIV test date",e)})},patientType:{value:"New patient",computedValue:e=>({tag:"patient type",obs:s.buildValueCoded("Type of patient",e)})}}),g=Object(a["computed"])(()=>{var e;return!("Not done"===(null===(e=f.confirmatoryTest.value)||void 0===e?void 0:e.label)||"Not done"===f.confirmatoryTest.value)});Object(a["watch"])(f.receivedArvTreatmentBefore,e=>{"No"===e.value&&(f.everRegisteredAtClinic.value="")});const R=Object(a["computed"])(()=>{var e;const t="string"===typeof f.tptHistory.value?f.tptHistory.value:null===(e=f.tptHistory.value)||void 0===e?void 0:e.label;if(null!==t&&void 0!==t&&t.match(/currently/i)){if(t.match(/ipt/i))return["INH or H (Isoniazid 300mg tablet)"];if(t.includes("3HP (RFP + INH)"))return["INH or H (Isoniazid 300mg tablet)","Rifapentine (150mg)"];if(t.includes("INH 300 / RFP 300 (3HP)"))return["INH 300 / RFP 300 (3HP)"]}return[]}),x=async()=>{if(await Object(n["a"])("Are you sure you want to clear all fields?"))for(const e in f)"patientType"!==e&&(f[e].value=void 0,f[e].error="");w["b"].emit(D["a"].ON_CLEAR)},H=async()=>{s.setDate(f.initialVisitDate.value),i.setDate(f.initialVisitDate.value),c.setDate(f.initialVisitDate.value),l.setDate(f.initialVisitDate.value),await Object(N["e"])(f,async(e,o)=>{t("onValue",{type:"registration",data:{formData:e,computedData:o,arvNumberEditable:!f.arvNumber.disabled}}),t("onNext")})};return Object(a["onMounted"])(async()=>{const t=e.patient.getArvNumber();t&&"Unknown"!==t&&(f.arvNumber.value=t.split("-")[2],f.arvNumber.disabled=!0),h["a"].getCustomIngridients().then(e=>o.value=e)}),{today:m,patientDob:v,form:f,isConfirmatoryTestDone:g,initialTbStatusOptions:V["c"],tptHistoryOptions:V["e"],HIVTestOptions:V["a"],tptDrugs:R,getFacilities:p["b"],onClear:x,onSubmit:H}}}),x=o("d959"),H=o.n(x);const I=H()(R,[["render",i]]);t["default"]=I}}]);
//# sourceMappingURL=chunk-2d0d3fd7.23949074.js.map