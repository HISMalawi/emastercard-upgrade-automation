(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3ae5de22"],{"062e":function(e,t,a){},"12f0":function(e,t,a){"use strict";a.r(t);var i=a("7a23");function n(e,t,a,n,o,l){const s=Object(i["resolveComponent"])("information-header"),r=Object(i["resolveComponent"])("report-table"),c=Object(i["resolveComponent"])("preloader"),u=Object(i["resolveComponent"])("pagination"),d=Object(i["resolveComponent"])("ion-content"),b=Object(i["resolveComponent"])("his-footer"),p=Object(i["resolveComponent"])("ion-page");return Object(i["openBlock"])(),Object(i["createBlock"])(p,{style:{background:"#fff"}},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(s,{items:e.patientCardInfo,numberOfColumns:4,onAddGuardian:e.addGuardian,onUpdate:e.updateDemographics,onUpdateARVNumber:e.updateARVNumber},null,8,["items","onAddGuardian","onUpdate","onUpdateARVNumber"]),Object(i["createVNode"])(d,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(r,{paginated:!0,rows:e.rows,columns:e.columns,rowsPerPage:e.itemsPerPage,newPage:e.currentPage,asyncRowParser:e.onNewRow,onOnPagination:t[0]||(t[0]=t=>e.totalPages=t.length)},null,8,["rows","columns","rowsPerPage","newPage","asyncRowParser"]),e.visitDatesInitialised?Object(i["createCommentVNode"])("",!0):(Object(i["openBlock"])(),Object(i["createBlock"])(c,{key:0,itemCount:5})),Object(i["createVNode"])(u,{perPage:e.itemsPerPage,maxVisibleButtons:20,totalPages:e.totalPages,onOnChangePage:t[1]||(t[1]=t=>e.currentPage=t)},null,8,["perPage","totalPages"])]),_:1}),Object(i["createVNode"])(b,{btns:e.btns},null,8,["btns"])]),_:1})}a("14d9");var o=a("9283"),l=a("23e6"),s=a("7957");const r={style:{padding:".1rem"}},c={style:{width:"100%",display:"flex",justifyContent:"space-between",fontSize:"12px",margin:0,padding:0}},u=["onClick"],d=["innerHTML"];function b(e,t,a,n,o,l){const s=Object(i["resolveComponent"])("ion-item"),b=Object(i["resolveComponent"])("ion-list"),p=Object(i["resolveComponent"])("multi-column-view");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",r,[Object(i["createVNode"])(p,{items:e.items,numberOfColumns:e.numberOfColumns},{default:Object(i["withCtx"])(({entries:t})=>[Object(i["createVNode"])(b,null,{default:Object(i["withCtx"])(()=>[(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(t,t=>(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:t.label},["boolean"!==typeof t.visible||t.visible?(Object(i["openBlock"])(),Object(i["createBlock"])(s,{key:0,style:{padding:"0 !important",margin:"0 !important"}},{default:Object(i["withCtx"])(()=>[Object(i["createElementVNode"])("div",c,[Object(i["createElementVNode"])("span",null,Object(i["toDisplayString"])(t.label)+": ",1),t.other&&t.other.editable?(Object(i["openBlock"])(),Object(i["createElementBlock"])("span",{key:0,onClick:a=>e.onClick(t)},[Object(i["createElementVNode"])("a",null,[Object(i["createElementVNode"])("b",null,Object(i["toDisplayString"])(t.value),1)])],8,u)):(Object(i["openBlock"])(),Object(i["createElementBlock"])("b",{key:1,innerHTML:t.value||"N/A"},null,8,d))])]),_:2},1024)):Object(i["createCommentVNode"])("",!0)]))),128))]),_:2},1024)]),_:1},8,["items","numberOfColumns"])])}var p=a("92c1"),m=Object(i["defineComponent"])({name:"InformationHeader",components:{MultiColumnView:p["a"]},props:{icon:{required:!1},items:{type:Object,required:!0},numberOfColumns:{type:Number,default:2}},emits:["update","updateARVNumber","addGuardian"],setup(e,{emit:t}){const a=e=>"demographics"===e.other.category?t("update",e.other.attribute):"arv_number"===e.other.category?t("updateARVNumber"):t("addGuardian");return{onClick:a}}}),g=(a("eb2b"),a("d959")),h=a.n(g);const O=h()(m,[["render",b],["__scopeId","data-v-47a90a47"]]);var v=O,j=a("0f25"),f=a("2ef0"),y=a("d867"),V=a("7def"),C=a("b5e4"),I=a("ad60"),P=a("4db7"),w=a("8e8b"),N=a("80e3"),k=a("9ceb"),B=a("1799"),T=a("ded6");function _(e,t,a,n,o,l){const s=Object(i["resolveComponent"])("ion-title"),r=Object(i["resolveComponent"])("ion-toolbar"),c=Object(i["resolveComponent"])("ion-header"),u=Object(i["resolveComponent"])("information-header"),d=Object(i["resolveComponent"])("ion-content"),b=Object(i["resolveComponent"])("ion-button"),p=Object(i["resolveComponent"])("ion-footer");return Object(i["openBlock"])(),Object(i["createElementBlock"])(i["Fragment"],null,[Object(i["createVNode"])(c,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(r,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(s,null,{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.title),1)]),_:1})]),_:1})]),_:1}),Object(i["createVNode"])(d,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(u,{items:e.visitData},null,8,["items"])]),_:1}),Object(i["createVNode"])(p,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(r,null,{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(b,{onClick:e.closeModal,slot:"end"},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(" Close ")]),_:1},8,["onClick"])]),_:1})]),_:1})],64)}var x=Object(i["defineComponent"])({components:{InformationHeader:v},props:{title:{type:String,required:!0},visitData:{type:Object,required:!0}},methods:{async closeModal(){await y["modalController"].dismiss({})}}});const D=h()(x,[["render",_]]);var A=D,F=a("0011"),S=Object(i["defineComponent"])({components:{Preloader:T["a"],Pagination:B["a"],IonPage:y["IonPage"],ReportTable:N["a"],IonContent:y["IonContent"],HisFooter:j["a"],InformationHeader:v},data:()=>({patientId:0,patient:{},patientCardInfo:[],btns:[],itemsPerPage:10,currentPage:0,totalPages:0,pages:[],visitDates:[],tbStats:[],visitDatesInitialised:!1,columns:[[k["a"].thTxt("VISIT DATE"),k["a"].thTxt("WEIGHT (Kg)"),k["a"].thTxt("REG"),k["a"].thTxt("VIRAL LOAD"),k["a"].thTxt("TB STATUS"),k["a"].thTxt("OUTCOME"),k["a"].thTxt("PILLS DISPENSED"),k["a"].thTxt("ACTIONS")]],rows:[]}),created(){this.setPatientCards(),this.patientId=parseInt(""+this.$route.params.patient_id),l["a"].getPatientVisits(this.patientId,!0).then(e=>{this.visitDatesInitialised=!0,this.visitDates=e,this.rows=e.map(e=>[k["a"].tdBtn(o["c"].toStandardHisDisplayFormat(e),()=>new P["a"](this.patientId).printVisitSummaryLbl(e)),k["a"].td("..."),k["a"].td("..."),k["a"].td("..."),k["a"].td("..."),k["a"].td("..."),k["a"].td("..."),k["a"].td("...")])}).catch(e=>{this.visitDatesInitialised=!0,Object(C["c"])(""+e),console.error(e)}),this.btns.push({name:"Finish",color:"success",size:"large",slot:"end",visible:!0,onClick:()=>{Object(C["a"])("Are you sure you want to exit?").then(e=>{if(e)return this.$router.push("/patient/dashboard/"+this.patientId)})}})},async mounted(){if(this.patientId)for(const e of this.patientCardInfo)"function"===typeof e.init&&await e.init(),"function"===typeof e.condition?e.visible=e.condition():e.visible=!0,"function"===typeof e.asyncValue?e.asyncValue(e).then(t=>e.value=t||""):"function"===typeof e.staticValue&&(e.value=e.staticValue())},methods:{setPatientCards(){this.patientCardInfo=[{label:"ARV Number",value:"...",staticValue:()=>this.patient.getArvNumber(),init:async()=>{this.patient=await w["a"].get("ACTIVE_PATIENT",{patientID:this.patientId})},other:{editable:!0,category:"arv_number"}},{label:"National Patient ID",value:"...",staticValue:()=>this.patient.getNationalID()},{label:"Given Name",value:"...",staticValue:()=>this.patient.getGivenName(),other:{editable:!0,attribute:"given_name",category:"demographics"}},{label:"Family Name",value:"...",staticValue:()=>this.patient.getFamilyName(),other:{editable:!0,attribute:"family_name",category:"demographics"}},{label:"Age",value:"...",staticValue:()=>this.patient.getAge(),other:{editable:!0,attribute:"year_birth_date",category:"demographics"}},{label:"Sex",value:"...",staticValue:()=>this.patient.getGender(),other:{editable:!0,attribute:"gender",category:"demographics"}},{label:"Location",value:"...",staticValue:()=>this.patient.getCurrentVillage(),other:{editable:!0,attribute:"home_region",category:"demographics"}},{label:"Landmark",value:"...",staticValue:()=>this.patient.getAttribute(19)},{label:"Guardian",value:"...",asyncValue:async e=>{const t=await V["a"].getGuardianDetails(this.patientId);return Object(f["isEmpty"])(t)?(e.other.editable=!0,"add"):t.map(e=>` ${e.name} (${e.relationshipType})`).join(" ")},other:{editable:!1,attribute:"",category:"guardian"}},{label:"Init W(KG)",value:"...",asyncValue:()=>this.patient.getInitialWeight()},{label:"Init H(CM)",value:"...",asyncValue:()=>this.patient.getInitialHeight()},{label:"Init BMI",value:"...",asyncValue:()=>this.patient.getInitialBMI()},{label:"init Preg",value:"...",condition:()=>this.patient.isFemale(),asyncValue:()=>this.patient.getInitialObs("Is patient pregnant","value_coded")},{label:"init Breastfeeding",value:"...",condition:()=>this.patient.isFemale(),asyncValue:()=>this.patient.getInitialObs("Is patient breast feeding","value_coded")},{label:"cur Preg",value:"...",condition:()=>this.patient.isFemale(),asyncValue:async()=>await this.patient.isPregnant()?"Yes":"No"},{label:"cur Breastfeeding",value:"...",condition:()=>this.patient.isFemale(),asyncValue:async()=>await this.patient.isBreastfeeding()?"Yes":"No"},{label:"TI",value:"...",asyncValue:()=>s["a"].getFirstValueCoded(this.patientId,"Ever received ART")},{label:"Agrees to follow up",value:"...",asyncValue:()=>s["a"].getFirstValueCoded(this.patientId,"Agrees to followup")},{label:"Reason for starting ART",value:"...",asyncValue:()=>s["a"].getFirstValueCoded(this.patientId,"Reason for ART eligibility")},{label:"HIV test date",value:"...",asyncValue:async()=>{const e=await s["a"].getFirstValueDatetime(this.patientId,"Confirmatory HIV test date");return e?o["c"].toStandardHisDisplayFormat(e):""}},{label:"HIV test place",value:"...",asyncValue:()=>s["a"].getFirstValueText(this.patientId,"Confirmatory HIV test location")},{label:"Date of starting first line ART",value:"...",asyncValue:async()=>{const e=await s["a"].getFirstValueDatetime(this.patientId,"Date ART started");return e?o["c"].toStandardHisDisplayFormat(e):""}},{label:"Pulmonary TB within the last 2 years",value:"...",init:async()=>{this.tbStats=await s["a"].getAllValueCoded(this.patientId,"Who stages criteria present")||[]},staticValue:()=>this.hasTbStat("Tuberculosis (PTB or EPTB) within the last 2 years")},{label:"Extra pulmonary TB (EPTB)",value:"...",staticValue:()=>this.hasTbStat("Extrapulmonary tuberculosis (EPTB)")},{label:"Pulmonary TB (current)",value:"...",staticValue:()=>this.hasTbStat("Pulmonary tuberculosis (current)")},{label:"Kaposis sarcoma",value:"...",staticValue:()=>this.hasTbStat("Kaposis sarcoma")}]},buildDetails(e){const t=e=>e.map(([e,t])=>`${e} (${t})`).join("/");return[{label:"Outcome",value:e.outcome},{label:"Outcome Date",value:e.outcome_date},{label:"Side effects",value:e.side_effects},{label:"Viral load",value:e.viral_load},{label:"Pills Brought",value:t(e.pills_brought)},{label:"Pills dispensed",value:t(e.pills_dispensed)},{label:"Visit by",value:e.visit_by},{label:"Regimen",value:e.regimen},{label:"Adherence",value:t(e.adherence)},{label:"TB Status",value:e.tb_status},{label:"Height (cm)",value:e.height},{label:"Weight (Kg)",value:e.weight},{label:"BMI",value:e.bmi},{label:"Is pregnant",value:e.isPregnant,visible:this.patient.isFemale()},{label:"Is breastfeeding",value:e.isBreastfeeding,visible:this.patient.isFemale()}]},async onNewRow(e){const t=[...e];if(t[1]&&"..."!=t[1].td)return t;const a=t[0].td,i=await I["a"].getCurrentProgramInformation(this.patientId,a),n=await I["a"].getMastercardDrugInformation(this.patientId,a),o=((null===n||void 0===n?void 0:n.pills_given)||[]).map(e=>`${e["short_name"]||e["name"]} <b>(${e.quantity||"?"})</b>`).join("<br/>");let l="N/A",r="N/A";if(this.patient.isFemale()){const e=await s["a"].getFirstObs(this.patientId,"Is patient pregnant",a);e&&Object(F["f"])(e.obs_datetime)===a&&(l=e.value_coded);const t=await s["a"].getFirstObs(this.patientId,"Is patient breast feeding",a);t&&Object(F["f"])(t.obs_datetime)===a&&(r=t.value_coded)}return t[1]=k["a"].td(i.weight),t[2]=k["a"].td(i.regimen),t[3]=k["a"].td(i.viral_load),t[4]=k["a"].td(i.tb_status),t[5]=k["a"].td(i.outcome.match(/Unk/i)?"Unknown":i.outcome),t[6]=k["a"].td(o),t[7]=k["a"].tdBtn("More",async()=>{(await y["modalController"].create({component:A,backdropDismiss:!1,cssClass:"large-modal",componentProps:{title:a,visitData:this.buildDetails({...i,isPregnant:l,isBreastfeeding:r})}})).present()}),t},hasTbStat(e){return this.tbStats.includes(e)?"Yes":"No"},updateDemographics(e){this.$router.push({path:"/patient/registration",query:{edit_person:this.patientId,person_attribute:e}})},addGuardian(){var e;this.$router.push({path:"/guardian/registration/"+this.patientId,query:{source:null===(e=this.$route.name)||void 0===e?void 0:e.toString()}})},updateARVNumber(){this.$router.push({name:"Edit ARV Number"})}}});const E=h()(S,[["render",n]]);t["default"]=E},1799:function(e,t,a){"use strict";var i=a("7a23");const n={class:"pagination"},o={class:"btn-group"};function l(e,t,a,l,s,r){const c=Object(i["resolveComponent"])("ion-button"),u=Object(i["resolveComponent"])("ion-icon");return Object(i["openBlock"])(),Object(i["createElementBlock"])("div",n,[Object(i["createElementVNode"])("div",o,[Object(i["createVNode"])(c,{color:"light",onClick:e.setFirstPage,disabled:e.isInFirstPage},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(" First ")]),_:1},8,["onClick","disabled"]),Object(i["createVNode"])(c,{color:"light",onClick:e.prevPage},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(u,{icon:e.caretBack},null,8,["icon"])]),_:1},8,["onClick"]),(Object(i["openBlock"])(!0),Object(i["createElementBlock"])(i["Fragment"],null,Object(i["renderList"])(e.pages,e=>(Object(i["openBlock"])(),Object(i["createBlock"])(c,{onClick:t=>e.show(),color:e.isActive?"primary":"light",key:e.index},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(Object(i["toDisplayString"])(e.name),1)]),_:2},1032,["onClick","color"]))),128)),Object(i["createVNode"])(c,{color:"light",onClick:e.nextPage},{default:Object(i["withCtx"])(()=>[Object(i["createVNode"])(u,{icon:e.caretForward},null,8,["icon"])]),_:1},8,["onClick"]),Object(i["createVNode"])(c,{color:"light",onClick:e.setLastPage,disabled:e.isInLastPage},{default:Object(i["withCtx"])(()=>[Object(i["createTextVNode"])(" Last ")]),_:1},8,["onClick","disabled"])]),Object(i["createElementVNode"])("h6",null,"Page "+Object(i["toDisplayString"])(e.currentPage+1)+" of "+Object(i["toDisplayString"])(e.totalPages),1)])}a("14d9");var s=a("ff79"),r=a("d867"),c=Object(i["defineComponent"])({components:{IonIcon:r["IonIcon"],IonButton:r["IonButton"]},props:{maxVisibleButtons:{type:Number,required:!1,default:3},totalPages:{type:Number,required:!0}},emits:["onChangePage"],setup(e,{emit:t}){const a=Object(i["ref"])(0),n=Object(i["computed"])(()=>0===a.value),o=Object(i["computed"])(()=>a.value===e.totalPages),l=Object(i["computed"])(()=>0===a.value?0:a.value===e.totalPages?e.totalPages-e.maxVisibleButtons:a.value-1),r=e=>t("onChangePage",e),c=Object(i["computed"])(()=>{const t=[];for(let i=l.value;i<=Math.min(l.value+e.maxVisibleButtons-1,e.totalPages-1);i++)t.push({index:i,name:i+1,show:()=>a.value=i,isActive:i===a.value});return t});Object(i["watch"])(e,({totalPages:e})=>{"number"===typeof e&&(a.value=0)},{immediate:!0,deep:!0}),Object(i["watch"])(a,e=>r(e));const u=()=>a.value=0,d=()=>a.value=e.totalPages-1,b=()=>{a.value>0&&(a.value-=1)},p=()=>{a.value+1<e.totalPages&&(a.value+=1)};return{currentPage:a,caretBack:s["caretBack"],caretForward:s["caretForward"],startPage:l,pages:c,isInFirstPage:n,isInLastPage:o,nextPage:p,prevPage:b,setPage:r,setFirstPage:u,setLastPage:d}}}),u=(a("f099"),a("d959")),d=a.n(u);const b=d()(c,[["render",l],["__scopeId","data-v-04a5a269"]]);t["a"]=b},"8c00":function(e,t,a){},eb2b:function(e,t,a){"use strict";a("8c00")},f099:function(e,t,a){"use strict";a("062e")}}]);
//# sourceMappingURL=chunk-3ae5de22.7c825ffd.js.map