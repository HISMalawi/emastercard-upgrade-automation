(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-49a9a530"],{1276:function(t,e,n){"use strict";var r=n("d784"),a=n("44e7"),i=n("825a"),o=n("1d80"),s=n("4840"),c=n("8aa5"),l=n("50c4"),u=n("14c3"),d=n("9263"),f=n("d039"),p=[].push,h=Math.min,v=4294967295,g=!f((function(){return!RegExp(v,"y")}));r("split",2,(function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=String(o(this)),i=void 0===n?v:n>>>0;if(0===i)return[];if(void 0===t)return[r];if(!a(t))return e.call(r,t,i);var s,c,l,u=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),h=0,g=new RegExp(t.source,f+"g");while(s=d.call(g,r)){if(c=g.lastIndex,c>h&&(u.push(r.slice(h,s.index)),s.length>1&&s.index<r.length&&p.apply(u,s.slice(1)),l=s[0].length,h=c,u.length>=i))break;g.lastIndex===s.index&&g.lastIndex++}return h===r.length?!l&&g.test("")||u.push(""):u.push(r.slice(h)),u.length>i?u.slice(0,i):u}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:e.call(this,t,n)}:e,[function(e,n){var a=o(this),i=void 0==e?void 0:e[t];return void 0!==i?i.call(e,a,n):r.call(String(a),e,n)},function(t,a){var o=n(r,t,this,a,r!==e);if(o.done)return o.value;var d=i(t),f=String(this),p=s(d,RegExp),m=d.unicode,b=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(g?"y":"g"),y=new p(g?d:"^(?:"+d.source+")",b),D=void 0===a?v:a>>>0;if(0===D)return[];if(0===f.length)return null===u(y,f)?[f]:[];var w=0,_=0,x=[];while(_<f.length){y.lastIndex=g?_:0;var M,S=u(y,g?f:f.slice(_));if(null===S||(M=h(l(y.lastIndex+(g?0:_)),f.length))===w)_=c(f,_,m);else{if(x.push(f.slice(w,_)),x.length===D)return x;for(var Y=1;Y<=S.length-1;Y++)if(x.push(S[Y]),x.length===D)return x;_=w=M}}return x.push(f.slice(w)),x}]}),!g)},"22ae":function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"d-flex",attrs:{id:"wrapper"}},[n("side-bar"),n("div",{attrs:{id:"page-content-wrapper"}},[n("top-nav"),n("div",{staticClass:"col-12 table-col",attrs:{id:"main-container"}},[n("div",{staticClass:"row"},[n("div",{staticClass:"col-md-12"},[n("sdPicker",{attrs:{onSubmit:t.fetchDates}})],1)]),n("vue-bootstrap4-table",{attrs:{rows:t.rows,columns:t.columns,config:t.config,"show-loader":t.reportLoading,actions:t.actions},on:{"on-download":t.onDownload},scopedSlots:t._u([t._l(t.slots,(function(e){return{key:e,fn:function(r){return[n("span",{key:e,class:r.cell_value.length>0?"drillable":"",on:{click:function(e){return t.fetchDrillDown(r.cell_value)}}},[t._v(t._s(r.cell_value.length>0?r.cell_value.length:0))])]}}}))],null,!0)},[n("template",{slot:"sort-asc-icon"},[t._v("↑")]),n("template",{slot:"sort-desc-icon"},[t._v("↓")]),n("template",{slot:"no-sort-icon"},[t._v("↑↓")])],2)],1)],1),n("b-modal",{attrs:{id:"modal-1",title:"Drill Down Clients"}},[n("b-table",{attrs:{striped:"",hover:"",id:"my-table",items:t.drillClients,fields:t.columns,"per-page":t.perPage,"current-page":t.currentPage}}),n("b-pagination",{attrs:{"per-page":t.perPage,"total-rows":t.rowCount,"aria-controls":"my-table"},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}),n("p",{staticClass:"mt-3"},[t._v("Current Page: "+t._s(t.currentPage))])],1)],1)},a=[],i=(n("a4d3"),n("99af"),n("4de4"),n("4160"),n("caad"),n("d81d"),n("e439"),n("dbb4"),n("b64b"),n("d3b7"),n("ac1f"),n("2532"),n("3ca3"),n("5319"),n("1276"),n("159b"),n("ddb0"),n("2b3d"),n("ade3")),o=n("3835"),s=(n("96cf"),n("1da1")),c=n("8051"),l=n("8e71"),u=n("7c08"),d=n("4dfe"),f=(n("8d9f"),n("ebd8")),p=n("12f9"),h=n("c1df"),v=n.n(h),g=n("2f62");function m(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function b(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?m(Object(n),!0).forEach((function(e){Object(i["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={name:"txML",components:{ReportOverlay:l["a"],"top-nav":f["a"],"side-bar":u["a"],sdPicker:d["a"],VueBootstrap4Table:p["a"]},methods:{redirect:function(t){this.$router.push(t)},initRows:function(){var t=this;this.rows=[];var e=["Female","Male"];e.forEach((function(e){t.ageGroups.forEach((function(n,r){var a="Female"===e?r+1:r+t.ageGroups.length+1;t.rows.push({number:a,age_group:n,gender:e,sixty:[],ninety:[],oneeighty:[]})}))}))},fetchDates:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var r,a,i,o,s,c,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:e.initRows(),e.startDate=t[0],e.endDate=t[1],e.reportTitle="PEPFAR "+sessionStorage.location_name+" TX CURR MMD report ",e.reportTitle+=v()(t[0]).format("DDMMMYYYY"),e.reportTitle+=" - "+v()(t[1]).format("DDMMMYYYY"),e.reportLoading=!0,i=0;case 8:if(!(i<e.ageGroups.length)){n.next=24;break}return o=e.ageGroups[i],s=e.setMinMaxAges(o),c=0==i,r=s[0],a=s[1],l="arv_refill_periods?start_date="+t[0]+"&date="+v()().format("YYYY-MM-DD"),l+="&end_date="+t[1]+"&program_id=1&org=pepfar",l+="&min_age="+r,l+="&max_age="+a,l+="&initialize_tables="+c,n.next=21,e.loadData(l,i,o);case 21:i++,n.next=8;break;case 24:case"end":return n.stop()}}),n)})))()},loadData:function(t,e,n){var r=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,c["a"].get(t,{},{}).then((function(t){t.json().then((function(t){r.addRow(t,e,n),11==e&&(r.reportLoading=!1)}))}));case 2:case"end":return a.stop()}}),a)})))()},setMinMaxAges:function(t){var e=t.split(" "),n=Object(o["a"])(e,1),r=n[0];if("<1"===r)return[0,0];if(e.includes("plus"))return[parseInt(r),1e5];var a=r.split("-").map((function(t){return parseInt(t)})),i=Object(o["a"])(a,2),s=i[0],c=i[1];return s&&c?[s,c]:void 0},addRow:function(t,e,n){var r=this,a=["Female","Male"];a.forEach((function(n){var a="Female"===n?e+1:e+r.ageGroups.length+1;for(var i in t[n]){var o=t[n][i].prescribed_days;o<90&&r.rows[a-1].sixty.push(i),o>=90&&o<=150&&r.rows[a-1].ninety.push(i),o>150&&r.rows[a-1].oneeighty.push(i)}}))},fetchDrillDown:function(t){var e=this;t.length>0&&(this.$bvModal.show("modal-1"),this.drillClients=[],t.forEach((function(t){e.getClient(t)})))},getClient:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(e){var n,r,a=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="patients/"+e,t.next=3,c["a"].get(n,{},{});case 3:r=t.sent,200===r.status&&r.json().then((function(t){return a.drillClients.push(a.parsePatient(t))}));case 5:case"end":return t.stop()}}),t)})));function e(e){return t.apply(this,arguments)}return e}(),parsePatient:function(t){var e=t.person.birthdate,n=t.person.gender,r="";t.person.names[0].given_name,t.person.names[0].family_name,t.patient_identifiers.filter((function(t){return 4===t.identifier_type?t.identifier:""}));try{var a=t.person.addresses[0].city_village;t.person.addresses[0].address2,t.person.person_attributes[1].value}catch(s){a=""}try{for(var i=0;i<t.patient_identifiers.length;i++)4==t.patient_identifiers[i]["identifier_type"]&&(r=t.patient_identifiers[i]["identifier"])}catch(s){console.log(s)}var o={};return o.dob=e,o.arv_number=r,o.gender=n,o.current_village=a,o},onDownload:function(){var t=null;this.columns.forEach((function(e){t+='"'.concat(e.label,'",')})),t=t.replace("null",""),this.rows.forEach((function(e){t+="\n",Object.keys(e).forEach((function(n){var r=e[n];Array.isArray(e[n])&&(r=e[n].length),t+='"'.concat(r,'",')}))})),t+="\n",t+="Date Created:  ".concat(v()().format("YYYY-MM-DD:h:m:s")," \n                          Quarter: ").concat(this.startDate," to ").concat(this.endDate,"\n                          Site UUID: ").concat(sessionStorage.siteUUID,"\n                          e-Mastercard Version : ").concat(sessionStorage.EMCVersion," \n                          API Version ").concat(sessionStorage.APIVersion);for(var e=0;e<34;e++)t+=",";var n=new Blob([t],{type:"text/csv;charset=utf-8;"});if(navigator.msSaveBlob)navigator.msSaveBlob(n,exportFilename);else{var r=document.createElement("a");r.href=window.URL.createObjectURL(n),r.setAttribute("download","".concat(this.reportTitle,".csv")),document.body.appendChild(r),r.click(),document.body.removeChild(r)}}},data:function(){var t;return t={drillClients:[],perPage:10,currentPage:1,columns:[{key:"arv_number",label:"ARV Number"},{key:"dob",label:"DOB"},{key:"gender",label:"Gender"},{key:"current_village",label:"Village"}],startDate:null,endDate:null,reportLoading:!1,APIVersion:sessionStorage.APIVersion,EMCVersion:sessionStorage.EMCVersion,reportTitle:null,ageGroups:["<1 year","1-4 years","5-9 years","10-14 years","15-19 years","20-24 years","25-29 years","30-34 years","35-39 years","40-44 years","45-49 years","50-54 years","55-59 years","60-64 years","65-69 years","70-74 years","75-79 years","80-84 years","85-89 years","90 plus years"],showLoader:!1,slots:["sixty","ninety","oneeighty"],rows:[]},Object(i["a"])(t,"columns",[{label:"#",name:"number",sort:!0},{label:"Age Group",name:"age_group"},{label:"Gender",name:"gender"},{label:"# of clients on <3 months of ARVs",name:"sixty",slot_name:"sixty"},{label:"# of clients on 3 - 5 months of ARVs",name:"ninety",slot_name:"ninety"},{label:"# of clients on >= 6 months of ARVs",name:"oneeighty",slot_name:"oneeighty"}]),Object(i["a"])(t,"config",{card_title:"TX CURR MMD Clients that are alive and on treatment in the reporting period and\nthe difference in days between their clinical dispensation visit and next appointment / drug-runout date is:\n3 months (1 – 89 days), \n3-5 months (90-179 days), \n6+ months (180 or more days)\n",show_refresh_button:!1,show_reset_button:!1}),Object(i["a"])(t,"actions",[{btn_text:"CSV",event_name:"on-download",class:"btn btn-primary my-custom-class"}]),t},computed:b({},Object(g["c"])(["location"]),{rowCount:function(){return this.drillClients.length}}),mounted:function(){this.initRows()}},D=y,w=(n("386e"),n("2877")),_=Object(w["a"])(D,r,a,!1,null,"3771b7ec",null);e["default"]=_.exports},"336a":function(t,e,n){"use strict";var r=n("df61"),a=n.n(r);a.a},3835:function(t,e,n){"use strict";function r(t){if(Array.isArray(t))return t}n.d(e,"a",(function(){return o}));n("a4d3"),n("e01a"),n("d28b"),n("e260"),n("d3b7"),n("25f0"),n("3ca3"),n("ddb0");function a(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=t[Symbol.iterator]();!(r=(o=s.next()).done);r=!0)if(n.push(o.value),e&&n.length===e)break}catch(c){a=!0,i=c}finally{try{r||null==s["return"]||s["return"]()}finally{if(a)throw i}}return n}}function i(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(t,e){return r(t)||a(t,e)||i()}},"386e":function(t,e,n){"use strict";var r=n("824f"),a=n.n(r);a.a},"4dfe":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ctrs"},[n("div",{staticClass:"ctr-table"},[n("div",{staticClass:"ctr-row"},[n("div",{staticClass:"ctr-cell"},[n("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"Start Date",readonly:!0}},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}})],1),n("div",{staticClass:"ctr-cell"},[n("date-pick",{staticClass:"date-inputs",attrs:{format:t.format,parseDate:t.parseDate,formatDate:t.formatDate,inputAttributes:{placeholder:"End Date",readonly:!0}},model:{value:t.endDate,callback:function(e){t.endDate=e},expression:"endDate"}})],1),n("div",{staticClass:"ctr-cell"},[n("button",{staticClass:"btn btn-success",on:{click:t.submitDates}},[t._v("Submit")])])])])])},a=[],i=n("f0ca"),o=n.n(i),s=n("c1df"),c=n.n(s),l=(n("6f3c"),n("1789")),u={components:{DatePick:o.a},props:["onSubmit"],data:function(){return{startDate:null,endDate:null,format:"DD/MMM/YYYY",date:l["a"].format(new Date,"DD/MMM/YYYY")}},methods:{initDates:function(){},submitDates:function(){this.startDate=c()(this.startDate).format("YYYY-MM-DD"),this.endDate=c()(this.endDate).format("YYYY-MM-DD"),this.onSubmit([this.startDate,this.endDate])},parseDate:function(t,e){return l["a"].parse(t,e)},formatDate:function(t,e){return l["a"].format(t,e)}},mounted:function(){var t=this;setTimeout((function(){return t.initDates()}),300)}},d=u,f=(n("336a"),n("2877")),p=Object(f["a"])(d,r,a,!1,null,"15deca72",null);e["a"]=p.exports},5319:function(t,e,n){"use strict";var r=n("d784"),a=n("825a"),i=n("7b0b"),o=n("50c4"),s=n("a691"),c=n("1d80"),l=n("8aa5"),u=n("14c3"),d=Math.max,f=Math.min,p=Math.floor,h=/\$([$&'`]|\d\d?|<[^>]*>)/g,v=/\$([$&'`]|\d\d?)/g,g=function(t){return void 0===t?t:String(t)};r("replace",2,(function(t,e,n,r){var m=r.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE,b=r.REPLACE_KEEPS_$0,y=m?"$":"$0";return[function(n,r){var a=c(this),i=void 0==n?void 0:n[t];return void 0!==i?i.call(n,a,r):e.call(String(a),n,r)},function(t,r){if(!m&&b||"string"===typeof r&&-1===r.indexOf(y)){var i=n(e,t,this,r);if(i.done)return i.value}var c=a(t),p=String(this),h="function"===typeof r;h||(r=String(r));var v=c.global;if(v){var w=c.unicode;c.lastIndex=0}var _=[];while(1){var x=u(c,p);if(null===x)break;if(_.push(x),!v)break;var M=String(x[0]);""===M&&(c.lastIndex=l(p,o(c.lastIndex),w))}for(var S="",Y=0,C=0;C<_.length;C++){x=_[C];for(var O=String(x[0]),k=d(f(s(x.index),p.length),0),R=[],E=1;E<x.length;E++)R.push(g(x[E]));var P=x.groups;if(h){var j=[O].concat(R,k,p);void 0!==P&&j.push(P);var A=String(r.apply(void 0,j))}else A=D(O,p,k,R,P,r);k>=Y&&(S+=p.slice(Y,k)+A,Y=k+O.length)}return S+p.slice(Y)}];function D(t,n,r,a,o,s){var c=r+t.length,l=a.length,u=v;return void 0!==o&&(o=i(o),u=h),e.call(s,u,(function(e,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return n.slice(0,r);case"'":return n.slice(c);case"<":s=o[i.slice(1,-1)];break;default:var u=+i;if(0===u)return e;if(u>l){var d=p(u/10);return 0===d?e:d<=l?void 0===a[d-1]?i.charAt(1):a[d-1]+i.charAt(1):e}s=a[u-1]}return void 0===s?"":s}))}}))},"824f":function(t,e,n){},"8aa5":function(t,e,n){"use strict";var r=n("6547").charAt;t.exports=function(t,e,n){return e+(n?r(t,e).length:1)}},"8d9f":function(t,e,n){"use strict";var r=n("c1df"),a=n.n(r);e["a"]=function(){var t="YYYY-MM-DD",e="DD/MM/YYYY";function n(t){var e=t.getMonth(),n=t.getFullYear();return e<3?["".concat(n,"-01-01"),"".concat(n,"-03-31")]:e<6?["".concat(n,"-04-01"),"".concat(n,"-06-30")]:e<9?["".concat(n,"-07-01"),"".concat(n,"-09-30")]:["".concat(n,"-10-01"),"".concat(n,"-12-31")]}function r(t){var e=t.getMonth(),n=t.getFullYear();return e<3?"Q1-".concat(n):e<6?"Q2-".concat(n):e<9?"Q3-".concat(n):"Q4-".concat(n)}function i(e){return a()(e).format(t)}function o(t){return a()(t).format(e)}return{ISO_FORMAT:t,LOCAL_FORMAT:e,dateQuarter:n,dateQuarterStr:r,isoDate:i,localDate:o}}()},"8e71":function(t,e,n){"use strict";var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-overlay",{attrs:{show:t.hideReport,"no-center":!0,"spinner-type":"grow","spinner-variant":"primary"},scopedSlots:t._u([{key:"overlay",fn:function(){return[n("div",{staticStyle:{display:"block","min-height":"720px",width:"100%","padding-top":"20%"}},[t.reportSelected?t._e():n("h1",[t._v("No Report Selected")]),t.reportSelected?n("b-spinner",{attrs:{type:"grow",variant:"primary"}}):t._e()],1)]},proxy:!0}])},[t._t("default")],2)},a=[],i={name:"report-overlay",props:{reportLoading:{type:Boolean,required:!0},reportSelected:{type:Boolean,default:!0}},computed:{hideReport:function(){return this.reportLoading||!this.reportSelected}}},o=i,s=n("2877"),c=Object(s["a"])(o,r,a,!1,null,null,null);e["a"]=c.exports},d81d:function(t,e,n){"use strict";var r=n("23e7"),a=n("b727").map,i=n("1dde"),o=n("ae40"),s=i("map"),c=o("map");r({target:"Array",proto:!0,forced:!s||!c},{map:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0)}})},df61:function(t,e,n){}}]);
//# sourceMappingURL=chunk-49a9a530.a55517ca.js.map