System.register(["./index-legacy-ce33254e.js","./TextInput-legacy-c3c89e30.js","./DateInput.vue_vue_type_style_index_0_lang-legacy-f2c66f1a.js","./YesNoInput-legacy-95e1595a.js","./SelectInput-legacy-4d10662c.js","./location_options-legacy-85c3b601.js","./form-legacy-bd1f1bf8.js","./HIVReception-legacy-8a96efde.js","./emc_event-legacy-58754a45.js","./validations-legacy-0fc7cb15.js","./his_date-legacy-b62edba6.js","./vue-datepicker-legacy-f5374628.js","./common-legacy-0d7df615.js","./Strs-legacy-eacc8505.js","./toasts-legacy-0f59dcdd.js","./loader-legacy-56a90352.js","./patient_service-legacy-87b21168.js","./patient_identifier_service-legacy-d76f3d3b.js","./Date-legacy-37572701.js","./encounter_types-legacy-aef9fff0.js","./consultation_service-legacy-3b7dcc7c.js","./arrays-legacy-4be31994.js"],(function(e,t){"use strict";var o,a,l,n,i,s,u,r,c,d,m,g,p,b,v,f,y,C,h,V,S,_,D,j,w,I,A,x,z,F,R;return{setters:[e=>{o=e.d,a=e.m,l=e.n,n=e.I,i=e.a2,s=e.r,u=e.h,r=e.aj,c=e.a8,d=e.i,m=e.aq,g=e._,p=e.N,b=e.o,v=e.c,f=e.e,y=e.w,C=e.b,h=e.M,V=e.A},e=>{S=e.T},e=>{_=e._},e=>{D=e.Y},e=>{j=e.S},e=>{w=e.g},e=>{I=e.s},e=>{A=e.S},e=>{x=e.E,z=e.a},e=>{F=e.r,R=e.v},null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent="ion-checkbox[data-v-cc453135]{--size: 20px!important}.options[data-v-cc453135]{height:400px;overflow-y:auto}.options ion-label span[data-v-cc453135]:hover{background-color:#ddd;padding:1rem;cursor:pointer}\n",document.head.appendChild(t);const k=o({components:{IonRow:a,IonCol:l,IonButton:n,IonTitle:i,TextInput:S,DateInput:_,YesNoInput:D,SelectInput:j},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},observations:{type:Object,default:()=>({})},initialVisitDate:{type:String,default:""},artStartDate:{type:String,default:""}},emits:["onValue","onPrevious","onFinish"],setup(e,{emit:t}){const o=s([]),a=s([]),l=u((()=>e.patient.getBirthdate())),n=new A(e.patient.getID(),e.patient.getAge(),e.initialVisitDate),i=u((()=>n.getAllReasonsForART(e.artStartDate||e.initialVisitDate,e.patient.isMale()).map((e=>({label:e.name,value:e.name}))))),g=n.getAllWhoStages().filter((e=>e.name.match(/1|2|3|4/i))).map((e=>({label:e.name,value:e.name}))),p=r({reasonsForEligibity:{value:e.observations["Reason for ART eligibility"]||"",label:"Reason for Starting",placeholder:"Select Reason for Starting",required:!0,computedValue:e=>({obs:n.buildReasonForArtObs("string"==typeof e?e:e.label)})},whoStage:{value:e.observations["Who stage"]||"",label:"Select Stage",placeholder:"Select Stage",required:!0,computedValue:e=>({obs:n.buildWhoStageObs("string"==typeof e?e:e.label)})},cd4countAvailable:{value:e.observations["CD4 count"]?"Yes":"No",label:"Recent CD4 Count results available?",required:!0},cd4CountDate:{value:e.observations["Cd4 count datetime"]||"",label:"CD4 Count date",placeholder:"CD4 Count date",computedValue:e=>({obs:n.buildValueDate("Cd4 count datetime",e)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&F(e)}},cd4Count:{value:e.observations["CD4 count"]||"",label:"CD4 Count",placeholder:"CD4 Count e.g. <100 or >500",computedValue:e=>{const t=parseInt(e.substring(1)),o=e.substring(0,1);return{modifier:o,count:t,obs:n.buildValueNumber("CD4 count",t,o)}},validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&R([()=>F(e),()=>n.cd4CountIsValid(e.value.toString())?null:["Please start with a modifier. e.g. >, <, or ="]])}},cd4CountLocation:{value:e.observations["Cd4 count location"]||"",label:"CD4 Count location",computedValue:e=>({obs:n.buildValueText("Cd4 count location","string"==typeof e?e:e.label)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&F(e)}},whoConditions:{value:e.observations["Who stages criteria present"]?[{label:e.observations["Who stages criteria present"],value:e.observations["Who stages criteria present"]}]:"",required:!0,label:"Select Staging Conditions",computedValue:e=>({obs:"string"==typeof e?n.buildWhoCriteriaObs(e):e.map((e=>n.buildWhoCriteriaObs(e.label)))})}}),b=e=>{e&&(p.whoConditions.value="");const t=parseInt((null==e?void 0:e.split(" ")[2])||"1");o.value=n.getStagingConditions(t).map((e=>({label:e.name,value:e.name,other:e}))).sort(((e,t)=>e.label.localeCompare(t.label)))};return c((()=>p.whoStage.value),(e=>b(null==e?void 0:e.label))),c((()=>p.reasonsForEligibity.value),(()=>{p.whoStage.value="",p.whoConditions.value=""})),d((()=>b())),{patientDob:l,form:p,whoStages:g,stagingCoditions:o,selectedConditions:a,reasonsForArt:i,getFacilities:w,onClear:async()=>{if(await m("Are you sure you want to clear all fields?")){for(const e in p)p[e].value=void 0,p[e].error="";x.emit(z.ON_CLEAR)}},onSubmit:async()=>{n.setDate(e.initialVisitDate),await I(p,(async(e,o)=>{t("onValue",{type:"staging",data:{formData:e,computedData:o}}),t("onFinish")}))}}}});e("default",g(k,[["render",function(e,t,o,a,l,n){const i=p("ion-title"),s=p("SelectInput"),u=p("ion-col"),r=p("yes-no-input"),c=p("DateInput"),d=p("text-input"),m=p("ion-button"),g=p("ion-row");return b(),v(h,null,[f(i,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:y((()=>t[8]||(t[8]=[C(" Staging ")]))),_:1}),f(g,{class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(s,{modelValue:e.form.reasonsForEligibity,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.reasonsForEligibity=t),options:e.reasonsForArt},null,8,["modelValue","options"])])),_:1}),f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(s,{modelValue:e.form.whoStage,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.whoStage=t),options:e.whoStages},null,8,["modelValue","options"])])),_:1}),f(u,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(r,{modelValue:e.form.cd4countAvailable,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.cd4countAvailable=t),inline:""},null,8,["modelValue"])])),_:1}),"Yes"===e.form.cd4countAvailable.value?(b(),v(h,{key:0},[f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(c,{modelValue:e.form.cd4CountDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.cd4CountDate=t),"min-date":e.patientDob,"max-date":e.initialVisitDate},null,8,["modelValue","min-date","max-date"])])),_:1}),f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(d,{modelValue:e.form.cd4Count,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.cd4Count=t)},null,8,["modelValue"])])),_:1}),f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(s,{modelValue:e.form.cd4CountLocation,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.cd4CountLocation=t),asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","asyncOptions"])])),_:1})],64)):V("",!0),f(u,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[f(s,{modelValue:e.form.whoConditions,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.whoConditions=t),options:e.stagingCoditions,multiple:""},null,8,["modelValue","options"])])),_:1}),f(u,{size:"12",class:"ion-margin-top"},{default:y((()=>[f(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:y((()=>t[9]||(t[9]=[C("Finish")]))),_:1},8,["onClick"]),f(m,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:y((()=>t[10]||(t[10]=[C("Clear")]))),_:1},8,["onClick"]),f(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:t[7]||(t[7]=t=>e.$emit("onPrevious")),color:"primary"},{default:y((()=>t[11]||(t[11]=[C("Previous")]))),_:1})])),_:1})])),_:1})],64)}],["__scopeId","data-v-cc453135"]]))}}}));
