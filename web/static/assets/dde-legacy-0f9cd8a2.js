System.register(["./toasts-legacy-ce48abc6.js","./index-legacy-2d6958b4.js","./his_date-legacy-70b43096.js"],(function(e,a){"use strict";var t,r,n,i,s,o,u,l;return{setters:[e=>{t=e.t,r=e.a},e=>{n=e.r,i=e.aC,s=e.ap,o=e.aO,u=e.ao},e=>{l=e.t}],execute:function(){e({a:async function(e){var n;if(d.value)return y(await a.findByNpid(e));const i=await o.searchByNpid(e);return i.ok?(r("DDE status updated"),i.data):(t(null!==(n=i.errorMessage)&&void 0!==n?n:`Searching client by NPID returned error: ${i.clientErrorType}`),[])},b:async function(e){var r;if(d.value)return y(await a.findByDemographics(e));const n=await o.searchBy(e);return n.ok?n.data:(t(null!==(r=n.errorMessage)&&void 0!==r?r:`Searching client by Demographics returned error: ${n.clientErrorType}`),[])},g:v,i:async function(e){var n;if(!(await u("Are you sure you want to import client?")))return;const i=await a.importPatient(e);if(i.ok)return r("Client imported to local database"),i.data;t(null!==(n=i.errorMessage)&&void 0!==n?n:`Error importing with error: ${i.clientErrorType}`)},r:async function(){d.value=await a.isDDeEnabled(),d.value&&await v()},s:async function(e){const n=await(e?a.enableDDe():a.disableDDe());var i;n.ok?(d.value=e,r("DDE status updated")):t(null!==(i=n.errorMessage)&&void 0!==i?i:`Unable to change status because ${n.clientErrorType}`)}});const a=new i(s),d=e("d",n(!1)),c=e("n",n([]));function p(e){return e.patient_identifiers.reduce(((e,a)=>({...e,[a.type.name]:a.identifier})),{})["DDE person document ID"]}async function v(){const e=await a.getRemainingNpids();if(e.ok&&e.data){var r,n,i;const a=e.data.npid_status[0],t=null!==(r=a.unassigned)&&void 0!==r?r:0,s=null!==(n=a.avg_consumption_rate_per_day)&&void 0!==n?n:0,o=Math.floor(t/(s||1)),u=l(a.date_last_updated);c.value=[{label:"Assigned",value:null!==(i=a.assigned)&&void 0!==i?i:0},{label:"Unassigned",value:t},{label:"Average consumption per day",value:s},{label:"Estimated days left",value:o},{label:"Last Updated",value:u}],console.log("Npid status refreshed",c.value)}else{var s;t(null!==(s=e.errorMessage)&&void 0!==s?s:`Unable to get NPID status because ${e.clientErrorType}`)}}function y(e){var a;return e.ok&&e.data?Object.keys(e.data).reduce(((a,t)=>[...a,...e.data[t].map((e=>({...e,source:t,docID:p(e),ddeClientRequiresImport:p(e)&&"remotes"===t&&!e.patient_id})))]),[]):(t(null!==(a=e.errorMessage)&&void 0!==a?a:`An error happened with status code: ${e.httpStatusResponse}`),[])}}}}));
