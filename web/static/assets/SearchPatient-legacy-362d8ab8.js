System.register(["./index-legacy-5fd00317.js","./toasts-legacy-8814bb27.js","./DTFormElements-legacy-8934eb68.js","./SelectInput-legacy-239ac137.js","./loader-legacy-26a3e1a4.js","./index-legacy-e04cac88.js","./VoidReason-legacy-fc0b771d.js","./Strs-legacy-09248991.js","./index-legacy-aa705205.js","./his_date-legacy-f511c580.js","./validations-legacy-470ac0cd.js","./_plugin-vue_export-helper-legacy-762b7923.js","./common-legacy-42ce034b.js"],(function(e,a){"use strict";var t,n,l,i,o,r,s,c,d,u,m,h,p,g,y,f,b,v,_,w,I,x,S,j,R,C,V,A,D,$,B,P,T,N,O;return{setters:[e=>{t=e.d,n=e.a7,l=e._,i=e.$,o=e.I,r=e.ab,s=e.J,c=e.S,d=e.a8,u=e.g,m=e.l,h=e.aA,p=e.O,g=e.r,y=e.h,f=e.w,b=e.o,v=e.a,_=e.ad,w=e.f,I=e.b},e=>{x=e.t,S=e.b},e=>{j=e.g},e=>{R=e.S},e=>{C=e.l},e=>{V=e.D},e=>{A=e.p},e=>{D=e.t},e=>{$=e.A,B=e.M},e=>{P=e.t,T=e.f},e=>{N=e.b},e=>{O=e._},null],execute:function(){var a=document.createElement("style");a.textContent=".sc-ion-searchbar-md-h{--box-shadow: none !important}\n",document.head.appendChild(a);const k=t({components:{IonGrid:n,IonRow:l,IonCol:i,SelectInput:R,IonButton:o,IonSearchbar:r,DataTable:V},setup(){const e=s(),{facility:a}=p(),t=c(""),n=c(document.getElementById("selectInput")),l=d({value:"",placeholder:"select gender"}),i=c([]),o=[{label:"ARV Number",path:"arv_number"},{label:"MW National ID",path:"national_id"},{path:"given_name",label:"First name"},{path:"family_name",label:"Last name"},{path:"gender",label:"Gender",formatter:D},{path:"birthdate",label:"Date of Birth (AGE)",formatter:e=>`${P(e)} (${T(e)})`}],r=e=>h.searchByOtherID($,e),g=async(e,t)=>null===N({value:e,label:e})?(e=>h.searchByOtherID(B,e))(e):e.match(/^(\w+-ARV-\w+)$/)?r(e):e.match(/^(\d+)$/)?r(`${a.code}-ARV-${e}`):((e,a)=>{const t={},n=e.split(" ").filter((e=>/\S/.test(e)));return a&&(t.gender=a),n.length>0&&(t.given_name=n[0],t.family_name=n[2]||n[1]||"",t.middle_name=n[2]?n[1]:""),h.searchBy(t)})(e,t),y=async()=>{if(t.value){C.show();try{var e,a;const n=await g(t.value,l.value.value);await C.hide(),i.value=null!==(e=null==n||null===(a=n.data)||void 0===a?void 0:a.map((e=>{var a,t;return{arv_number:null===(a=e.patient_identifiers.find((e=>e.identifier_type==$)))||void 0===a?void 0:a.identifier,national_id:null===(t=e.patient_identifiers.find((e=>e.identifier_type==B)))||void 0===t?void 0:t.identifier,given_name:e.person.names[0].given_name,family_name:e.person.names[0].family_name,gender:e.person.gender,birthdate:e.person.birthdate,personId:e.patient_id}})))&&void 0!==e?e:[]}catch(n){x("Unable to search patients"),console.error(n),await C.hide()}}},f=u((()=>{const a=[{label:"Select",action:a=>e.push(`/patient/${a.personId}`)}];return m.userHasRoles(["Program Manager","Superuser","System Developer"])&&a.push({label:"void",color:"danger",action:async e=>{A((async a=>{try{await h.void(e.personId,a),await y()}catch(t){S(`${t}`)}}),"void-modal")}}),a}));return{searchText:t,gender:l,tableRows:i,tableColumns:o,tableConfig:{showSearchField:!1,showSubmitButton:!1},genderOptions:j,selectInput:n,TableRowActions:f,searchPatient:y,resetQuery:()=>{t.value="",l.value="",i.value=[]}}}}),E={style:{"max-width":"250px"},class:"ion-margin-end ion-margin-vertical"},K=w("h1",{class:"ion-margin"},"Patients Search Results",-1);e("default",O(k,[["render",function(e,a,t,n,l,i){const o=g("ion-searchbar"),r=g("SelectInput"),s=g("ion-button"),c=g("ion-col"),d=g("ion-row"),u=g("data-table"),m=g("ion-grid");return b(),y(m,null,{default:f((()=>[v(d,{class:"his-card"},{default:f((()=>[v(c,{size:"10",style:{display:"flex","justify-content":"flex-start"}},{default:f((()=>[v(o,{style:{width:"350px",height:"2.75rem"},class:"box-input ion-no-padding ion-margin-end ion-margin-vertical",placeholder:"Search by Name or ARV Number or MW National ID",modelValue:e.searchText,"onUpdate:modelValue":a[0]||(a[0]=a=>e.searchText=a),onKeyup:_(e.searchPatient,["enter"])},null,8,["modelValue","onKeyup"]),w("div",E,[v(r,{modelValue:e.gender,"onUpdate:modelValue":a[1]||(a[1]=a=>e.gender=a),options:e.genderOptions,onKeyup:_(e.searchPatient,["enter"])},null,8,["modelValue","options","onKeyup"])]),v(s,{class:"ion-margin-vertical",onClick:e.searchPatient},{default:f((()=>[I("Search")])),_:1},8,["onClick"]),v(s,{class:"ion-margin-vertical",onClick:e.resetQuery,color:"secondary"},{default:f((()=>[I("Reset")])),_:1},8,["onClick"])])),_:1}),v(c,null,{default:f((()=>[v(s,{class:"ion-margin-vertical",href:"/patient/registration",color:"success",style:{float:"right"}},{default:f((()=>[I(" Add New Patient ")])),_:1})])),_:1})])),_:1}),v(d,{class:"his-card ion-margin-top",style:{padding:"0 !important"}},{default:f((()=>[v(c,{size:"12",style:{"min-height":"320px"},class:"ion-no-padding"},{default:f((()=>[K,v(u,{rows:e.tableRows,columns:e.tableColumns,config:e.tableConfig,"row-actions-buttons":e.TableRowActions,color:"light"},null,8,["rows","columns","config","row-actions-buttons"])])),_:1})])),_:1})])),_:1})}]]))}}}));
