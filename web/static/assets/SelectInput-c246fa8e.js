import{d as Y,L as Z,B as _,az as x,y as ee,aA as oe,W as le,ai as ne,x as ae,r as c,h as H,a8 as U,i as te,au as ie,Q as ue,bA as se,aE as re,bz as de,_ as ce,N as m,c as w,j as b,w as y,A as k,an as P,a as L,M as q,P as F,e as C,o as i,t as S,b as $}from"./index-984efe82.js";import{i as V}from"./common-abc2f84d.js";const ve=Y({name:"SelectInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},allowCustom:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},infiniteScrolling:{type:Boolean,default:!1},dropDirection:{type:String,default:"auto",validator:e=>["auto","up","top","down","bottom"].includes(e)}},components:{IonLabel:Z,IonInput:_,IonNote:x,IonIcon:ee,IonCheckbox:oe,IonList:le,IonChip:ne,IonItem:ae},emits:["update:modelValue"],setup(e,{emit:a}){const z=c(!1),A=c(""),r=c(),v=c(!1),d=c(),u=c(""),n=c([]),D=c(1),p=c("down"),B=c(),s=H(()=>e.multiple?n.value.filter(({isChecked:l})=>l):r.value?[r.value]:[]),N=H(()=>!u.value&&V(s.value)&&!v.value),o=H({get:()=>e.modelValue,set:l=>a("update:modelValue",l)}),f=()=>{u.value="",r.value=void 0,n.value.forEach(l=>l.isChecked=!1)},g=()=>{if(f(),V(o.value.value))return;if(Array.isArray(o.value.value)&&e.multiple)return o.value.value.forEach(t=>{const h=n.value.findIndex(({value:I})=>I===t.value);h===-1?n.value.push({...t,isChecked:!0}):n.value[h].isChecked=!0});const l=n.value.find(t=>t.value===o.value.value);l?r.value=l:r.value={label:o.value.value,value:o.value.value}},O=async()=>{const l=typeof e.asyncOptions=="function"?await e.asyncOptions(u.value):e.options.filter(({label:t})=>t.toLowerCase().includes(u.value.toLowerCase()));s.value.forEach(t=>{const h=l.findIndex(I=>I.value===t.value);h===-1?l.push(t):l[h].isChecked=!0}),n.value=l.filter(({label:t})=>!!t)},R=async()=>{if(o.value.required&&V(o.value.value))return o.value.error="This field is required";if(o.value.validation){const l=await o.value.validation({label:o.value.value,value:o.value.value},e.form);if(l&&l.length)return o.value.error+=l.toString()}return o.value.error=""},E=()=>{v.value=!1,o.value.value=e.multiple?s.value:V(s.value)?void 0:s.value[0],u.value="",R()},K=()=>{if(e.dropDirection==="up"||e.dropDirection==="top"){p.value="up";return}else if(e.dropDirection==="down"||e.dropDirection==="bottom"){p.value="down";return}if(B.value){const l=B.value.getBoundingClientRect(),t=window.innerHeight,h=l.top,I=t-l.bottom,X=Math.min(n.value.length*44,300);I<X&&h>I?p.value="up":p.value="down"}},M=()=>{o.value.disabled||(v.value=!0,o.value.error="",K(),console.log("Dropdown direction:",e.dropDirection,"â†’",p.value))},T=()=>{o.value.value={label:A.value,value:A.value}},j=l=>{e.multiple||(r.value=l,E()),o.value.value=e.multiple?s.value:V(s.value)?void 0:s.value[0],u.value=""},Q=l=>e.multiple?l.isChecked=!1:r.value=void 0,W=l=>{l.preventDefault();const t=n.value.indexOf(d.value)+1;d.value=n.value[t]||n.value[0]},G=l=>{l.preventDefault();const t=n.value.indexOf(d.value)-1;d.value=n.value[t]||n.value[n.value.length-1]},J=l=>{switch(v.value||(v.value=!0),l.key){case"ArrowDown":W(l);break;case"ArrowUp":G(l);break;case"Enter":j(d.value);break;case"Escape":E();break}};return U(u,async()=>{D.value++,await O()}),U([()=>e.options,()=>e.asyncOptions],async()=>O()),U(()=>e.modelValue.value,l=>V(l)&&g(),{deep:!0,immediate:!0}),U(v,l=>l&&(d.value=r.value||n.value[0])),te(async()=>{await O(),g(),addEventListener("click",l=>{!l.target.closest(".inner-input-box")&&v.value&&E()})}),ie(()=>removeEventListener("click",l=>console.log(l))),{validate:R,onSelect:j,resetHandler:f,onShowOptions:M,onCloseOptions:E,diselect:Q,onCustomValue:T,handleKeyDown:J,model:o,customOption:A,isCustom:z,chevronDown:ue,chevronUp:se,close:re,closeCircle:de,selectedOption:r,showOptions:v,focusedOption:d,showPlaceholder:N,filteredOptions:n,filter:u,tags:s,dropdownDirection:p,inputRef:B}}});const pe={key:0,class:"text-danger"},me={key:1,class:"ion-float-right ion-margin-end checkbox-label"},fe={class:"inner-input-box",ref:"inputRef"},he={class:"input-icon"};function we(e,a,z,A,r,v){const d=m("ion-checkbox"),u=m("ion-label"),n=m("ion-input"),D=m("ion-icon"),p=m("ion-chip"),B=m("ion-item"),s=m("ion-list"),N=m("ion-note");return i(),w(q,null,[e.model.label?(i(),b(u,{key:0,class:"ion-padding-bottom bold"},{default:y(()=>[L("span",null,S(e.model.label),1),e.model.required?(i(),w("span",pe," *")):k("",!0),e.allowCustom?(i(),w("span",me,[$(" Add Custom "+S(e.model.label)+"? ",1),C(d,{modelValue:e.isCustom,"onUpdate:modelValue":a[0]||(a[0]=o=>e.isCustom=o),onIonChange:a[1]||(a[1]=o=>e.model.value="")},null,8,["modelValue"])])):k("",!0)]),_:1})):k("",!0),e.isCustom?(i(),b(n,{key:1,class:P(["box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}]),modelValue:e.customOption,"onUpdate:modelValue":a[2]||(a[2]=o=>e.customOption=o),placeholder:e.model.placeholder||e.model.label,disabled:e.model.disabled,onIonFocus:a[3]||(a[3]=()=>e.model.error=""),onIonBlur:e.validate,onIonInput:e.onCustomValue},null,8,["class","modelValue","placeholder","disabled","onIonBlur","onIonInput"])):(i(),w("div",{key:2,class:P(["outer-input-box box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}])},[L("div",fe,[L("div",{style:{display:"flex","flex-wrap":"wrap",width:"100%"},onClick:a[6]||(a[6]=(...o)=>e.onShowOptions&&e.onShowOptions(...o))},[(i(!0),w(q,null,F(e.tags,(o,f)=>(i(),b(p,{key:f},{default:y(()=>[C(u,null,{default:y(()=>[$(S(o.label),1)]),_:2},1024),C(D,{icon:e.closeCircle,color:"danger",onClick:g=>e.diselect(o),style:{"z-index":"20"}},null,8,["icon","onClick"])]),_:2},1024))),128)),C(n,{disabled:e.model.disabled,placeholder:e.showPlaceholder?e.model.placeholder||"select option":"",modelValue:e.filter,"onUpdate:modelValue":a[4]||(a[4]=o=>e.filter=o),class:"search-input",ref:"searchInput",onKeydown:a[5]||(a[5]=o=>e.handleKeyDown(o))},null,8,["disabled","placeholder","modelValue"])]),e.showOptions?(i(),w("div",{key:0,class:P(["input-options",{"dropdown-up":e.dropdownDirection==="up","dropdown-down":e.dropdownDirection==="down"}])},[C(s,null,{default:y(()=>[(i(!0),w(q,null,F(e.filteredOptions,(o,f)=>{var g;return i(),b(B,{key:f,lines:f+1===e.filteredOptions.length?"none":void 0,color:o.value===((g=e.focusedOption)==null?void 0:g.value)?"light":"",onClick:O=>e.onSelect(o)},{default:y(()=>[e.multiple?(i(),b(d,{key:0,class:"input-option-checkbox",slot:"start",modelValue:o.isChecked,"onUpdate:modelValue":O=>o.isChecked=O},null,8,["modelValue","onUpdate:modelValue"])):k("",!0),C(u,null,{default:y(()=>[$(S(o.label),1)]),_:2},1024)]),_:2},1032,["lines","color","onClick"])}),128))]),_:1})],2)):k("",!0),L("div",he,[e.filter||e.tags.length>0?(i(),b(D,{key:0,icon:e.close,onClick:e.resetHandler},null,8,["icon","onClick"])):k("",!0),C(D,{icon:e.showOptions?e.chevronUp:e.chevronDown,onClick:a[7]||(a[7]=o=>e.showOptions?e.onCloseOptions():e.onShowOptions())},null,8,["icon"])])],512)],2)),e.model.error?(i(),b(N,{key:3,color:"danger"},{default:y(()=>[$(S(e.model.error),1)]),_:1})):k("",!0)],64)}const ke=ce(ve,[["render",we],["__scopeId","data-v-330c6b2f"]]);export{ke as S};
