import{l as u}from"./loader-cc83f0a0.js";import{_ as w}from"./ReportTable.vue_vue_type_style_index_0_lang-1b35ccd4.js";import{c as _,t as D}from"./toasts-eb3581bc.js";import{a as R}from"./tx_report_service-b5065625.js";import{a as v}from"./arrays-89ea4d05.js";import{d as T,r as s,o as F,h as A}from"./index-44c2209e.js";import"./exports-aa8b872d.js";import"./index-a3bb5f33.js";import"./his_date-094b7106.js";import"./vue-datepicker-c8009a9f.js";import"./DrilldownTable-368b4134.js";import"./report_service-81bd62bb.js";import"./url-ffe761c9.js";import"./age_groups-8203d13f.js";const N=T({__name:"TxRTT",setup(C){const d=s("-"),p=s([]),g=s(),o=new R,c=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:_},{path:"cd4_less_than_200",label:"CD4 <200",drillable:!0},{path:"cd4_greater_than_or_equal_to_200",label:"CD4 >=200",drillable:!0},{path:"unknown_cd4_count",label:"Unknown CD4",drillable:!0},{path:"not_eligible_for_cd4",label:"Not Eligible for CD4",drillable:!0},{path:"returned_less_than_3_months",label:"Returned <3 mo",drillable:!0},{path:"returned_greater_than_3_months_and_less_than_6_months",label:"Returned 3-5 mo",drillable:!0},{path:"returned_greater_than_or_equal_to_6_months",label:"Returned 6+ mo",drillable:!0}];function h(t){const r={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return t.reduce((a,e)=>{if(e.age_group!=="Unknown"){const n=e.gender;a[n].rows.push({...e,ageGroup:e.age_group}),a[n].aggregate=Object.keys(e).reduce((i,l)=>Array.isArray(e[l])?{...i,[l]:[...i[l]||[],...e[l]]}:i,a[n].aggregate)}return a},r)}function m(t){const r=Object.values(t.F.aggregate).flat(1),a=Object.values(t.M.aggregate).flat(1);g.value=v([...r,...a])}async function f({dateRange:t},r=!1){try{await u.show(),o.setStartDate(t.startDate),o.setEndDate(t.endDate),d.value=o.getDateIntervalPeriod();const a=await o.getTxRttReport(r),e=h(a);p.value=[...e.F.rows,...e.M.rows,{ageGroup:"All",gender:"Male",...e.M.aggregate},...await o.buildMaternityAgreggateRows(e.F.aggregate)],m(e)}catch(a){D("ERROR! Unable to load report data"),console.error(a)}await u.hide()}function b(t){return"".concat(t.column.label," | ").concat(t.row.ageGroup," | ").concat(_(t.row.gender),"s")}return(t,r)=>(F(),A(w,{title:"PEPFAR TX RTT Report",subtitle:"Clients that have their clinical dispensation visit falling \n      in the reporting period and there is a difference of 30 or more days \n      between their visit date and their previous appointment date / runout date","report-type":"PEPFAR",columns:c,rows:p.value,period:d.value,"total-clients":g.value,"drill-title":b,useDateRangeFilter:"",showIndices:"",onGenerate:f},null,8,["rows","period","total-clients"]))}});export{N as default};
