System.register(["./vue-datepicker-legacy-e7e3eacf.js","./LineChart.vue_vue_type_script_setup_true_lang-legacy-4f4c7863.js","./index-legacy-f8d71896.js","./common-legacy-0d7df615.js","./index-legacy-aa705205.js","./report_service-legacy-c2dd3c7c.js","./loader-legacy-98dfb669.js","./DrilldownTable-legacy-e5bb2e5a.js","./his_date-legacy-fa5a22a7.js","./toasts-legacy-f5cd9c9b.js","./_plugin-vue_export-helper-legacy-762b7923.js","./arrays-legacy-e3b1d86b.js","./url-legacy-2d97b2db.js","./index-legacy-0575033e.js"],(function(t,e){"use strict";var a,n,i,l,s,r,o,d,u,p,c,g,h,_,m,v,f,y,w,V,D,j,x,b,C,P;return{setters:[t=>{a=t.K},t=>{n=t._},t=>{i=t.G,l=t.d,s=t.i,r=t.j,o=t.k,d=t.r,u=t.H,p=t.L,c=t.h,g=t.w,h=t.o,_=t.a,m=t.f,v=t.b,f=t.t},t=>{y=t.i},t=>{w=t.P},t=>{V=t.R},t=>{D=t.l},t=>{j=t.m,x=t.D},t=>{b=t.i},t=>{C=t.t},t=>{P=t._},null,null,null],execute:function(){class e extends V{constructor(){super()}static getLocationName(){return sessionStorage.getItem("locationName")}getBookedAppointments(t){return i.getJson(`programs/${w}/scheduled_appointments`,{date:t})}getViralLoadResults(t){return this.getReport(`/programs/${w}/reports/high_vl_patients`,{range:t})}getOtherOutcome(t){return this.getReport("patient_outcome_list",{outcome:t})}getPatientVisitTypes(){return this.getReport("patient_visit_types")}getClientsDueForVl(){return this.getReport("clients_due_vl")}getClientRentention(){return this.getReport(`/programs/${w}/reports/retention`)}getExternalConsultationClients(){return this.getReport(`${w}/external_consultation_clients`)}getMissedAppointments(){return this.getReport("missed_appointments")}getPregnantWomen(){return this.getReport(`/programs/${w}/reports/pregnant_patients`)}getArchivingCandidates(){return i.getJson(`programs/${w}/reports/archiving_candidates`,{start_date:this.date})}getIncompleteVisits(){return this.getReport("incomplete_visits",{tool_name:"INCOMPLETE VISITS"})}getVisitStats(){return i.getJson(`programs/${w}/reports/visits`,{name:"visits",start_date:this.startDate,end_date:this.endDate})}}const k=l({components:{LineChart:n,IonGrid:s,IonRow:r,IonCol:o,VueDatePicker:a},setup(){const t=d(""),a=d(""),n=d([]),i=u((()=>{var t;return(null===(t=n.value[0])||void 0===t?void 0:t.raw.flat())||[]})),l=u((()=>{var t;return(null===(t=n.value[1])||void 0===t?void 0:t.raw.flat())||[]})),s=u((()=>{var t;return(null===(t=n.value[2])||void 0===t?void 0:t.raw.flat())||[]})),r=u((()=>n.value.map((({raw:t})=>t)).flat(3))),o=async(t,e="Drill down clients")=>{await j.show(x,{patientIds:t.map((({patientId:t})=>t)),title:e})};return{startDate:t,endDate:a,series:n,options:{title:{text:"Patient Visits Statistics",align:"left"},yaxis:{title:{text:"Number of clients"}}},totalAttendance:r,totalPatientVisits:i,totalGuardianVisits:l,totalBothVisits:s,fetchData:async()=>{if(!b(t.value,a.value))return C("Invalid date range");try{D.show();const i=new e;i.setStartDate(t.value),i.setEndDate(a.value);const l=await i.getPatientVisitTypes();n.value=(t=>{const e={},a={},n={},i=[{name:"Patient present",raw:[],data:[]},{name:"Guardian present",raw:[],data:[]},{name:"Both patient and guardian present",raw:[],data:[]}];return Object.entries(t).forEach((([t,l])=>{e[t]=[],a[t]=[],n[t]=[],Object.entries(l).forEach((([i,{patient_present:l,guardian_present:s}])=>{s&&l?n[t].push({patientId:i,date:t}):l?e[t].push({patientId:i,date:t}):s&&a[t].push({patientId:i,date:t})}));const s=new Date(t).getTime();i[0].data.push([s,e[t].length]),i[0].raw.push(e[t]),i[1].data.push([s,a[t].length]),i[1].raw.push(a[t]),i[2].data.push([s,n[t].length]),i[2].raw.push(n[t])})),i})(l)}catch(i){console.error(i),C("Unable to generate patient visits data")}D.hide()},pointSelection:async(t,e)=>{if(!y(n.value))try{await o(n.value[e].raw[t],`${n.value[e].name} visits`)}catch(a){console.error(a)}},drilldown:o}}}),I={style:{display:"flex","justify-content":"flex-start"}},R={class:"his-card"};t("default",P(k,[["render",function(t,e,a,n,i,l){const s=p("vue-date-picker"),r=p("ion-button"),o=p("ion-col"),d=p("ion-label"),u=p("ion-badge"),y=p("ion-item"),w=p("ion-list"),V=p("line-chart"),D=p("ion-row"),j=p("ion-grid");return h(),c(j,null,{default:g((()=>[_(D,null,{default:g((()=>[_(o,{size:"6",offset:"6",class:"ion-padding"},{default:g((()=>[m("div",I,[_(s,{modelValue:t.startDate,"onUpdate:modelValue":e[0]||(e[0]=e=>t.startDate=e),placeholder:"Start Date","enable-time-picker":!1,format:"dd/MMM/yyyy","auto-apply":"","text-input":"",class:"ion-margin-end"},null,8,["modelValue"]),_(s,{modelValue:t.endDate,"onUpdate:modelValue":e[1]||(e[1]=e=>t.endDate=e),placeholder:"End Date","enable-time-picker":!1,format:"dd/MMM/yyyy","auto-apply":"","text-input":"",class:"ion-margin-end"},null,8,["modelValue"]),_(r,{color:"primary",class:"ion-no-margin",onClick:t.fetchData},{default:g((()=>[v("Generate")])),_:1},8,["onClick"])])])),_:1}),_(o,{size:"3",class:"ion-padding-top"},{default:g((()=>[m("div",R,[_(w,null,{default:g((()=>[_(y,{button:"",onClick:e[2]||(e[2]=e=>t.drilldown(t.totalAttendance,"Total Attendance"))},{default:g((()=>[_(d,null,{default:g((()=>[v("Total Attendance ")])),_:1}),_(u,null,{default:g((()=>[v(f(t.totalAttendance.length),1)])),_:1})])),_:1}),_(y,{button:"",onClick:e[3]||(e[3]=e=>t.drilldown(t.totalPatientVisits,"Total patient visits"))},{default:g((()=>[_(d,null,{default:g((()=>[v("Patient Visit ")])),_:1}),_(u,null,{default:g((()=>[v(f(t.totalPatientVisits.length),1)])),_:1})])),_:1}),_(y,{button:"",onClick:e[4]||(e[4]=e=>t.drilldown(t.totalGuardianVisits,"Total guardian visits"))},{default:g((()=>[_(d,null,{default:g((()=>[v("Guardian Visit ")])),_:1}),_(u,null,{default:g((()=>[v(f(t.totalGuardianVisits.length),1)])),_:1})])),_:1}),_(y,{button:"",onClick:e[5]||(e[5]=e=>t.drilldown(t.totalBothVisits,"Total patient and guardian visits"))},{default:g((()=>[_(d,null,{default:g((()=>[v("Patient and Guardian Visit ")])),_:1}),_(u,null,{default:g((()=>[v(f(t.totalBothVisits.length),1)])),_:1})])),_:1})])),_:1})])])),_:1}),_(o,{size:"9"},{default:g((()=>[_(V,{style:{height:"600px"},series:t.series,options:t.options,onPointSelection:t.pointSelection,placeholder:"select date period"},null,8,["series","options","onPointSelection"])])),_:1})])),_:1})])),_:1})}]]))}}}));
