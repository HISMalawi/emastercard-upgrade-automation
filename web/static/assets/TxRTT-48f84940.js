import{l as u}from"./loader-1441845f.js";import{_ as w}from"./ReportTable.vue_vue_type_script_setup_true_lang-18fee1ca.js";import{t as _}from"./common-94ac9539.js";import{T as D}from"./tx_report_service-d2a186d5.js";import{t as R}from"./toasts-926a2fd9.js";import{a as v}from"./arrays-7f14d286.js";import{d as T,S as s,o as F,h as A}from"./index-1c16650e.js";import"./exports-300de8ff.js";import"./index-e903e9ca.js";import"./his_date-3ca53c6f.js";import"./vue-datepicker-312099be.js";import"./DrilldownTable-d5470f91.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./report_service-1011140c.js";import"./index-95d3a767.js";import"./url-ffe761c9.js";import"./age_groups-8203d13f.js";const z=T({__name:"TxRTT",setup(C){const p=s("-"),d=s([]),g=s(),o=new D,c=[{path:"ageGroup",label:"Age group"},{path:"gender",label:"Gender",formatter:_},{path:"cd4_less_than_200",label:"CD4 <200",drillable:!0},{path:"cd4_greater_than_or_equal_to_200",label:"CD4 >=200",drillable:!0},{path:"unknown_cd4_count",label:"Unknown CD4",drillable:!0},{path:"not_eligible_for_cd4",label:"Not Eligible for CD4",drillable:!0},{path:"returned_less_than_3_months",label:"Returned <3 mo",drillable:!0},{path:"returned_greater_than_3_months_and_less_than_6_months",label:"Returned 3-5 mo",drillable:!0},{path:"returned_greater_than_or_equal_to_6_months",label:"Returned 6+ mo",drillable:!0}];function m(t){const r={M:{rows:[],aggregate:{}},F:{rows:[],aggregate:{}}};return t.reduce((a,e)=>{if(e.age_group!=="Unknown"){const n=e.gender;a[n].rows.push({...e,ageGroup:e.age_group}),a[n].aggregate=Object.keys(e).reduce((i,l)=>Array.isArray(e[l])?{...i,[l]:[...i[l]||[],...e[l]]}:i,a[n].aggregate)}return a},r)}function h(t){const r=Object.values(t.F.aggregate).flat(1),a=Object.values(t.M.aggregate).flat(1);g.value=v([...r,...a])}async function f({dateRange:t},r=!1){try{await u.show(),o.setStartDate(t.startDate),o.setEndDate(t.endDate),p.value=o.getDateIntervalPeriod();const a=await o.getTxRttReport(r),e=m(a);d.value=[...e.F.rows,...e.M.rows,{ageGroup:"All",gender:"Male",...e.M.aggregate},...await o.buildMaternityAgreggateRows(e.F.aggregate)],h(e)}catch(a){R("ERROR! Unable to load report data"),console.error(a)}await u.hide()}function b(t){return"".concat(t.column.label," | ").concat(t.row.ageGroup," | ").concat(_(t.row.gender),"s")}return(t,r)=>(F(),A(w,{title:"PEPFAR TX RTT Report",subtitle:"Clients that have their clinical dispensation visit falling \n      in the reporting period and there is a difference of 30 or more days \n      between their visit date and their previous appointment date / runout date","report-type":"PEPFAR",columns:c,rows:d.value,period:p.value,"total-clients":g.value,"drill-title":b,useDateRangeFilter:"",showIndices:"",onGenerate:f},null,8,["rows","period","total-clients"]))}});export{z as default};
