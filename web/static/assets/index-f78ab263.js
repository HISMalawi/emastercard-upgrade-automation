import{d as V,r as S,h as b,aj as be,a8 as D,i as Se,ax as n,m as N,n as y,l as W,br as He,y as B,I as j,L as O,B as E,x as G,bs as qe,bt as me,ap as Me,bu as We,bv as Ge,bw as Ve,bx as Je,by as _e,av as Ke,ai as Xe,bz as Ye,W as Ze,aB as Qe,aF as et,bA as tt,Q as nt,aA as at,bB as st}from"./index-6ba03bc9.js";function U(e,i){if(e==null)return;const s=i.replace(/\[(\w+)\]/g,".$1").split(".");let o=e;for(const c of s){if(o==null)return;o=o[c]}return o}function h(e){return e==null?!0:typeof e=="string"||Array.isArray(e)?e.length===0:typeof e=="object"?Object.keys(e).length===0:!1}async function it(e,i=!1,s){let o=e;return typeof s=="function"&&(o=await s()),i?o.map((c,r)=>({...c,index:r+1})):o}function ot(e,i,s){return Array.isArray(e)?e.length<=1?[...e]:[...e].sort((o,c)=>{for(let r=0;r<i.length;r++){const f=i[r],k=s[r],z=f(o),g=f(c);if(z!==g)return k==="asc"?z<g?-1:1:z>g?-1:1}return 0}):[]}function lt(e,i){if(h(i))return e;const s=i.map(({order:c})=>c),o=i.map(({column:c})=>r=>{let f=U(r,c.path);return h(f)?"":(typeof c.preSort=="function"&&(f=c.preSort(f)),typeof f=="number"||c.sortCaseSensitive?f:f.toString().toLowerCase())});return ot(e.slice(),o,s)}function rt(e,i){const{page:s,pageSize:o,totalPages:c}=e,r=s*o-(o-1),f=s===c?i:s*o;return i?"Showing ".concat(r," to ").concat(f," of ").concat(i," entries"):"No data available"}function ut(e,i,s){return e.totalPages=Math.ceil(i/e.pageSize),e.totalPages<=e.visibleBtns?(e.start=1,e.end=e.totalPages,e):((s.includes(e.page-1)||e.page===1)&&(s.includes(e.page+1)||e.page===e.totalPages)||(e.start=e.page===1?1:e.page-1,e.end=e.start+e.visibleBtns-5,e.start<=3&&(e.end+=3-e.start,e.start=1),e.end>=e.totalPages-2&&(e.start-=e.end-(e.totalPages-2),e.end=e.totalPages),e.start=Math.max(e.start,1)),e)}function ct(e,i){if(h(e))return e;const{page:s,pageSize:o}=i,c=(s-1)*o;return e.slice(c,c+o)}function dt(e){return e.reduce((i,s)=>(s.initialSort&&i.push({column:s,order:s.initialSortOrder||"asc"}),i),[])}function ft(e,i){const s=e.findIndex(o=>o.column.path===i.path);return s>=0?e[s].order=e[s].order==="asc"?"desc":"asc":e=[{column:i,order:"asc"}],e}function vt(e,i){return!i||h(e)?e:e.slice().filter(s=>Object.values(s).some(o=>o&&JSON.stringify(o).toLowerCase().includes(i.toLowerCase())))}function gt(e,i,s){return typeof e.drillable=="function"?e.drillable(i,s):!!e.drillable&&!h(i)}function Ce(e,i){const s=[];for(let o=e;o<i;o++)s.push(o);return s}function pt(e){return typeof e!="string"?!1:/<\/?[a-z][\s\S]*>/i.test(e)}function ht(e){const i=document.createElement("div");i.innerHTML=e;const s=["script","iframe","object","embed","form"],o=["onload","onerror","onclick","onmouseover","onfocus","onblur"];return s.forEach(r=>{i.querySelectorAll(r).forEach(k=>k.remove())}),i.querySelectorAll("*").forEach(r=>{o.forEach(f=>{r.hasAttribute(f)&&r.removeAttribute(f)}),Array.from(r.attributes).forEach(f=>{f.name.toLowerCase().startsWith("on")&&r.removeAttribute(f.name)})}),i.innerHTML}const yt=V({name:"SelectInput",props:{value:{type:Object,default:()=>({})},label:{type:String,default:""},placeholder:{type:String,default:"Select Option"},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},required:{type:Boolean,default:!1},validate:{type:Function,required:!1}},emits:["select"],setup(e,{emit:i}){const s=S(),o=S(!1),c=S(""),r=S([]),f=S(""),k=b(()=>f.value?"box-input-error":""),z=b(()=>e.label?"ion-margin-top":""),g=b(()=>e.multiple?r.value.filter(({isChecked:u})=>u):s.value?[s.value]:[]),d=b(()=>!c.value&&h(g.value)&&!o.value),p=b({get:()=>e.value,set:u=>i("select",u)}),R=()=>{s.value=void 0,!h(p.value)&&(Array.isArray(p.value)&&e.multiple&&p.value.forEach(u=>{const m=r.value.findIndex(({value:x})=>x===u.value);m===-1?r.value.push({...u,isChecked:!0}):r.value[m].isChecked=!0}),s.value=r.value.find(u=>Array.isArray(p.value)?u.value===p.value[0].value:u.value===p.value.value),h(s.value)&&(s.value=Array.isArray(p.value)?p.value[0]:p.value))},I=async()=>{const u=typeof e.asyncOptions=="function"?await e.asyncOptions(c.value):e.options.filter(({label:m})=>m.toLowerCase().includes(c.value.toLowerCase()));g.value.forEach(m=>{const x=u.findIndex(M=>M.value===m.value);x===-1?u.push(m):u[x].isChecked=!0}),r.value=u},L=async()=>{if(e.required&&h(p.value))return f.value="This field is required";if(typeof e.validate=="function"){const u=await e.validate(p.value);u&&u.length&&(f.value=u.join(", "))}return f.value=""},w=()=>{o.value=!1,p.value=e.multiple?g.value:h(g.value)?{}:g.value[0],c.value="",L()},T=()=>{e.disabled||(o.value=!0,f.value="")},$=u=>{if(!e.multiple)return s.value=u,w();p.value=e.multiple?g.value:h(g.value)?{}:g.value[0],c.value=""},H=u=>e.multiple?u.isChecked=!1:s.value=void 0,q=()=>{c.value="",s.value=void 0,r.value.forEach(u=>u.isChecked=!1)};return D(()=>e.value,()=>R()),D([c,()=>e.options,()=>e.asyncOptions],async()=>{await I(),R()}),Se(async()=>{await I(),R(),addEventListener("click",u=>{!u.target.closest(".inner-input-box")&&o.value&&w()})}),Ke(()=>removeEventListener("click",u=>console.log(u))),()=>[e.label&&n(O,{class:"ion-padding-bottom bold"},e.label),n("div",{class:"outer-input-box box-input ".concat(k.value," ").concat(z.value)},n("div",{class:"inner-input-box"},[n("div",{style:{display:"flex",flexWrap:"wrap",width:"100%"},onClick:T},[...g.value.map(u=>n(Xe,[n(O,u.label),n(B,{icon:Ye,color:"danger",onClick:()=>H(u),style:{zIndex:90}})])),n(E,{disabled:e.disabled,placeholder:d.value?e.placeholder:"",class:"search-input",value:c.value,onIonInput:u=>c.value=u.target.value})]),o.value&&n("div",{class:"input-options"},n(Ze,r.value.map((u,m)=>n(G,{lines:m+1===r.value.length?"none":void 0,onClick:()=>$(u)},[e.multiple&&n(Qe,{class:"input-option-checkbox",slot:"start",value:u.isChecked,onIonInput:x=>u.isChecked=x.target.checked}),n(O,u.label)])))),n("div",{class:"input-icon"},[(c.value||g.value.length)&&n(B,{icon:et,onClick:q}),n(B,{icon:o.value?tt:nt,onClick:o.value?w:T})].filter(Boolean))])),f.value&&n(at,{color:"danger"},f.value)]}}),bt=V({props:{range:{type:Object,default:()=>({startDate:"",endDate:""})}},emits:["rangeChange"],setup(e,{emit:i}){const s=S(e.range.startDate),o=S(e.range.endDate),c=b(()=>({startDate:s.value,endDate:o.value}));return D(c,r=>i("rangeChange",r)),()=>n(W,{class:"ion-no-padding ion-no-margin"},()=>n(N,[n(y,{size:"6"},()=>n(E,{type:"date",class:"box-input",value:s.value,onIonInput:r=>s.value=r.target.value,style:{width:"100%"}})),n(y,{size:"1",style:{display:"flex",justifyContent:"center "}},()=>n(B,{icon:st,style:{fontSize:"24px",padding:".5rem"}})),n(y,{size:"5"},()=>n(E,{type:"date",class:"box-input",value:o.value,onIonInput:r=>o.value=r.target.value,style:{width:"100%"}}))]))}}),Ct=V({name:"DataTable",props:{rows:{type:Array,default:()=>[]},asyncRows:{type:Function,required:!1},columns:{type:Array,default:()=>[]},actionsButtons:{type:Array,default:()=>[]},rowActionsButtons:{type:Array,default:()=>[]},customFilters:{type:Array,default:()=>[]},color:{type:String},config:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1}},emits:["customFilter","queryChange","drilldown"],setup(e,{emit:i,slots:s}){var _,K,X,Y,Z,Q,ee,te,ne,ae,se,ie,oe,le,re,ue,ce,de,fe,ve,ge,pe,he,ye;const o=S(!1),c=S([]),r=S([]),f=b(()=>r.value.length),k=b(()=>h(e.rowActionsButtons)?g.value.length:g.value.length+1),z=b(()=>d.pagination.enabled?Ce(d.pagination.start,d.pagination.end+1):[]),g=b(()=>e.config.showIndices?[{path:"index",label:"#",initialSort:!0,initialSortOrder:"asc"},...e.columns]:e.columns),d=be({search:"",sort:[],pagination:{enabled:(X=(K=(_=e.config)==null?void 0:_.pagination)==null?void 0:K.enabled)!=null?X:!0,page:(Q=(Z=(Y=e.config)==null?void 0:Y.pagination)==null?void 0:Z.page)!=null?Q:1,pageSize:(ne=(te=(ee=e.config)==null?void 0:ee.pagination)==null?void 0:te.pageSize)!=null?ne:10,start:(ie=(se=(ae=e.config)==null?void 0:ae.pagination)==null?void 0:se.start)!=null?ie:1,end:(re=(le=(oe=e.config)==null?void 0:oe.pagination)==null?void 0:le.end)!=null?re:1,totalPages:(de=(ce=(ue=e.config)==null?void 0:ue.pagination)==null?void 0:ce.totalPages)!=null?de:1,visibleBtns:(ge=(ve=(fe=e.config)==null?void 0:fe.pagination)==null?void 0:ve.visibleBtns)!=null?ge:7,pageSizeOptions:(ye=(he=(pe=e.config)==null?void 0:pe.pagination)==null?void 0:he.pageSizeOptions)!=null?ye:[5,10,20,50,100]}}),p=S([]),R=b(()=>e.config.showSearchField!==!1||e.customFilters.length>0||e.actionsButtons.length>0),I=be(e.customFilters.reduce((t,a)=>(t[a.id]=a.value,t),{})),L=async()=>{o.value=!0,c.value=await it(e.rows,e.config.showIndices||!1,e.asyncRows),d.sort=dt(g.value),w(d.pagination),o.value=!1},w=(t,a,l)=>{d.search=a!=null?a:"",l&&(d.sort=ft(d.sort,l));const v=vt(c.value,d.search);r.value=lt(v,d.sort),d.pagination.enabled?(d.pagination=ut(t,f.value,z.value),p.value=ct(r.value,d.pagination)):p.value=r.value};D(I,()=>{e.config.showSubmitButton===!1&&i("customFilter",I)},{immediate:!0,deep:!0}),D(()=>e.rows,()=>L(),{deep:!0,immediate:!0}),Se(()=>L());const T=()=>e.config.showSearchField!==!1?n(y,{size:"4"},()=>[n(Me,{placeholder:"search here...",class:"box ion-no-padding",value:d.search,onIonInput:t=>w({...d.pagination,page:1},t.target.value)})]):null,$=t=>n(y,{size:"".concat(t.gridSize)||"3"},()=>n(yt,{options:t.options,placeholder:t.label||t.placeholder||"Select Item",value:t.value,multiple:t.multiple,onSelect:a=>{typeof t.onUpdate=="function"&&t.onUpdate(a),I[t.id]=a}})),H=t=>n(y,{size:"".concat(t.gridSize)||"6"},()=>n(bt,{range:b(()=>t.value||{startDate:"",endDate:""}).value,onRangeChange:async a=>{typeof t.onUpdate=="function"&&t.onUpdate(a),I[t.id]=a}})),q=t=>n(y,{size:"4"},()=>n(E,{class:"box",type:t.type,placeholder:t.placeholder,value:b(()=>t.value||"").value,onIonInput:async a=>{const l=a.target.value;typeof t.onUpdate=="function"&&t.onUpdate(l),I[t.id]=l}})),u=()=>e.customFilters.map(t=>{if(t.slotName&&s[t.slotName]){const a=s[t.slotName];return n(y,{size:"".concat(t.gridSize||"3")},()=>a&&a({filter:t}))}return t.type==="dateRange"?H(t):t.type==="select"?$(t):q(t)}),m=()=>e.customFilters.length>0&&e.config.showSubmitButton!==!1?n(y,{size:"2"},()=>[n(j,{color:"primary",class:"ion-no-margin",onClick:()=>i("customFilter",I)},"Submit")]):null,x=()=>e.actionsButtons.map(t=>{var a;return n(j,{class:"ion-float-right",color:t.color||"primary",size:(a=t.size)!=null?a:"default",onClick:()=>t.action(p.value,c.value,d,g.value)},t.icon?n(B,{icon:t.icon}):t.label)}),M=()=>R.value&&n(W,{style:{width:"100%",fontWeight:500}},()=>n(N,()=>[n(y,{size:"7"},()=>n(N,()=>[T(),...u(),m()])),n(y,{size:"5",class:"ion-padding-end"},()=>x())])),we=()=>d.pagination.enabled&&d.pagination.totalPages>1&&n(W,{style:{width:"100%",textAlign:"left",color:"black"},class:"ion-padding"},()=>n(N,[n(y,{size:"4"},()=>Ie()),n(y,{size:"5",class:"text-center"},()=>[Ae(),ke()]),n(y,{size:"3"},()=>ze())])),Ie=()=>{const{page:t,start:a,end:l,totalPages:v}=d.pagination,C=F=>w({...d.pagination,page:F}),A=[P({icon:We,disabled:t===a,onClick:()=>C(t-1)})];return a>3&&(A.push(P({label:"1",onClick:()=>C(1)})),A.push(P({label:"...",disabled:!0}))),z.value.forEach(F=>{A.push(P({label:F,onClick:()=>C(F)}))}),l<v-2&&(A.push(P({label:"...",disabled:!0})),A.push(P({label:v,onClick:()=>C(v)}))),A.push(P({icon:He,disabled:t===l||h(r.value),onClick:()=>C(t+1)})),A},P=({disabled:t,label:a,icon:l,onClick:v})=>n(j,{onClick:v,disabled:t,size:"small",color:d.pagination.page===a?"primary":"light"},l?n(B,{icon:l}):a||"Button"),Ae=()=>n(G,{class:"box go-to-input ion-hide-xl-down",lines:"none"},[n(O,{class:"ion-margin-end"},"Go to page"),n(E,{type:"number",min:1,max:d.pagination.totalPages,value:d.pagination.page,style:{paddingRight:"15px"},debounce:500,onIonChange:t=>{const a=t.target.value;a>0&&a<=d.pagination.totalPages&&w({...d.pagination,page:a})}})]),ke=()=>n(G,{class:"box per-page-input",lines:"none"},[n(O,"Items per page"),n(qe,{value:d.pagination.pageSize,interface:"popover",onIonChange:t=>w({...d.pagination,pageSize:t.target.value,page:1})},[...d.pagination.pageSizeOptions.map(t=>n(me,{value:t,key:t},t)),n(me,{value:f.value},"All")])]),ze=()=>n(y,{size:"4",class:"pagination-info"},b(()=>rt(d.pagination,f.value)).value),xe=()=>n("thead",{class:e.color||""},n("tr",[...g.value.map(t=>Pe(t)),!h(e.rowActionsButtons)&&n("th","Actions")])),Be=t=>{const a={marginRight:"5px",float:"right",cursor:"pointer"},l=b(()=>{const v=d.sort.find(C=>C.column.path===t.path);return v?v.order=="asc"?Je:_e:Ve});return n(B,{icon:l.value,style:a})},Pe=t=>{var v;const a={minWidth:/index/i.test(t.path)?"80px":"190px",...t.thStyles},l=()=>w(d.pagination,d.search,t);return n("th",{key:t.label,style:a,class:(v=t.thClasses)==null?void 0:v.join(" "),onClick:l},[n("span",t.label),t.sortable!==!1&&Be(t)])},Fe=()=>n("tbody",{class:"table-body"},o.value||e.loading?Re():h(r.value)?Oe():Ee()),Re=()=>Ce(0,9).map(t=>n("tr",{key:t},n("td",{colspan:k.value},n(Ge,{animated:!0,style:{width:"100%"}})))),Oe=()=>n("tr",n("td",{colspan:k.value},n("div",{class:"no-data-table"},"No data available"))),De=async(t,a)=>{const l=e.rowActionsButtons.find(v=>v.default);l&&await l.action(t,a)},Ee=()=>p.value.map((t,a)=>n("tr",{key:t,onClick:()=>De(t,a)},[...Le(t),Ne(t,a)])),Le=t=>g.value.map((a,l)=>{var F;const C=["data-cell",...typeof a.tdClasses=="function"?a.tdClasses(U(t,a.path),t):(F=a.tdClasses)!=null?F:[]].join(" "),A=typeof a.tdStyles=="function"?a.tdStyles(U(t,a.path),t):a.tdStyles;return n("td",{key:l,class:C,style:A},Te(t,a))}),Te=(t,a)=>{let l=U(t,a.path);if(a.slotName&&s[a.slotName]){const v=s[a.slotName];return v&&v({value:l,row:t,column:a})}if(typeof a.customRenderer=="function")return a.customRenderer(l,t,a);if(a.component){const v=typeof a.componentProps=="function"?a.componentProps(l,t):{value:l,row:t,column:a};return n(a.component,v)}if(typeof a.formatter=="function"&&l!==null&&l!==void 0&&(l=a.formatter(l,t)),gt(a,l,t)){const v=J(l);return n("a",{onClick:C=>{C.preventDefault(),C.stopPropagation(),i("drilldown",{column:a,row:t})}},v)}else return J(l)},J=t=>{if(pt(t)&&typeof t=="string"){const a=ht(t);return n("span",{innerHTML:a})}return je(t)},je=t=>Array.isArray(t)?t.length:t,Ne=(t,a)=>h(e.rowActionsButtons)?null:n("td",e.rowActionsButtons.map(l=>(typeof l.condition=="function"?l.condition(t):!0)?Ue(t,a,l):null)),Ue=(t,a,l)=>{var v;return n(j,{key:l.icon,size:(v=l.size)!=null?v:"small",color:l.color||"primary",onClick:()=>l.action(t,a)},l.icon?()=>n(B,{icon:l.icon}):l.label||"Button")},$e=()=>n("div",{class:"responsive-table ion-padding-horizontal"},n("table",{class:"table bordered-table striped-table"},[xe(),Fe()]));return()=>[M(),$e(),we()]}});export{Ct as D,lt as s};
