System.register(["./index-legacy-79e582e4.js","./TextInput-legacy-9c47757f.js","./SelectInput-legacy-89cba976.js","./common-legacy-e8d6ba88.js","./user_service-legacy-4fc8ea78.js","./form-legacy-d2579fde.js","./toasts-legacy-70b925e2.js","./PasswordUpdate-legacy-6afb9e84.js","./Strs-legacy-b5721578.js","./loader-legacy-ddb5a771.js","./his_date-legacy-95d4aa02.js","./validations-legacy-609558df.js"],function(e,a){"use strict";var l,s,r,o,t,n,u,i,m,d,c,f,p,g,v,y,_,j,I,U,b,h,w,F;return{setters:[e=>{l=e.d,s=e.I,r=e.l,o=e.m,t=e.n,n=e.r,u=e.aj,i=e.i,m=e._,d=e.N,c=e.j,f=e.w,p=e.o,g=e.e,v=e.a,y=e.b},e=>{_=e.T},e=>{j=e.S},e=>{I=e.g},e=>{U=e.U},e=>{b=e.s},e=>{h=e.a,w=e.b},e=>{F=e.P},null,null,null,null],execute:function(){const a=l({name:"UserModal",components:{IonButton:s,IonGrid:r,IonRow:o,IonCol:t,TextInput:_,SelectInput:j,PasswordUpdate:F},setup(){const e=n([]),a=n(-1),l=n(1),s=u({givenName:{value:"",label:"First Name",required:!0},familyName:{value:"",label:"Last Name",required:!0},username:{value:"",label:"Username",disabled:!0},roles:{value:[],label:"Roles",required:!0}}),r=async()=>{const e=await U.getCurrentUser();e&&(a.value=e.user_id,s.username.value=e.username,s.givenName.value=I(e,"person.names[0].given_name",""),s.familyName.value=I(e,"person.names[0].family_name",""),s.roles.value=e.roles.map(e=>({value:e.role,label:e.role,other:e})))};return i(async()=>{await U.getAllRoles().then(a=>{const l=Array.isArray(a.data)?a.data:[];e.value=l.map(e=>({value:e.role,label:e.role,other:e}))}),await r(),l.value++}),{userForm:s,roles:e,refreshRoles:l,updateProfile:()=>b(s,async e=>{try{const l=await U.updateUser(a.value,{...e,roles:e.roles.map(e=>e.label)});if(!l||!l.data)throw new Error("Failed to update user profile");{const e=l.data;sessionStorage.setItem("username",e.username),sessionStorage.setItem("userRoles",JSON.stringify(e.roles)),h("User profile has been updated successfully",3e3),r()}}catch(l){w("Failed to update user profile")}})}}}),N={class:"his-card"};e("default",m(a,[["render",function(e,a,l,s,r,o){const t=d("ion-col"),n=d("text-input"),u=d("SelectInput"),i=d("TextInput"),m=d("IonButton"),_=d("ion-row"),j=d("password-update"),I=d("ion-grid");return p(),c(I,null,{default:f(()=>[g(_,null,{default:f(()=>[g(t,{size:"8"},{default:f(()=>[v("div",N,[g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>a[4]||(a[4]=[v("h2",null,"User Profile",-1)])),_:1,__:[4]}),g(_,null,{default:f(()=>[g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>[g(n,{modelValue:e.userForm.username,"onUpdate:modelValue":a[0]||(a[0]=a=>e.userForm.username=a)},null,8,["modelValue"])]),_:1}),g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>[(p(),c(u,{modelValue:e.userForm.roles,"onUpdate:modelValue":a[1]||(a[1]=a=>e.userForm.roles=a),options:e.roles,multiple:"",key:e.refreshRoles},null,8,["modelValue","options"]))]),_:1}),g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>[g(i,{modelValue:e.userForm.givenName,"onUpdate:modelValue":a[2]||(a[2]=a=>e.userForm.givenName=a)},null,8,["modelValue"])]),_:1}),g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>[g(i,{modelValue:e.userForm.familyName,"onUpdate:modelValue":a[3]||(a[3]=a=>e.userForm.familyName=a)},null,8,["modelValue"])]),_:1}),g(t,{size:"12",class:"ion-margin-vertical"},{default:f(()=>[g(m,{class:"ion-margin-vertical",onClick:e.updateProfile},{default:f(()=>a[5]||(a[5]=[y("Save Changes")])),_:1,__:[5]},8,["onClick"])]),_:1})]),_:1})])]),_:1}),g(t,{size:"4"},{default:f(()=>[g(j)]),_:1})]),_:1})]),_:1})}]]))}}});
