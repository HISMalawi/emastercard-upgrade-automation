System.register(["./ReportTable.vue_vue_type_script_setup_true_lang-legacy-dcfa1363.js","./user_service-legacy-65d523f2.js","./index-legacy-5705a9b7.js","./DrilldownTable-legacy-4f1ea4f5.js","./TextInput-legacy-e955883b.js","./SelectInput-legacy-145559fd.js","./form-legacy-8b805202.js","./common-legacy-2d845b1c.js","./toasts-legacy-ac0a9e63.js","./services-legacy-c0d50b76.js","./validations-legacy-9351084c.js","./_plugin-vue_export-helper-legacy-762b7923.js","./Date-legacy-61e414e0.js","./exports-legacy-d3f6086b.js","./index-legacy-668a84bd.js","./his_date-legacy-df0799d6.js","./vue-datepicker-legacy-008eb8d3.js","./arrays-legacy-ea080c1a.js","./index-legacy-aa705205.js","./Strs-legacy-09248991.js","./loader-legacy-5e05219c.js"],(function(e,a){"use strict";var l,n,o,t,r,s,i,u,c,d,m,p,v,f,g,y,_,w,h,b,I,U,j,V,x,S,A,B,C,N,T,P,k,D,F,R,q,z,H,O,$;return{setters:[e=>{l=e._},e=>{n=e.U},e=>{o=e.d,t=e.I,r=e.D,s=e.S,i=e.C,u=e.q,c=e.Z,d=e.n,m=e.$,p=e.v,v=e.r,f=e.H,g=e.ae,y=e.a2,_=e.aJ,w=e.L,h=e.o,b=e.h,I=e.w,U=e.a,j=e.b,V=e.t,x=e.aK,S=e.aL,A=e.ai,B=e.aM},e=>{C=e.m},e=>{N=e.T},e=>{T=e.S},e=>{P=e.i,k=e.r},e=>{D=e.i,F=e.g},e=>{R=e.t,q=e.a},e=>{z=e.R},e=>{H=e.a},e=>{O=e._},e=>{$=e.H},null,null,null,null,null,null,null,null],execute:function(){const a=o({name:"UserModal",components:{IonButton:t,IonPage:r,IonHeader:s,IonContent:i,IonToolbar:u,IonButtons:c,IonFooter:d,IonTitle:m,IonIcon:p,TextInput:N,SelectInput:T},props:{user:{type:Object,default:()=>({})}},setup(e){var a;const l=v([]),o=f((()=>D(e.user)?"Add New User":"Edit User")),t=g({givenName:{value:F(e.user,"person.names[0].given_name",""),label:"First Name",required:!0,validation:e=>H(e)},familyName:{validation:e=>H(e),value:F(e.user,"person.names[0].family_name",""),label:"Last Name",required:!0},username:{value:F(e.user,"username",""),label:"Username",required:!0,disabled:!D(e.user),validation:async e=>`${e.value}`.length<4?["Username must be at least 4 characters long"]:null},password:{value:"",label:"Password",required:D(e.user),validation:async({value:e})=>e&&`${e}`.length<6?["Password must be at least 6 characters long"]:null},confirmPassword:{value:"",label:"Confirm Password",required:D(e.user),validation:async({value:e},a)=>e&&e!==a.password.value?["Passwords not matching"]:null},roles:{value:(null===(a=e.user)||void 0===a||null===(a=a.roles)||void 0===a?void 0:a.map((e=>({label:e.role,value:e.role,other:e}))))||[],label:"Roles",placeholder:"Select Roles",required:!0}});return y((()=>{n.getAllRoles().then((e=>{const a=Array.isArray(e.data)?e.data:[];l.value=null==a?void 0:a.map((e=>({value:e.role,label:e.role,other:e})))}))})),{form:t,close:_,modal:C,roles:l,title:o,submit:async()=>{if(!(await P(t)))return;const{formData:a}=k(t,!0);let l={...a,roles:a.roles.map((e=>e.label))};try{l=D(e.user)?await n.createUser(l):await n.updateUser(e.user.user_id,l),C.hide(l)}catch(o){if(o instanceof z)return t.username.error="Username already exists";R(JSON.stringify(o),2e3)}}}}}),E=O(a,[["render",function(e,a,l,n,o,t){const r=w("IonIcon"),s=w("IonButton"),i=w("IonButtons"),u=w("IonTitle"),c=w("IonToolbar"),d=w("IonHeader"),m=w("text-input"),p=w("ion-col"),v=w("TextInput"),f=w("SelectInput"),g=w("ion-row"),y=w("ion-grid"),_=w("IonContent"),x=w("IonFooter"),S=w("IonPage");return h(),b(S,null,{default:I((()=>[U(d,null,{default:I((()=>[U(c,null,{default:I((()=>[U(i,{slot:"end"},{default:I((()=>[U(s,{slot:"end",onClick:a[0]||(a[0]=a=>e.modal.hide()),"icon-only":""},{default:I((()=>[U(r,{icon:e.close},null,8,["icon"])])),_:1})])),_:1}),U(u,null,{default:I((()=>[j(V(e.title),1)])),_:1})])),_:1})])),_:1}),U(_,null,{default:I((()=>[U(y,null,{default:I((()=>[U(g,null,{default:I((()=>[U(p,{size:"12",class:"ion-margin-vertical"},{default:I((()=>[U(m,{modelValue:e.form.username,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.username=a)},null,8,["modelValue"])])),_:1}),U(p,{size:"6",class:"ion-margin-vertical"},{default:I((()=>[U(v,{modelValue:e.form.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.password=a),password:""},null,8,["modelValue"])])),_:1}),U(p,{size:"6",class:"ion-margin-vertical"},{default:I((()=>[U(v,{modelValue:e.form.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.confirmPassword=a),form:e.form,password:""},null,8,["modelValue","form"])])),_:1}),U(p,{size:"12",class:"ion-margin-vertical"},{default:I((()=>[U(f,{modelValue:e.form.roles,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.roles=a),options:e.roles,multiple:""},null,8,["modelValue","options"])])),_:1}),U(p,{size:"12",class:"ion-margin-vertical"},{default:I((()=>[U(v,{modelValue:e.form.givenName,"onUpdate:modelValue":a[5]||(a[5]=a=>e.form.givenName=a)},null,8,["modelValue"])])),_:1}),U(p,{size:"12",class:"ion-margin-vertical"},{default:I((()=>[U(v,{modelValue:e.form.familyName,"onUpdate:modelValue":a[6]||(a[6]=a=>e.form.familyName=a)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})])),_:1}),U(x,null,{default:I((()=>[U(s,{class:"ion-margin-end ion-margin-vertical ion-float-right",onClick:e.submit},{default:I((()=>[j("Save")])),_:1},8,["onClick"]),U(s,{class:"ion-margin-vertical ion-float-right",color:"light",onClick:a[7]||(a[7]=a=>e.modal.hide())},{default:I((()=>[j("Close")])),_:1})])),_:1})])),_:1})}]]),L=o({name:"Users",components:{BaseReportTable:l},setup(){const e=v([]),a=[{path:"username",label:"Username",initialSort:!0,initialSortOrder:"asc"},{path:"given_name",label:"First name"},{path:"family_name",label:"Last name"},{path:"role",label:"Roles"},{path:"deactivated_on",label:"Deactivated On",formatter:$.toStandardHisDisplayFormat}],l=e=>{try{return{given_name:F(e,"person.names[0].given_name","Unknown"),family_name:F(e,"person.names[0].family_name","Unknown"),role:e.roles.map((e=>e.role)).join(", "),...e}}catch(a){return console.error("Error occurred while processing user details:",a),null}},o=[{icon:x,action:async e=>{const a=await C.show(E,{user:e});D(a)||Object.assign(e,l(a.data))}},{color:"danger",icon:S,condition:e=>null===e.deactivated_on,action:async e=>{if(await A("Are you sure you want to deactivate this user?"))try{const{user:a}=await(await n.deactivateUser(e.user_id)).data;e.deactivated_on=a.deactivated_on,q("User deactivated")}catch(a){R(`Deactivation Failed: ${a}`)}}},{color:"warning",icon:B,condition:e=>null!==e.deactivated_on,action:async e=>{try{await n.activateUser(e.user_id),e.deactivated_on=null}catch(a){R(`Activation Failed: ${a}`)}}}],t=[{label:"Add New User",action:async()=>{const a=await C.show(E);D(null==a?void 0:a.user)||e.value.push(l(a.user))}}];return y((async()=>{const a=(await n.getAllUsers({paginate:!1})).data,o=await n.getCurrentUser();e.value=a.filter((e=>e.person_id!==(null==o?void 0:o.person_id))).map((e=>l(e)))})),{rows:e,columns:a,rowActionBtns:o,actionBtns:t}}});e("default",O(L,[["render",function(e,a,l,n,o,t){const r=w("base-report-table");return h(),b(r,{title:"Users","report-icon":"patient-type.png",columns:e.columns,rows:e.rows,rowActionButtons:e.rowActionBtns,"action-buttons":e.actionBtns,canExportCsv:!1,canExportPDF:!1,showRefreshButton:!1},null,8,["columns","rows","rowActionButtons","action-buttons"])}]]))}}}));
