import{l as r}from"./loader-09fe7d6a.js";import{_ as I}from"./ReportTable.vue_vue_type_style_index_0_lang-516be738.js";import{t as s,a as P}from"./toasts-efd70885.js";import{P as B}from"./patient_identifier_service-7790a48c.js";import{d as F,r as n,f as S,h as T,i as $,j as N,aj as k,ak as C,o as G}from"./index-0dab41e9.js";import{D as R}from"./DrilldownTable-f8933899.js";import{P as V}from"./patient_service-fa642ea3.js";import{t as j}from"./Strs-7ee8a435.js";import{t as x}from"./his_date-1be895e6.js";import{d as z}from"./dde-47b46880.js";import"./exports-e1928467.js";import"./index-5faacd6b.js";import"./vue-datepicker-b770edc0.js";import"./common-abc2f84d.js";import"./arrays-31d2d38b.js";import"./Date-d6cf1fc2.js";const ae=F({__name:"ViewDuplicates",setup(A){const p=n([]),u=S(),i=n(),l=new B,d=n([]),w=[{path:"identifier",label:"Identifier"},{path:"count",label:"Count"}],y=T(()=>[{id:"identifier",label:"Select Identifier type",type:"select",gridSize:5,options:d.value}]),b=[{label:"View Patients",action:e=>{var f,h,v,_;const t=n([]),c="Patients with ".concat((f=i.value)==null?void 0:f.label,": ").concat(e.identifier),D=[{path:"person.names[0].given_name",label:"First Name"},{path:"person.names[0].family_name",label:"Last Name"},{path:"person.gender",label:"Gender",formatter:j},{path:"person.birthdate",label:"Date of Birth",formatter:x}],m=[{label:"View",action:a=>u.push("/patients/".concat(a.patient_id))}];return((h=i.value)==null?void 0:h.value)===k&&z.value&&m.push({label:"Re-assign",action:async a=>{try{return await l.reassignNPID(a.patient_id),P("Identifier re-assigned successfully"),u.push("/patients/".concat(a.patient_id))}catch(o){console.error(o),s("Failed to re-assign identifier")}}}),r.show(),V.findByOtherID((_=(v=i.value)==null?void 0:v.value)!=null?_:-1,e.identifier).then(a=>{var o;r.hide(),t.value.push(...(o=a.data)!=null?o:[])}).catch(a=>{s("Failed to load patients"),console.error(a)}),C.show(R,{title:c,columns:D,rows:t.value,rowActionButtons:m})}}];async function g({identifier:e}){var t;try{r.show(),i.value=e,p.value=(t=await l.getDuplicateIndentifiers(e.value))!=null?t:[]}catch(c){s("Failed to load report data"),console.error(c)}finally{r.hide()}}return $(async()=>{try{const e=await l.getIdentifierTypes();d.value=e.map(t=>({label:t.name,value:t.patient_identifier_type_id,other:t}))}catch(e){console.error(e),s("Failed to load identifier types")}}),(e,t)=>(G(),N(I,{title:"Duplicates Identifiers",columns:w,rows:p.value,"custom-filters":y.value,"row-action-buttons":b,onGenerate:g},null,8,["rows","custom-filters"]))}});export{ae as default};
