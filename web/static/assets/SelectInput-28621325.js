import{d as Q,J as R,z as W,aq as X,v as Y,ar as Z,U as _,d4 as x,s as ee,r as m,H as A,a6 as D,a2 as le,al as oe,O as ne,d5 as ae,aK as te,d6 as se,L as f,c as b,h as y,w as k,y as C,ag as z,f as E,K as q,N as F,a as w,o as u,t as S,b as L}from"./index-4d483828.js";import{i as I}from"./common-abc2f84d.js";import{_ as ue}from"./_plugin-vue_export-helper-c27b6911.js";const ie=Q({name:"SelectInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},allowCustom:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},infiniteScrolling:{type:Boolean,default:!1}},components:{IonLabel:R,IonInput:W,IonNote:X,IonIcon:Y,IonCheckbox:Z,IonList:_,IonChip:x,IonItem:ee},emits:["update:modelValue"],setup(e,{emit:t}){const K=m(!1),B=m(""),d=m(),c=m(!1),v=m(),i=m(""),a=m([]),g=m(1),r=A(()=>e.multiple?a.value.filter(({isChecked:l})=>l):d.value?[d.value]:[]),$=A(()=>!i.value&&I(r.value)&&!c.value),o=A({get:()=>e.modelValue,set:l=>t("update:modelValue",l)}),U=()=>{i.value="",d.value=void 0,a.value.forEach(l=>l.isChecked=!1)},n=()=>{if(U(),I(o.value.value))return;if(Array.isArray(o.value.value)&&e.multiple)return o.value.value.forEach(s=>{const V=a.value.findIndex(({value:N})=>N===s.value);V===-1?a.value.push({...s,isChecked:!0}):a.value[V].isChecked=!0});const l=a.value.find(s=>s.value===o.value.value);l?d.value=l:d.value={label:o.value.value,value:o.value.value}},p=async()=>{const l=typeof e.asyncOptions=="function"?await e.asyncOptions(i.value):e.options.filter(({label:s})=>s.toLowerCase().includes(i.value.toLowerCase()));r.value.forEach(s=>{const V=l.findIndex(N=>N.value===s.value);V===-1?l.push(s):l[V].isChecked=!0}),a.value=l.filter(({label:s})=>!!s)},O=async()=>{if(o.value.required&&I(o.value.value))return o.value.error="This field is required";if(o.value.validation){const l=await o.value.validation({label:o.value.value,value:o.value.value},e.form);if(l&&l.length)return o.value.error+=l.toString()}return o.value.error=""},h=()=>{c.value=!1,o.value.value=e.multiple?r.value:I(r.value)?void 0:r.value[0],i.value="",O()},H=()=>{o.value.disabled||(c.value=!0,o.value.error="")},j=()=>{o.value.value={label:B.value,value:B.value}},P=l=>{e.multiple||(d.value=l,h()),o.value.value=e.multiple?r.value:I(r.value)?void 0:r.value[0],i.value=""},T=l=>e.multiple?l.isChecked=!1:d.value=void 0,J=l=>{l.preventDefault();const s=a.value.indexOf(v.value)+1;v.value=a.value[s]||a.value[0]},M=l=>{l.preventDefault();const s=a.value.indexOf(v.value)-1;v.value=a.value[s]||a.value[a.value.length-1]},G=l=>{switch(c.value||(c.value=!0),l.key){case"ArrowDown":J(l);break;case"ArrowUp":M(l);break;case"Enter":P(v.value);break;case"Escape":h();break}};return D(i,async()=>{g.value++,await p()}),D([()=>e.options,()=>e.asyncOptions],async()=>p()),D(()=>e.modelValue.value,l=>I(l)&&n(),{deep:!0,immediate:!0}),D(c,l=>l&&(v.value=d.value||a.value[0])),le(async()=>{await p(),n(),addEventListener("click",l=>{!l.target.closest(".inner-input-box")&&c.value&&h()})}),oe(()=>removeEventListener("click",l=>console.log(l))),{validate:O,onSelect:P,resetHandler:U,onShowOptions:H,onCloseOptions:h,diselect:T,onCustomValue:j,handleKeyDown:G,model:o,customOption:B,isCustom:K,chevronDown:ne,chevronUp:ae,close:te,closeCircle:se,selectedOption:d,showOptions:c,focusedOption:v,showPlaceholder:$,filteredOptions:a,filter:i,tags:r}}});const re={key:0,class:"text-danger"},de={key:1,class:"ion-float-right ion-margin-end checkbox-label"},ve={class:"inner-input-box"},ce={key:0,class:"input-options"},pe={class:"input-icon"};function me(e,t,K,B,d,c){const v=f("ion-checkbox"),i=f("ion-label"),a=f("ion-input"),g=f("ion-icon"),r=f("ion-chip"),$=f("ion-item"),o=f("ion-list"),U=f("ion-note");return u(),b(q,null,[e.model.label?(u(),y(i,{key:0,class:"ion-padding-bottom bold"},{default:k(()=>[E("span",null,S(e.model.label),1),e.model.required?(u(),b("span",re," *")):C("",!0),e.allowCustom?(u(),b("span",de,[L(" Add Custom "+S(e.model.label)+"? ",1),w(v,{modelValue:e.isCustom,"onUpdate:modelValue":t[0]||(t[0]=n=>e.isCustom=n),onIonChange:t[1]||(t[1]=n=>e.model.value="")},null,8,["modelValue"])])):C("",!0)]),_:1})):C("",!0),e.isCustom?(u(),y(a,{key:1,class:z(["box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}]),modelValue:e.customOption,"onUpdate:modelValue":t[2]||(t[2]=n=>e.customOption=n),placeholder:e.model.placeholder||e.model.label,disabled:e.model.disabled,onIonFocus:t[3]||(t[3]=()=>e.model.error=""),onIonBlur:e.validate,onIonInput:e.onCustomValue},null,8,["class","modelValue","placeholder","disabled","onIonBlur","onIonInput"])):(u(),b("div",{key:2,class:z(["outer-input-box box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}])},[E("div",ve,[E("div",{style:{display:"flex","flex-wrap":"wrap",width:"100%"},onClick:t[6]||(t[6]=(...n)=>e.onShowOptions&&e.onShowOptions(...n))},[(u(!0),b(q,null,F(e.tags,(n,p)=>(u(),y(r,{key:p},{default:k(()=>[w(i,null,{default:k(()=>[L(S(n.label),1)]),_:2},1024),w(g,{icon:e.closeCircle,color:"danger",onClick:O=>e.diselect(n),style:{"z-index":"20"}},null,8,["icon","onClick"])]),_:2},1024))),128)),w(a,{disabled:e.model.disabled,placeholder:e.showPlaceholder?e.model.placeholder||"select option":"",modelValue:e.filter,"onUpdate:modelValue":t[4]||(t[4]=n=>e.filter=n),class:"search-input",ref:"searchInput",onKeydown:t[5]||(t[5]=n=>e.handleKeyDown(n))},null,8,["disabled","placeholder","modelValue"])]),e.showOptions?(u(),b("div",ce,[w(o,null,{default:k(()=>[(u(!0),b(q,null,F(e.filteredOptions,(n,p)=>{var O;return u(),y($,{key:p,lines:p+1===e.filteredOptions.length?"none":void 0,color:n.value===((O=e.focusedOption)==null?void 0:O.value)?"light":"",onClick:h=>e.onSelect(n)},{default:k(()=>[e.multiple?(u(),y(v,{key:0,class:"input-option-checkbox",slot:"start",modelValue:n.isChecked,"onUpdate:modelValue":h=>n.isChecked=h},null,8,["modelValue","onUpdate:modelValue"])):C("",!0),w(i,null,{default:k(()=>[L(S(n.label),1)]),_:2},1024)]),_:2},1032,["lines","color","onClick"])}),128))]),_:1})])):C("",!0),E("div",pe,[e.filter||e.tags.length>0?(u(),y(g,{key:0,icon:e.close,onClick:e.resetHandler},null,8,["icon","onClick"])):C("",!0),w(g,{icon:e.showOptions?e.chevronUp:e.chevronDown,onClick:t[7]||(t[7]=n=>e.showOptions?e.onCloseOptions():e.onShowOptions())},null,8,["icon"])])])],2)),e.model.error?(u(),y(U,{key:3,color:"danger"},{default:k(()=>[L(S(e.model.error),1)]),_:1})):C("",!0)],64)}const ye=ue(ie,[["render",me],["__scopeId","data-v-5d0bac9f"]]);export{ye as S};
