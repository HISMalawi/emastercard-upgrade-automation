import{l as r}from"./loader-053b81cd.js";import{_ as I}from"./ReportTable.vue_vue_type_style_index_0_lang-b9f63f5e.js";import{t as s,a as P}from"./toasts-be8db332.js";import{P as B}from"./patient_identifier_service-8163ea6d.js";import{d as F,r as n,g as S,i as T,j as $,k as N,al as k,am as C,o as G}from"./index-95a528fa.js";import{D as R}from"./DrilldownTable-779772ea.js";import{P as V}from"./patient_service-09f5142e.js";import{t as x}from"./Strs-0c962638.js";import{t as j}from"./his_date-34d66586.js";import{d as z}from"./dde-012608fa.js";import"./exports-adccf1ce.js";import"./index-b6ce75d6.js";import"./vue-datepicker-4bce48f6.js";import"./common-abc2f84d.js";import"./arrays-1b521787.js";import"./datatable-a44c2943.js";import"./Date-a98c3a89.js";const ie=F({__name:"ViewDuplicates",setup(A){const p=n([]),m=S(),i=n(),l=new B,u=n([]),w=[{path:"identifier",label:"Identifier"},{path:"count",label:"Count"}],y=T(()=>[{id:"identifier",label:"Select Identifier type",type:"select",gridSize:5,options:u.value}]),b=[{label:"View Patients",action:e=>{var f,h,v,_;const t=n([]),c="Patients with ".concat((f=i.value)==null?void 0:f.label,": ").concat(e.identifier),D=[{path:"person.names[0].given_name",label:"First Name"},{path:"person.names[0].family_name",label:"Last Name"},{path:"person.gender",label:"Gender",formatter:x},{path:"person.birthdate",label:"Date of Birth",formatter:j}],d=[{label:"View",action:a=>m.push("/patients/".concat(a.patient_id))}];return((h=i.value)==null?void 0:h.value)===k&&z.value&&d.push({label:"Re-assign",action:async a=>{try{return await l.reassignNPID(a.patient_id),P("Identifier re-assigned successfully"),m.push("/patients/".concat(a.patient_id))}catch(o){console.error(o),s("Failed to re-assign identifier")}}}),r.show(),V.findByOtherID((_=(v=i.value)==null?void 0:v.value)!=null?_:-1,e.identifier).then(a=>{var o;r.hide(),t.value.push(...(o=a.data)!=null?o:[])}).catch(a=>{s("Failed to load patients"),console.error(a)}),C.show(R,{title:c,columns:D,rows:t.value,rowActionButtons:d})}}];async function g({identifier:e}){var t;try{r.show(),i.value=e,p.value=(t=await l.getDuplicateIndentifiers(e.value))!=null?t:[]}catch(c){s("Failed to load report data"),console.error(c)}finally{r.hide()}}return $(async()=>{try{const e=await l.getIdentifierTypes();u.value=e.map(t=>({label:t.name,value:t.patient_identifier_type_id,other:t}))}catch(e){console.error(e),s("Failed to load identifier types")}}),(e,t)=>(G(),N(I,{title:"Duplicates Identifiers",columns:w,rows:p.value,"custom-filters":y.value,"row-action-buttons":b,onGenerate:g},null,8,["rows","custom-filters"]))}});export{ie as default};
