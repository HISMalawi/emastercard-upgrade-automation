import{d as F,r as y,f as R,g as T,h as B,i as E,j as M,w as s,u as e,o as w,e as a,k as z,l as N,m as v,n as S,b as r,p as q,t as p,a as l,q as D,s as K,v as f,I as C,x as U,y as G,c as L,z as j,A as P,B as x,C as H,D as W,E as J,F as O,G as Q,H as X,_ as Y}from"./index-2c23db35.js";import{r as g}from"./image-cb93bc3e.js";import{t as _}from"./toasts-5b35ce85.js";import{u as Z}from"./PasswordUpdate-175fad36.js";import"./TextInput-0719638e.js";import"./his_date-e2411856.js";import"./form-82430209.js";import"./Strs-7ee8a435.js";import"./common-abc2f84d.js";import"./loader-792d5ee5.js";const $=["src"],ee=["src"],oe=["src"],ae={key:0},se=F({__name:"login",setup(te){const n=y(""),t=y(""),I=R(),i=Z(),{fullVersion:k}=O(),{facility:u,loadFacilityCode:V}=Q(),{initiateIdleTimer:h,stopIdleTimer:A}=T(),b=B(()=>I.currentRoute.value.redirectedFrom);E(A);const d=async()=>{var m;try{if(!n.value||!t.value)return _("Invalid login details");const o=await X.login(n.value,t.value);o.ok?(i.setCurrentPassword(t.value),await i.canChangePassword()&&await i.changePasswaord(),V(),h(),I.push((m=b.value)!=null?m:"/")):_(o.errorMessage)}catch(o){_("An error occurred while logging in"),console.error(o)}};return(m,o)=>(w(),M(e(J),null,{default:s(()=>[a(e(W),null,{default:s(()=>[a(e(z),{style:{margin:"0",padding:"0"}},{default:s(()=>[a(e(N),null,{default:s(()=>[a(e(v),{size:"8"},{default:s(()=>[a(e(S),{class:"title"},{default:s(()=>o[2]||(o[2]=[r("E-MASTERCARD APP")])),_:1}),a(e(q),{class:"sub-title"},{default:s(()=>[r(p(e(k)),1)]),_:1}),l("img",{src:e(g)("report.png"),class:"hero-image"},null,8,$),a(e(D),{class:"footer-section"},{default:s(()=>[a(e(K),null,{default:s(()=>[l("span",null,[l("img",{id:"coat",src:e(g)("login-logos/Malawi-Coat_of_arms_of_arms.png"),alt:"Malawi Coat of Arms logo",class:"brand-logo-moh"},null,8,ee),l("img",{id:"pepfar",src:e(g)("login-logos/PEPFAR.png"),alt:"PEPFAR logo",class:"brand-logo-pepfar"},null,8,oe)]),a(e(f),{class:"his-sm-text",slot:"end",lines:"none"},{default:s(()=>[a(e(C),{color:"dark",fill:"outline",size:"large",slot:"end","router-link":"/settings/network"},{default:s(()=>o[3]||(o[3]=[r(" Network ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(e(v),{size:"4",class:"form-section"},{default:s(()=>[a(e(U),{icon:e(G),class:"avatar"},null,8,["icon"]),e(u).name?(w(),L("h3",ae,p(e(u).name)+" ("+p(e(u).district)+")",1)):j("",!0),o[5]||(o[5]=l("h4",null,"Please, log into your account",-1)),a(e(f),{style:{margin:"2rem 3.5rem"}},{default:s(()=>[a(e(P),{type:"text",placeholder:"Username",modelValue:n.value,"onUpdate:modelValue":o[0]||(o[0]=c=>n.value=c),onKeyup:x(d,["enter"]),min:5,required:""},null,8,["modelValue"])]),_:1}),a(e(f),{style:{margin:"2rem 3.5rem"}},{default:s(()=>[a(e(P),{type:"password",modelValue:t.value,"onUpdate:modelValue":o[1]||(o[1]=c=>t.value=c),placeholder:"Password",onKeyup:x(d,["enter"]),max:100,min:5,required:""},null,8,["modelValue"])]),_:1}),a(e(C),{expand:"full",size:"large",style:{margin:"2rem 3.5rem","text-transform":"none"},onClick:H(d,["prevent"])},{default:s(()=>o[4]||(o[4]=[r(" Login ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))}});const ge=Y(se,[["__scopeId","data-v-aa0738be"]]);export{ge as default};
