import{l as m}from"./loader-f6c5d99b.js";import{_ as y}from"./ReportTable.vue_vue_type_style_index_0_lang-d222f57e.js";import{t as o}from"./toasts-3b992a75.js";import{P as w}from"./patient_identifier_service-0ada0a51.js";import{t as g}from"./Strs-0c962638.js";import{t as c}from"./his_date-57c4722b.js";import{D as I}from"./DrilldownTable-ca99c4e6.js";import{d as D,r as a,h as B,i as F,j as M,al as p,am as N,o as S}from"./index-984efe82.js";import{p as T}from"./VoidReason-2a3439f1.js";import"./exports-a314af3c.js";import"./index-187b0cc1.js";import"./vue-datepicker-87699c28.js";import"./common-abc2f84d.js";import"./arrays-1b521787.js";import"./datatable-1b442ab9.js";const H=D({__name:"MultipleIdentifiers",setup(k){const l=a([]),n=a(),i=new w,s=a([]),f=[{path:"given_name",label:"First Name"},{path:"family_name",label:"Last Name"},{path:"gender",label:"Gender",formatter:g},{path:"birthdate",label:"Date of Birth",formatter:c},{path:"latest_identifier",label:"Latest Identifier"},{path:"identifiers",label:"Number of Identifiers",drillable:!0}],u=[{path:"identifier",label:"Identifier"},{path:"date_created",label:"Date created",formatter:c}],h=B(()=>[{id:"identifier",label:"Select Identifier type",type:"select",gridSize:5,options:s.value}]);async function _(e){return p.show(I,{title:"Identifiers belonging to client: ".concat(e.row.given_name," ").concat(e.row.family_name),columns:u,rows:e.row.identifiers,rowActionButtons:[{label:"void",color:"danger",icon:N,action:t=>T(async r=>{var d;try{await i.voidMultipleIdentifiers([t.identifier],r,Number((d=n.value)==null?void 0:d.value)),p.hide()}catch(v){o("Failed to void identifier"),console.error(v)}},"void-modal custom-modal-backdrop")}]})}async function b({identifier:e}){var t;try{m.show(),n.value=e,l.value=(t=await i.getMultipleIdentifiers(e.value))!=null?t:[]}catch(r){o("Failed to load report data"),console.error(r)}finally{m.hide()}}return F(async()=>{try{const e=await i.getIdentifierTypes();s.value=e.map(t=>({label:t.name,value:t.patient_identifier_type_id,other:t}))}catch(e){console.error(e),o("Failed to load identifier types")}}),(e,t)=>(S(),M(y,{title:"Multiple Identifiers",columns:f,rows:l.value,"custom-filters":h.value,"custom-drill-handler":_,onGenerate:b},null,8,["rows","custom-filters"]))}});export{H as default};
