import{d as Y,M as Z,B as _,az as x,y as ee,aA as oe,X as le,aj as ne,x as ae,i as H,a9 as U,j as te,au as ue,R as ie,bB as se,aE as re,bA as de,J as c,_ as ce,O as m,c as b,k as h,w as y,A as k,ao as R,a as $,N as j,Q as F,e as C,o as u,t as S,b as L}from"./index-8a11c015.js";import{i as V}from"./common-abc2f84d.js";const ve=Y({name:"SelectInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},options:{type:Array,default:()=>[]},asyncOptions:{type:Function,required:!1},allowCustom:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},infiniteScrolling:{type:Boolean,default:!1},dropDirection:{type:String,default:"auto",validator:e=>["auto","up","top","down","bottom"].includes(e)}},components:{IonLabel:Z,IonInput:_,IonNote:x,IonIcon:ee,IonCheckbox:oe,IonList:le,IonChip:ne,IonItem:ae},emits:["update:modelValue"],setup(e,{emit:a}){const q=c(!1),A=c(""),r=c(),v=c(!1),d=c(),i=c(""),n=c([]),D=c(1),p=c("down"),B=c(),s=H(()=>e.multiple?n.value.filter(({isChecked:l})=>l):r.value?[r.value]:[]),N=H(()=>!i.value&&V(s.value)&&!v.value),o=H({get:()=>e.modelValue,set:l=>a("update:modelValue",l)}),f=()=>{i.value="",r.value=void 0,n.value.forEach(l=>l.isChecked=!1)},g=()=>{if(f(),V(o.value.value))return;if(Array.isArray(o.value.value)&&e.multiple)return o.value.value.forEach(t=>{const w=n.value.findIndex(({value:I})=>I===t.value);w===-1?n.value.push({...t,isChecked:!0}):n.value[w].isChecked=!0});const l=n.value.find(t=>t.value===o.value.value);l?r.value=l:r.value={label:o.value.value,value:o.value.value}},O=async()=>{const l=typeof e.asyncOptions=="function"?await e.asyncOptions(i.value):e.options.filter(({label:t})=>t.toLowerCase().includes(i.value.toLowerCase()));s.value.forEach(t=>{const w=l.findIndex(I=>I.value===t.value);w===-1?l.push(t):l[w].isChecked=!0}),n.value=l.filter(({label:t})=>!!t)},P=async()=>{if(o.value.required&&V(o.value.value))return o.value.error="This field is required";if(o.value.validation){const l=await o.value.validation({label:o.value.value,value:o.value.value},e.form);if(l&&l.length)return o.value.error+=l.toString()}return o.value.error=""},E=()=>{v.value=!1,o.value.value=e.multiple?s.value:V(s.value)?void 0:s.value[0],i.value="",P()},K=()=>{if(e.dropDirection==="up"||e.dropDirection==="top"){p.value="up";return}else if(e.dropDirection==="down"||e.dropDirection==="bottom"){p.value="down";return}if(B.value){const l=B.value.getBoundingClientRect(),t=window.innerHeight,w=l.top,I=t-l.bottom,W=Math.min(n.value.length*44,300);I<W&&w>I?p.value="up":p.value="down"}},M=()=>{o.value.disabled||(v.value=!0,o.value.error="",K(),console.log("Dropdown direction:",e.dropDirection,"â†’",p.value))},T=()=>{o.value.value={label:A.value,value:A.value}},z=l=>{e.multiple||(r.value=l,E()),o.value.value=e.multiple?s.value:V(s.value)?void 0:s.value[0],i.value=""},J=l=>e.multiple?l.isChecked=!1:r.value=void 0,Q=l=>{l.preventDefault();const t=n.value.indexOf(d.value)+1;d.value=n.value[t]||n.value[0]},X=l=>{l.preventDefault();const t=n.value.indexOf(d.value)-1;d.value=n.value[t]||n.value[n.value.length-1]},G=l=>{switch(v.value||(v.value=!0),l.key){case"ArrowDown":Q(l);break;case"ArrowUp":X(l);break;case"Enter":z(d.value);break;case"Escape":E();break}};return U(i,async()=>{D.value++,await O()}),U([()=>e.options,()=>e.asyncOptions],async()=>O()),U(()=>e.modelValue.value,l=>V(l)&&g(),{deep:!0,immediate:!0}),U(v,l=>l&&(d.value=r.value||n.value[0])),te(async()=>{await O(),g(),addEventListener("click",l=>{!l.target.closest(".inner-input-box")&&v.value&&E()})}),ue(()=>removeEventListener("click",l=>console.log(l))),{validate:P,onSelect:z,resetHandler:f,onShowOptions:M,onCloseOptions:E,diselect:J,onCustomValue:T,handleKeyDown:G,model:o,customOption:A,isCustom:q,chevronDown:ie,chevronUp:se,close:re,closeCircle:de,selectedOption:r,showOptions:v,focusedOption:d,showPlaceholder:N,filteredOptions:n,filter:i,tags:s,dropdownDirection:p,inputRef:B}}});const pe={key:0,class:"text-danger"},me={key:1,class:"ion-float-right ion-margin-end checkbox-label"},fe={class:"inner-input-box",ref:"inputRef"},we={class:"input-icon"};function be(e,a,q,A,r,v){const d=m("ion-checkbox"),i=m("ion-label"),n=m("ion-input"),D=m("ion-icon"),p=m("ion-chip"),B=m("ion-item"),s=m("ion-list"),N=m("ion-note");return u(),b(j,null,[e.model.label?(u(),h(i,{key:0,class:"ion-padding-bottom bold"},{default:y(()=>[$("span",null,S(e.model.label),1),e.model.required?(u(),b("span",pe," *")):k("",!0),e.allowCustom?(u(),b("span",me,[L(" Add Custom "+S(e.model.label)+"? ",1),C(d,{modelValue:e.isCustom,"onUpdate:modelValue":a[0]||(a[0]=o=>e.isCustom=o),onIonChange:a[1]||(a[1]=o=>e.model.value="")},null,8,["modelValue"])])):k("",!0)]),_:1})):k("",!0),e.isCustom?(u(),h(n,{key:1,class:R(["box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}]),modelValue:e.customOption,"onUpdate:modelValue":a[2]||(a[2]=o=>e.customOption=o),placeholder:e.model.placeholder||e.model.label,disabled:e.model.disabled,onIonFocus:a[3]||(a[3]=()=>e.model.error=""),onIonBlur:e.validate,onIonInput:e.onCustomValue},null,8,["class","modelValue","placeholder","disabled","onIonBlur","onIonInput"])):(u(),b("div",{key:2,class:R(["outer-input-box box-input",{"box-input-error":e.model.error,"ion-margin-top":e.model.label}])},[$("div",fe,[$("div",{style:{display:"flex","flex-wrap":"wrap",width:"100%"},onClick:a[6]||(a[6]=(...o)=>e.onShowOptions&&e.onShowOptions(...o))},[(u(!0),b(j,null,F(e.tags,(o,f)=>(u(),h(p,{key:f},{default:y(()=>[C(i,null,{default:y(()=>[L(S(o.label),1)]),_:2},1024),C(D,{icon:e.closeCircle,color:"danger",onClick:g=>e.diselect(o),style:{"z-index":"20"}},null,8,["icon","onClick"])]),_:2},1024))),128)),C(n,{disabled:e.model.disabled,placeholder:e.showPlaceholder?e.model.placeholder||"select option":"",modelValue:e.filter,"onUpdate:modelValue":a[4]||(a[4]=o=>e.filter=o),class:"search-input",ref:"searchInput",onKeydown:a[5]||(a[5]=o=>e.handleKeyDown(o))},null,8,["disabled","placeholder","modelValue"])]),e.showOptions?(u(),b("div",{key:0,class:R(["input-options",{"dropdown-up":e.dropdownDirection==="up","dropdown-down":e.dropdownDirection==="down"}])},[C(s,null,{default:y(()=>[(u(!0),b(j,null,F(e.filteredOptions,(o,f)=>{var g;return u(),h(B,{key:f,lines:f+1===e.filteredOptions.length?"none":void 0,color:o.value===((g=e.focusedOption)==null?void 0:g.value)?"light":"",onClick:O=>e.onSelect(o)},{default:y(()=>[e.multiple?(u(),h(d,{key:0,class:"input-option-checkbox",slot:"start",modelValue:o.isChecked,"onUpdate:modelValue":O=>o.isChecked=O},null,8,["modelValue","onUpdate:modelValue"])):k("",!0),C(i,null,{default:y(()=>[L(S(o.label),1)]),_:2},1024)]),_:2},1032,["lines","color","onClick"])}),128))]),_:1})],2)):k("",!0),$("div",we,[e.filter||e.tags.length>0?(u(),h(D,{key:0,icon:e.close,onClick:e.resetHandler},null,8,["icon","onClick"])):k("",!0),C(D,{icon:e.showOptions?e.chevronUp:e.chevronDown,onClick:a[7]||(a[7]=o=>e.showOptions?e.onCloseOptions():e.onShowOptions())},null,8,["icon"])])],512)],2)),e.model.error?(u(),h(N,{key:3,color:"danger"},{default:y(()=>[L(S(e.model.error),1)]),_:1})):k("",!0)],64)}const ke=ce(ve,[["render",be],["__scopeId","data-v-330c6b2f"]]);export{ke as S};
