import{l as m}from"./loader-8159f1a1.js";import{_ as y}from"./ReportTable.vue_vue_type_style_index_0_lang-c142f92c.js";import{t as o}from"./toasts-6e9d0182.js";import{P as w}from"./patient_identifier_service-b0ae9293.js";import{t as g}from"./Strs-0c962638.js";import{t as c}from"./his_date-b0a0907c.js";import{D as I}from"./DrilldownTable-bbc276fc.js";import{d as D,i as B,j as F,k as M,J as a,am as p,an as k,o as N}from"./index-229c1236.js";import{p as S}from"./VoidReason-69460b22.js";import"./exports-f71f2146.js";import"./index-9f8e2b10.js";import"./vue-datepicker-956f19a2.js";import"./common-abc2f84d.js";import"./arrays-1b521787.js";import"./datatable-84d9c34c.js";const E=D({__name:"MultipleIdentifiers",setup(T){const n=a([]),l=a(),i=new w,s=a([]),f=[{path:"given_name",label:"First Name"},{path:"family_name",label:"Last Name"},{path:"gender",label:"Gender",formatter:g},{path:"birthdate",label:"Date of Birth",formatter:c},{path:"latest_identifier",label:"Latest Identifier"},{path:"identifiers",label:"Number of Identifiers",drillable:!0}],u=[{path:"identifier",label:"Identifier"},{path:"date_created",label:"Date created",formatter:c}],h=B(()=>[{id:"identifier",label:"Select Identifier type",type:"select",gridSize:5,options:s.value}]);async function _(e){return p.show(I,{title:"Identifiers belonging to client: ".concat(e.row.given_name," ").concat(e.row.family_name),columns:u,rows:e.row.identifiers,rowActionButtons:[{label:"void",color:"danger",icon:k,action:t=>S(async r=>{var d;try{await i.voidMultipleIdentifiers([t.identifier],r,Number((d=l.value)==null?void 0:d.value)),p.hide()}catch(v){o("Failed to void identifier"),console.error(v)}},"void-modal custom-modal-backdrop")}]})}async function b({identifier:e}){var t;try{m.show(),l.value=e,n.value=(t=await i.getMultipleIdentifiers(e.value))!=null?t:[]}catch(r){o("Failed to load report data"),console.error(r)}finally{m.hide()}}return F(async()=>{try{const e=await i.getIdentifierTypes();s.value=e.map(t=>({label:t.name,value:t.patient_identifier_type_id,other:t}))}catch(e){console.error(e),o("Failed to load identifier types")}}),(e,t)=>(N(),M(y,{title:"Multiple Identifiers",columns:f,rows:n.value,"custom-filters":h.value,"custom-drill-handler":_,onGenerate:b},null,8,["rows","custom-filters"]))}});export{E as default};
