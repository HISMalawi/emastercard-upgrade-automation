System.register(["./index-legacy-b3d9e99f.js","./TextInput-legacy-6c467ad6.js","./DateInput.vue_vue_type_style_index_0_lang-legacy-ce20409c.js","./YesNoInput-legacy-7b08331a.js","./SelectInput-legacy-a6d48ea8.js","./location_options-legacy-b88e35fd.js","./form-legacy-ee7d8d81.js","./HIVReception-legacy-62c5af87.js","./emc_event-legacy-58754a45.js","./validations-legacy-d0f46810.js","./_plugin-vue_export-helper-legacy-762b7923.js","./his_date-legacy-f64a549a.js","./vue-datepicker-legacy-5928f51a.js","./common-legacy-0d7df615.js","./Strs-legacy-09248991.js","./toasts-legacy-f5a15cc4.js","./loader-legacy-bf01395f.js","./patient_service-legacy-8ecf55d1.js","./patient_identifier_service-legacy-8657eaa1.js","./index-legacy-aa705205.js","./Date-legacy-fdff51f2.js","./encounter_types-legacy-dd9af3d0.js","./consultation_service-legacy-d1326e30.js","./program_service-legacy-84ed4264.js"],(function(e,t){"use strict";var o,a,l,n,i,s,r,u,c,d,m,g,p,b,v,y,f,C,h,V,_,S,D,j,w,I,A,x,F,z,k;return{setters:[e=>{o=e.d,a=e.j,l=e.k,n=e.I,i=e.$,s=e.r,r=e.H,u=e.ae,c=e.a6,d=e.a2,m=e.ai,g=e.L,p=e.o,b=e.c,v=e.a,y=e.w,f=e.b,C=e.K,h=e.y},e=>{V=e.T},e=>{_=e._},e=>{S=e.Y},e=>{D=e.S},e=>{j=e.g},e=>{w=e.s},e=>{I=e.S},e=>{A=e.E,x=e.a},e=>{F=e.r,z=e.v},e=>{k=e._},null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent="ion-checkbox[data-v-cc453135]{--size: 20px!important}.options[data-v-cc453135]{height:400px;overflow-y:auto}.options ion-label span[data-v-cc453135]:hover{background-color:#ddd;padding:1rem;cursor:pointer}\n",document.head.appendChild(t);const R=o({components:{IonRow:a,IonCol:l,IonButton:n,IonTitle:i,TextInput:V,DateInput:_,YesNoInput:S,SelectInput:D},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},observations:{type:Object,default:()=>({})},initialVisitDate:{type:String,default:""},artStartDate:{type:String,default:""}},emits:["onValue","onPrevious","onFinish"],setup(e,{emit:t}){const o=s([]),a=s([]),l=r((()=>e.patient.getBirthdate())),n=new I(e.patient.getID(),e.patient.getAge(),e.initialVisitDate),i=r((()=>n.getAllReasonsForART(e.artStartDate||e.initialVisitDate,e.patient.isMale()).map((e=>({label:e.name,value:e.name}))))),g=n.getAllWhoStages().filter((e=>e.name.match(/1|2|3|4/i))).map((e=>({label:e.name,value:e.name}))),p=u({reasonsForEligibity:{value:e.observations["Reason for ART eligibility"]||"",label:"Reason for Starting",placeholder:"Select Reason for Starting",required:!0,computedValue:e=>({obs:n.buildReasonForArtObs("string"==typeof e?e:e.label)})},whoStage:{value:e.observations["Who stage"]||"",label:"Select Stage",placeholder:"Select Stage",required:!0,computedValue:e=>({obs:n.buildWhoStageObs("string"==typeof e?e:e.label)})},cd4countAvailable:{value:e.observations["CD4 count"]?"Yes":"No",label:"Recent CD4 Count results available?",required:!0},cd4CountDate:{value:e.observations["Cd4 count datetime"]||"",label:"CD4 Count date",placeholder:"CD4 Count date",computedValue:e=>({obs:n.buildValueDate("Cd4 count datetime",e)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&F(e)}},cd4Count:{value:e.observations["CD4 count"]||"",label:"CD4 Count",placeholder:"CD4 Count e.g. <100 or >500",computedValue:e=>{const t=parseInt(e.substring(1)),o=e.substring(0,1);return{modifier:o,count:t,obs:n.buildValueNumber("CD4 count",t,o)}},validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&z([()=>F(e),()=>n.cd4CountIsValid(e.value.toString())?null:["Please start with a modifier. e.g. >, <, or ="]])}},cd4CountLocation:{value:e.observations["Cd4 count location"]||"",label:"CD4 Count location",computedValue:e=>({obs:n.buildValueText("Cd4 count location","string"==typeof e?e:e.label)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&F(e)}},whoConditions:{value:e.observations["Who stages criteria present"]?[{label:e.observations["Who stages criteria present"],value:e.observations["Who stages criteria present"]}]:"",required:!0,label:"Select Staging Conditions",computedValue:e=>({obs:"string"==typeof e?n.buildWhoCriteriaObs(e):e.map((e=>n.buildWhoCriteriaObs(e.label)))})}}),b=e=>{e&&(p.whoConditions.value="");const t=parseInt((null==e?void 0:e.split(" ")[2])||"1");o.value=n.getStagingConditions(t).map((e=>({label:e.name,value:e.name,other:e}))).sort(((e,t)=>e.label.localeCompare(t.label)))};return c((()=>p.whoStage.value),(e=>b(null==e?void 0:e.label))),c((()=>p.reasonsForEligibity.value),(()=>{p.whoStage.value="",p.whoConditions.value=""})),d((()=>b())),{patientDob:l,form:p,whoStages:g,stagingCoditions:o,selectedConditions:a,reasonsForArt:i,getFacilities:j,onClear:async()=>{if(await m("Are you sure you want to clear all fields?")){for(const e in p)p[e].value=void 0,p[e].error="";A.emit(x.ON_CLEAR)}},onSubmit:async()=>{n.setDate(e.initialVisitDate),await w(p,(async(e,o)=>{t("onValue",{type:"staging",data:{formData:e,computedData:o}}),t("onFinish")}))}}}});e("default",k(R,[["render",function(e,t,o,a,l,n){const i=g("ion-title"),s=g("SelectInput"),r=g("ion-col"),u=g("yes-no-input"),c=g("DateInput"),d=g("text-input"),m=g("ion-button"),V=g("ion-row");return p(),b(C,null,[v(i,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:y((()=>[f(" Staging ")])),_:1}),v(V,{class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.reasonsForEligibity,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.reasonsForEligibity=t),options:e.reasonsForArt},null,8,["modelValue","options"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.whoStage,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.whoStage=t),options:e.whoStages},null,8,["modelValue","options"])])),_:1}),v(r,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(u,{modelValue:e.form.cd4countAvailable,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.cd4countAvailable=t),inline:""},null,8,["modelValue"])])),_:1}),"Yes"===e.form.cd4countAvailable.value?(p(),b(C,{key:0},[v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(c,{modelValue:e.form.cd4CountDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.cd4CountDate=t),"min-date":e.patientDob,"max-date":e.initialVisitDate},null,8,["modelValue","min-date","max-date"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(d,{modelValue:e.form.cd4Count,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.cd4Count=t)},null,8,["modelValue"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.cd4CountLocation,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.cd4CountLocation=t),asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","asyncOptions"])])),_:1})],64)):h("",!0),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.whoConditions,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.whoConditions=t),options:e.stagingCoditions,multiple:""},null,8,["modelValue","options"])])),_:1}),v(r,{size:"12",class:"ion-margin-top"},{default:y((()=>[v(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:y((()=>[f("Finish")])),_:1},8,["onClick"]),v(m,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:y((()=>[f("Clear")])),_:1},8,["onClick"]),v(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:t[7]||(t[7]=t=>e.$emit("onPrevious")),color:"primary"},{default:y((()=>[f("Previous")])),_:1})])),_:1})])),_:1})],64)}],["__scopeId","data-v-cc453135"]]))}}}));
