import{a as f}from"./Strs-0c962638.js";import{i as n}from"./common-abc2f84d.js";import{t as d}from"./toasts-d8ce7baa.js";import{l as c}from"./loader-3776826b.js";async function y(a){for(const s in a){const{required:r,value:e,validation:t}=a[s];if(r&&n(e))a[s].error="This field is required";else if(typeof t=="function"){const o=await t(typeof e=="object"?e:{label:e,value:e},a);a[s].error=n(o)?"":o.join()}else a[s].error=""}return Object.values(a).every(({error:s})=>!s)}function v(a,s=!1){const r={},e={};for(const t in a){const{value:i,computedValue:o}=a[t];if(i){const l=s?f(t):t;r[l]=i,typeof o=="function"&&(e[l]=o(a[t].value,a))}}return{formData:r,computedFormData:e}}function E(a,s=""){const r=Object.values(a).filter(e=>e&&(e.tag===s||s==="")).reduce((e,t)=>{const i=t.obs?t.obs:t;return Array.isArray(i)?e=e.concat(i):e.push(i),e},[]);return Promise.all(r)}async function F(a,s,r){var i,o;const e=(i=r==null?void 0:r.skipValidation)!=null?i:!1,t=(o=r==null?void 0:r.showloader)!=null?o:!0;if(!(!e&&!await y(a)))try{t&&await c.show();const{formData:l,computedFormData:u}=v(a,r==null?void 0:r.underscoreKeys);await s(l,u)}catch(l){d("".concat(l)),console.error("WELL HERE IS THE FAILURE",l)}finally{t&&await c.hide()}}export{E as a,y as i,v as r,F as s};
