import{l as f}from"./loader-1441845f.js";import{_ as x}from"./ReportTable.vue_vue_type_script_setup_true_lang-18fee1ca.js";import{A as T}from"./age_groups-8203d13f.js";import{a as D,i as _,t as M}from"./common-94ac9539.js";import{T as S}from"./tx_report_service-d2a186d5.js";import{t as F}from"./toasts-926a2fd9.js";import{d as G,S as g,o as E,h as P}from"./index-1c16650e.js";import"./exports-300de8ff.js";import"./index-e903e9ca.js";import"./his_date-3ca53c6f.js";import"./vue-datepicker-312099be.js";import"./DrilldownTable-d5470f91.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./arrays-7f14d286.js";import"./report_service-1011140c.js";import"./index-95d3a767.js";import"./url-ffe761c9.js";const Q=G({__name:"TxCurrMMD",setup(W){const d=g("-"),l=g([]),n={},i=new S,w=[{path:"ageGroup",label:"Age group",thStyles:{minWidth:"150px !important"}},{path:"gender",label:"Gender",thStyles:{minWidth:"110px !important"}},{path:"underThree",label:"# of clients on <3 months of ARVs",drillable:!0,thStyles:{minWidth:"350px !important"}},{path:"betweenThreeAndFive",label:"# of clients on 3 - 5 months of ARVs",drillable:!0,thStyles:{minWidth:"350px !important"}},{path:"overSix",label:"# of clients on >= 6 months of ARVs",drillable:!0,thStyles:{minWidth:"350px !important"}}];function b(e,o){Object.entries(o).forEach(([t,a])=>{var r;n[e]||(n[e]={}),n[e][t]=[...(r=n[e][t])!=null?r:[],...a]})}function u(e,o,t){const a=[],r=[],s=[],h=M(o),c=e[h];if(!_(c)){for(const p in c){const m=c[p].prescribed_days;m<90?a.push(p):m>=90&&m<=150?r.push(p):m>150&&s.push(p)}b(o,{underThree:a,betweenThreeAndFive:r,overSix:s})}return{overSix:s,ageGroup:t,underThree:a,betweenThreeAndFive:r,gender:h}}async function y(){const e=[],o=[];for(const t of T){const[a,r]=D(t),s=await i.getTxCurrMMDReport(a,r);e.push(u(s,"M",t)),o.push(u(s,"F",t)),i.setInitialize(!1),l.value=[...o,...e]}}function R(){l.value.push({ageGroup:"All",gender:"Male",...n.M})}async function v(){l.value=[...l.value,...await i.getMaternityData(n.F,["underThree","betweenThreeAndFive","overSix"])]}async function A({dateRange:e}){try{await f.show(),i.setStartDate(e.startDate),i.setEndDate(e.endDate),d.value=i.getDateIntervalPeriod(),await y(),R(),await v()}catch(o){F("ERROR! Unable to load report data"),console.error(o)}await f.hide()}return(e,o)=>(E(),P(x,{title:"PEPFAR TX CURR MMD Report",subtitle:"Clients that are alive and on treatment in the reporting period and the difference in days between their clinical dispensation visit and \n      next appointment / drug-runout date is: 3 months (1 - 89 days), 3 - 5 months (90 - 179 days), 6+ months (180 or more days)","report-type":"PEPFAR",columns:w,rows:l.value,period:d.value,"drill-title":t=>"".concat(t.row.ageGroup," ").concat(t.column.label," | ").concat(t.row.gender,"s"),useDateRangeFilter:"",showIndices:"",onGenerate:A},null,8,["rows","period","drill-title"]))}});export{Q as default};
