System.register(["./index-legacy-5fd00317.js","./Date-legacy-074e72e8.js","./TextInput-legacy-8725a274.js","./DateInput-legacy-c96b3246.js","./YesNoInput-legacy-244bdac1.js","./SelectInput-legacy-239ac137.js","./location_options-legacy-82bffb9f.js","./his_date-legacy-f511c580.js","./form-legacy-14cfe3a7.js","./HIVReception-legacy-81098a49.js","./emc_event-legacy-58754a45.js","./validations-legacy-470ac0cd.js","./_plugin-vue_export-helper-legacy-762b7923.js","./vue-datepicker-legacy-672cca54.js","./common-legacy-42ce034b.js","./Strs-legacy-09248991.js","./toasts-legacy-8814bb27.js","./loader-legacy-26a3e1a4.js","./ApiStore-legacy-c5c69548.js","./program_service-legacy-a2774ffc.js","./image-legacy-0b5f9ca9.js","./index-legacy-aa705205.js","./user_service-legacy-e7c827a3.js","./patient_service-legacy-68412ff5.js","./patient_identifier_service-legacy-c96f3e39.js","./services-legacy-03115b96.js","./encounter_types-legacy-566983b4.js"],(function(e,t){"use strict";var o,a,l,n,i,s,r,u,c,d,m,g,p,b,v,y,f,C,h,S,V,j,D,_,w,I,A,x,F,z,R,k,O,W;return{setters:[e=>{o=e.d,a=e._,l=e.$,n=e.I,i=e.N,s=e.S,r=e.g,u=e.a8,c=e.Z,d=e.T,m=e.ac,g=e.r,p=e.o,b=e.c,v=e.a,y=e.w,f=e.b,C=e.F,h=e.j},e=>{S=e.S},e=>{V=e.T},e=>{j=e.D},e=>{D=e.Y},e=>{_=e.S},e=>{w=e.g},e=>{I=e.d},e=>{A=e.s},e=>{x=e.S},e=>{F=e.E,z=e.a},e=>{R=e.d,k=e.v,O=e.r},e=>{W=e._},null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){var t=document.createElement("style");t.textContent="ion-checkbox[data-v-46029383]{--size: 20px!important}.options[data-v-46029383]{height:400px;overflow-y:auto}.options ion-label span[data-v-46029383]:hover{background-color:#ddd;padding:1rem;cursor:pointer}\n",document.head.appendChild(t);const T=o({components:{IonRow:a,IonCol:l,IonButton:n,IonTitle:i,TextInput:V,DateInput:j,YesNoInput:D,SelectInput:_},props:{patient:{type:Object,required:!0},isNewPatient:{type:Boolean,default:!0},observations:{type:Object,default:()=>({})},initialVisitDate:{type:String,default:""},artStartDate:{type:String,default:""}},emits:["onValue","onPrevious","onFinish"],setup(e,{emit:t}){const o=s([]),a=s([]),l=I().format(S),n=r((()=>{const t=e.patient.getBirthdate();return t?I(t).format(S):""})),i=new x(e.patient.getID(),e.patient.getAge(),-1),g=r((()=>i.getAllReasonsForART(e.artStartDate||e.initialVisitDate,e.patient.isMale()).map((e=>({label:e.name,value:e.name}))))),p=i.getAllWhoStages().filter((e=>e.name.match(/1|2|3|4/i))).map((e=>({label:e.name,value:e.name}))),b=u({reasonsForEligibity:{value:e.observations["Reason for ART eligibility"]||"",label:"Reason for Starting",placeholder:"Select Reason for Starting",required:!0,computedValue:e=>({obs:i.buildReasonForArtObs("string"==typeof e?e:e.label)})},whoStage:{value:e.observations["Who stage"]||"",label:"Select Stage",placeholder:"Select Stage",required:!0,computedValue:e=>({obs:i.buildWhoStageObs("string"==typeof e?e:e.label)})},cd4countAvailable:{value:e.observations["CD4 count"]?"Yes":"No",label:"Recent CD4 Count results available?",required:!0},cd4CountDate:{value:e.observations["Cd4 count datetime"]||"",label:"CD4 Count date",placeholder:"CD4 Count date",computedValue:e=>({obs:x.buildValueDate("Cd4 count datetime",e)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&R(e)}},cd4Count:{value:e.observations["CD4 count"]||"",label:"CD4 Count",placeholder:"CD4 Count e.g. <100 or >500",computedValue:e=>{const t=parseInt(e.substring(1)),o=e.substring(0,1);return{modifier:o,count:t,obs:x.buildValueNumber("CD4 count",t,o)}},validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&k([()=>O(e),()=>i.cd4CountIsValid(e.value.toString())?null:["Please start with a modifier. e.g. >, <, or ="]])}},cd4CountLocation:{value:e.observations["Cd4 count location"]||"",label:"CD4 Count location",computedValue:e=>({obs:x.buildValueText("Cd4 count location","string"==typeof e?e:e.label)}),validation:async(e,t)=>{var o;return"Yes"===(null===(o=t.cd4countAvailable)||void 0===o?void 0:o.value)&&R(e)}},whoConditions:{value:e.observations["Who stages criteria present"]?[{label:e.observations["Who stages criteria present"],value:e.observations["Who stages criteria present"]}]:"",required:!0,label:"Select Staging Conditions",computedValue:e=>({obs:"string"==typeof e?i.buildWhoCriteriaObs(e):e.map((e=>i.buildWhoCriteriaObs(e.label)))})}}),v=e=>{e&&(b.whoConditions.value="");const t=parseInt((null==e?void 0:e.split(" ")[2])||"1");o.value=i.getStagingConditions(t).map((e=>({label:e.name,value:e.name,other:e}))).sort(((e,t)=>e.label.localeCompare(t.label)))};return c((()=>b.whoStage.value),(e=>v(null==e?void 0:e.label))),c((()=>b.reasonsForEligibity.value),(()=>{b.whoStage.value="",b.whoConditions.value=""})),d((()=>v())),{today:l,patientDob:n,form:b,whoStages:p,stagingCoditions:o,selectedConditions:a,reasonsForArt:g,getFacilities:w,onClear:async()=>{if(await m("Are you sure you want to clear all fields?")){for(const e in b)b[e].value=void 0,b[e].error="";F.emit(z.ON_CLEAR)}},onSubmit:async()=>{i.setDate(e.initialVisitDate),await A(b,(async(e,o)=>{t("onValue",{type:"staging",data:{formData:e,computedData:o}}),t("onFinish")}))}}}});e("default",W(T,[["render",function(e,t,o,a,l,n){const i=g("ion-title"),s=g("SelectInput"),r=g("ion-col"),u=g("yes-no-input"),c=g("DateInput"),d=g("text-input"),m=g("ion-button"),S=g("ion-row");return p(),b(C,null,[v(i,{class:"ion-text-center ion-margin-vertical ion-padding-bottom bold"},{default:y((()=>[f(" Staging ")])),_:1}),v(S,{class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.reasonsForEligibity,"onUpdate:modelValue":t[0]||(t[0]=t=>e.form.reasonsForEligibity=t),options:e.reasonsForArt},null,8,["modelValue","options"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.whoStage,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.whoStage=t),options:e.whoStages},null,8,["modelValue","options"])])),_:1}),v(r,{size:"12",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(u,{modelValue:e.form.cd4countAvailable,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.cd4countAvailable=t),inline:""},null,8,["modelValue"])])),_:1}),"Yes"===e.form.cd4countAvailable.value?(p(),b(C,{key:0},[v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(c,{modelValue:e.form.cd4CountDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.cd4CountDate=t),"min-date":e.patientDob,"max-date":e.today},null,8,["modelValue","min-date","max-date"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(d,{modelValue:e.form.cd4Count,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.cd4Count=t)},null,8,["modelValue"])])),_:1}),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.cd4CountLocation,"onUpdate:modelValue":t[5]||(t[5]=t=>e.form.cd4CountLocation=t),asyncOptions:e.getFacilities,allowCustom:""},null,8,["modelValue","asyncOptions"])])),_:1})],64)):h("",!0),v(r,{size:"6",class:"ion-margin-top ion-margin-bottom"},{default:y((()=>[v(s,{modelValue:e.form.whoConditions,"onUpdate:modelValue":t[6]||(t[6]=t=>e.form.whoConditions=t),options:e.stagingCoditions,multiple:""},null,8,["modelValue","options"])])),_:1}),v(r,{size:"12",class:"ion-margin-top"},{default:y((()=>[v(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:e.onSubmit,color:"success"},{default:y((()=>[f("Finish")])),_:1},8,["onClick"]),v(m,{class:"ion-margin-top ion-float-right",size:"large",color:"warning",onClick:e.onClear},{default:y((()=>[f("Clear")])),_:1},8,["onClick"]),v(m,{class:"ion-margin-top ion-float-right",size:"large",onClick:t[7]||(t[7]=t=>e.$emit("onPrevious")),color:"primary"},{default:y((()=>[f("Previous")])),_:1})])),_:1})])),_:1})],64)}],["__scopeId","data-v-46029383"]]))}}}));
