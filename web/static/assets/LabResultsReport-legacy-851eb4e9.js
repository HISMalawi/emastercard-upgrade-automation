<<<<<<<< HEAD:web/static/assets/LabResultsReport-legacy-51492cc6.js
System.register(["./loader-legacy-61800ad3.js","./ReportTable.vue_vue_type_style_index_0_lang-legacy-a2bdce8d.js","./toasts-legacy-ce48abc6.js","./common-legacy-0d7df615.js","./his_date-legacy-70b43096.js","./index-legacy-2d6958b4.js","./report_service-legacy-a3c5dfb2.js","./age_groups-legacy-5143fd58.js","./exports-legacy-afecb6b7.js","./index-legacy-728fa8e9.js","./vue-datepicker-legacy-64b30e6f.js","./DrilldownTable-legacy-e1e21b40.js","./arrays-legacy-e3b1d86b.js","./url-legacy-2d97b2db.js"],(function(e,a){"use strict";var t,l,r,s,u,i,n,o,d,g,p,c,b,v,h,m;return{setters:[e=>{t=e.l},e=>{l=e.g,r=e._},e=>{s=e.t},e=>{u=e.i,i=e.t,n=e.p},e=>{o=e.t},e=>{d=e.dD,g=e.d,p=e.r,c=e.h,b=e.o,v=e.j},e=>{h=e.R},e=>{m=e.A},null,null,null,null,null,null],execute:function(){class a extends h{constructor(){super(),this.programId=d}buildLabPatientLevelData(e){return e.flatMap((e=>e.measures.map((a=>({...e,test_name:a.name,result:`${a.modifier} ${a.value}`})))))}buildLabResultRowData(e,a,t){const l=e.filter((e=>e.gender===t&&e.age_group===a)).map((({patient_id:e})=>e));return{ageGroup:a,gender:t,viral_load:l}}buildLabDisaggregatedData(e){const a=[],t=[];return m.forEach((l=>{a.push(this.buildLabResultRowData(e,l,"M")),t.push(this.buildLabResultRowData(e,l,"F"))})),[...t,...a]}async getLabResultReport(){const e=await this.getReport("lab_test_results");if(!e)return{};const a=this.buildLabPatientLevelData(e);return{patientLevelData:a,disaggregatedData:this.buildLabDisaggregatedData(a)}}}e("default",g({__name:"LabResultsReport",setup(e){const d=p("-"),g=p(""),h=[l("patient_id")],m=p({}),y=c((()=>u(m.value)?[]:"disaggregated"===g.value?m.value.disaggregatedData:m.value.patientLevelData)),_=c((()=>"disaggregated"===g.value?[{path:"ageGroup",label:"Age Group"},{path:"gender",label:"Gender",formatter:i},{path:"viral_load",label:"HIV viral load",drillable:!0}]:[{path:"arv_number",label:"ARV Number",preSort:n,initialSort:!0},{path:"gender",label:"Gender",formatter:i},{path:"birthdate",label:"Birthdate",formatter:o},{path:"order_date",label:"Ordered",formatter:o},{path:"test",label:"Specimen"},{path:"test_name",label:"Test"},{path:"result",label:"Result"},{path:"result_date",label:"Released",formatter:o}])),R=c((()=>[{id:"type",label:"Select report type",required:!1,type:"select",options:[{label:"Disaggregated",value:"disaggregated"},{label:"Patient level",value:"patient_level"}],onUpdate:e=>{g.value=e.value}}]));async function D(e){await t.show();try{const t=new a;t.setStartDate(e.dateRange.startDate),t.setEndDate(e.dateRange.endDate),d.value=t.getDateIntervalPeriod(),m.value=await t.getLabResultReport()}catch(l){s("Unable to load report data"),console.error(l)}await t.hide()}return(e,a)=>(b(),v(r,{"report-type":"Clinic",title:"Lab Test Result(s) Report",columns:_.value,rows:y.value,period:d.value,"row-action-buttons":h,"custom-filters":R.value,"use-date-range-filter":"","use-secure-export":"",onGenerate:D},null,8,["columns","rows","period","custom-filters"]))}}))}}}));
========
System.register(["./loader-legacy-805839f7.js","./ReportTable.vue_vue_type_style_index_0_lang-legacy-4bb553ac.js","./toasts-legacy-14f1e720.js","./common-legacy-0d7df615.js","./his_date-legacy-0bc670a8.js","./index-legacy-a3ed4133.js","./report_service-legacy-1e7510ae.js","./age_groups-legacy-5143fd58.js","./exports-legacy-260ef973.js","./index-legacy-d4a0fad1.js","./vue-datepicker-legacy-fdf7a164.js","./DrilldownTable-legacy-640fced2.js","./arrays-legacy-4be31994.js","./url-legacy-2d97b2db.js"],(function(e,a){"use strict";var t,l,r,s,u,i,n,o,d,g,p,c,b,v,h,y;return{setters:[e=>{t=e.l},e=>{l=e.g,r=e._},e=>{s=e.t},e=>{u=e.i,i=e.t,n=e.p},e=>{o=e.t},e=>{d=e.dF,g=e.d,p=e.r,c=e.h,b=e.o,v=e.j},e=>{h=e.R},e=>{y=e.A},null,null,null,null,null,null],execute:function(){class a extends h{constructor(){super(),this.programId=d}buildLabPatientLevelData(e){return e.flatMap((e=>e.measures.map((a=>({...e,test_name:a.name,result:`${a.modifier} ${a.value}`})))))}buildLabResultRowData(e,a,t){const l=e.filter((e=>e.gender===t&&e.age_group===a)).map((({patient_id:e})=>e));return{ageGroup:a,gender:t,viral_load:l}}buildLabDisaggregatedData(e){const a=[],t=[];return y.forEach((l=>{a.push(this.buildLabResultRowData(e,l,"M")),t.push(this.buildLabResultRowData(e,l,"F"))})),[...t,...a]}async getLabResultReport(){const e=await this.getReport("lab_test_results");if(!e)return{};const a=this.buildLabPatientLevelData(e);return{patientLevelData:a,disaggregatedData:this.buildLabDisaggregatedData(a)}}}e("default",g({__name:"LabResultsReport",setup(e){const d=p("-"),g=p(""),h=[l("patient_id")],y=p({}),_=c((()=>u(y.value)?[]:"disaggregated"===g.value?y.value.disaggregatedData:y.value.patientLevelData)),m=c((()=>"disaggregated"===g.value?[{path:"ageGroup",label:"Age Group"},{path:"gender",label:"Gender",formatter:i},{path:"viral_load",label:"HIV viral load",drillable:!0}]:[{path:"arv_number",label:"ARV Number",preSort:n,initialSort:!0},{path:"gender",label:"Gender",formatter:i},{path:"birthdate",label:"Birthdate",formatter:o},{path:"order_date",label:"Ordered",formatter:o},{path:"test",label:"Specimen"},{path:"test_name",label:"Test"},{path:"result",label:"Result"},{path:"result_date",label:"Released",formatter:o}])),R=c((()=>[{id:"type",label:"Select report type",required:!1,type:"select",options:[{label:"Disaggregated",value:"disaggregated"},{label:"Patient level",value:"patient_level"}],onUpdate:e=>{g.value=e.value}}]));async function D(e){await t.show();try{const t=new a;t.setStartDate(e.dateRange.startDate),t.setEndDate(e.dateRange.endDate),d.value=t.getDateIntervalPeriod(),y.value=await t.getLabResultReport()}catch(l){s("Unable to load report data"),console.error(l)}await t.hide()}return(e,a)=>(b(),v(r,{"report-type":"Clinic",title:"Lab Test Result(s) Report",columns:m.value,rows:_.value,period:d.value,"row-action-buttons":h,"custom-filters":R.value,"use-date-range-filter":"","use-secure-export":"",onGenerate:D},null,8,["columns","rows","period","custom-filters"]))}}))}}}));
>>>>>>>> d5dde79c4b802565fbd74045759fafa02ba3a825:web/static/assets/LabResultsReport-legacy-851eb4e9.js
