import{d as C,k as L,aK as U,d2 as O,ak as A,d9 as Y,I as _,i as J,da as K,S as V,g as $,Z as M,T,a1 as z,r as u,c as p,h as E,w as D,j as h,aa as P,f as R,a as f,F as q,o as n,t as g,b as S,q as Z}from"./index-1c16650e.js";import{d as i,e as j,i as G,t as N}from"./his_date-3ca53c6f.js";import{e as H}from"./validations-11aef89d.js";import{E as Q,a as W}from"./emc_event-4721851b.js";import{K as X}from"./vue-datepicker-312099be.js";import{i as B}from"./common-94ac9539.js";import{_ as x}from"./_plugin-vue_export-helper-c27b6911.js";const ee=C({name:"DateInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},minDate:{type:[String,Function],required:!1},maxDate:{type:[String,Function],required:!1},allowEstimation:{type:Boolean,default:!1},estimationLabel:{type:String,default:"Estimate"}},components:{IonLabel:L,IonInput:U,IonNote:O,IonCheckbox:A,IonSelect:Y,IonButton:_,IonIcon:J,IonSelectOption:K,VueDatePicker:X},emits:["update:modelValue","isEstimated"],setup(e,{emit:o}){const b=V(!1),y=V(),d=V(e.modelValue.value?i(e.modelValue.value).date():void 0),m=V(e.modelValue.value?i(e.modelValue.value).month()+1:0),s=V(e.modelValue.value?i(e.modelValue.value).year():void 0),w=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=V(e.modelValue.value),v=$(()=>{const a=typeof e.minDate=="function"?e.minDate():e.minDate;return B(a)?"":j(a)}),c=$(()=>{const a=typeof e.maxDate=="function"?e.maxDate():e.maxDate;return B(a)?"":j(a)}),t=$({get:()=>e.modelValue?e.modelValue:{},set:a=>o("update:modelValue",a)}),F=a=>{var l;t.value.error=(l=H({value:a.target.value}))==null?void 0:l.join(),t.value.error||(y.value=parseInt(a.target.value)),I()},I=async()=>{let a="";if(b.value&&y.value)a=G(y.value);else if(d.value||m.value||s.value){const l="".concat(s.value,"-").concat(m.value,"-").concat(d.value);if(l.match(/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])$/))a=j(l);else return t.value.error="Invalid date"}if(t.value.required&&!a)return t.value.error="This field is required";if(v.value&&new Date(a)<new Date(v.value))return t.value.error=b.value?"Estimated period must be less than or equal to ".concat(i().diff(v.value,"years")," years"):"Date must be after ".concat(N(v.value));if(c.value&&new Date(a)>new Date(c.value))return t.value.error=b.value?"Estimated period must be more than or equal to 0 years":"Date must be before ".concat(N(c.value));if(t.value.validation){const l=await t.value.validation({label:a,value:a},e.form);if(l&&l.length)return t.value.error+=l.toString()}t.value.error="",t.value.value=a};M(r,a=>{d.value=i(a).date(),m.value=i(a).month()+1,s.value=i(a).year(),I()});const k=()=>{y.value=void 0,d.value=void 0,m.value=0,s.value=void 0,t.value.error="",r.value=""};return M(()=>e.modelValue.value,a=>{d.value=a?i(a).date():void 0,m.value=a?i(a).month()+1:0,s.value=a?i(a).year():void 0,r.value=a}),M(b,a=>{k(),o("isEstimated",a)}),T(()=>Q.on(W.ON_CLEAR,k)),{validate:I,onEstimate:F,pickerDate:r,isEstimated:b,model:t,age:y,day:d,month:m,year:s,months:w,calendar:z,computedMinDate:v,computedMaxDate:c}}});const ae={key:0},oe={key:1},te={key:2,class:"text-danger"},le={key:3,class:"ion-float-right ion-margin-end checkbox-label"},ne={key:2,style:{display:"flex","justify-content":"flex-start","justify-items":"center"}},ie={style:{"margin-top":".7rem","flex-grow":"1"}};function ue(e,o,b,y,d,m){const s=u("ion-checkbox"),w=u("ion-label"),r=u("ion-input"),v=u("ion-icon"),c=u("ion-button"),t=u("vue-date-picker"),F=u("ion-select-option"),I=u("ion-select"),k=u("ion-note");return n(),p(q,null,[e.model.label?(n(),E(w,{key:0,class:"ion-padding-bottom bold"},{default:D(()=>[e.isEstimated?(n(),p("span",ae,g(e.estimationLabel),1)):(n(),p("span",oe,g(e.model.label),1)),e.model.required?(n(),p("span",te," *")):h("",!0),e.allowEstimation?(n(),p("span",le,[S(" Estimate "+g(e.model.label)+" ",1),f(s,{modelValue:e.isEstimated,"onUpdate:modelValue":o[0]||(o[0]=a=>e.isEstimated=a)},null,8,["modelValue"])])):h("",!0)]),_:1})):h("",!0),e.isEstimated?(n(),E(r,{key:1,type:"number",class:P(["ion-margin-top",e.model.error?"box-input-error":"box-input"]),modelValue:e.age,"onUpdate:modelValue":o[1]||(o[1]=a=>e.age=a),placeholder:e.estimationLabel,disabled:e.model.disabled,min:1,onIonInput:e.onEstimate,onIonFocus:o[2]||(o[2]=()=>e.model.error="")},null,8,["class","modelValue","placeholder","disabled","onIonInput"])):(n(),p("div",ne,[R("div",ie,[f(t,{modelValue:e.pickerDate,"onUpdate:modelValue":o[3]||(o[3]=a=>e.pickerDate=a),"enable-time-picker":!1,maxDate:e.computedMaxDate,minDate:e.computedMinDate},{trigger:D(()=>[f(c,null,{default:D(()=>[f(v,{icon:e.calendar},null,8,["icon"])]),_:1})]),_:1},8,["modelValue","maxDate","minDate"])]),f(r,{modelValue:e.day,"onUpdate:modelValue":o[4]||(o[4]=a=>e.day=a),min:1,max:31,class:"ion-margin-top",fill:"outline",style:{"flex-grow":"2"},type:"number",placeholder:"DD",disabled:e.model.disabled,onIonFocus:o[5]||(o[5]=()=>e.model.error=""),onIonInput:e.validate},null,8,["modelValue","disabled","onIonInput"]),f(I,{modelValue:e.month,"onUpdate:modelValue":o[6]||(o[6]=a=>e.month=a),"aria-label":"Months",interface:"popover",placeholder:"MM",class:"ion-margin-top ion-margin-horizontal",fill:"outline",justify:"end",disabled:e.model.disabled,onIonFocus:o[7]||(o[7]=()=>e.model.error=""),onIonInput:e.validate},{default:D(()=>[(n(!0),p(q,null,Z(e.months,(a,l)=>(n(),E(F,{value:l+1,key:l},{default:D(()=>[S(g(a),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","disabled","onIonInput"]),f(r,{modelValue:e.year,"onUpdate:modelValue":o[8]||(o[8]=a=>e.year=a),min:1900,class:"ion-margin-top",fill:"outline",style:{"flex-grow":"2"},type:"number",placeholder:"YYYY",disabled:e.model.disabled,onIonFocus:o[9]||(o[9]=()=>e.model.error=""),onIonInput:e.validate},null,8,["modelValue","disabled","onIonInput"])])),e.model.error?(n(),E(k,{key:3,color:"danger"},{default:D(()=>[S(g(e.model.error),1)]),_:1})):h("",!0)],64)}const be=x(ee,[["render",ue]]);export{be as D};
