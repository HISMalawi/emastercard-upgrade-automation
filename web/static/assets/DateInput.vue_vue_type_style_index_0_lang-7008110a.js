import{d as O,r as y,F as E,a4 as w,a0 as A,c as f,g as F,w as b,u,v as k,ae as Y,a as J,e as d,H as j,o as n,t as I,b as h,ap as z,G as K,x as B,I as T,q as G,a6 as H,L as R,dk as P,dl as Q,ao as W}from"./index-b34da4cb.js";import{d as r,c as S,h as X,t as L}from"./his_date-3774cb27.js";import{d as Z}from"./validations-b9fbcec4.js";import{E as ee,a as ae}from"./emc_event-4721851b.js";import{K as le}from"./vue-datepicker-bce64927.js";import{i as _}from"./common-abc2f84d.js";const te={key:0},oe={key:1},ue={key:2,class:"text-danger"},ne={key:3,class:"ion-float-right ion-margin-end checkbox-label"},re={key:2,style:{display:"flex","justify-content":"flex-start","justify-items":"center"}},se={style:{"margin-top":"0.7rem","flex-grow":"1"}},ce=O({__name:"DateInput",props:{modelValue:{type:Object,default:()=>({})},form:{type:Object,default:()=>({})},minDate:{type:[String,Function],required:!1},maxDate:{type:[String,Function],required:!1},allowEstimation:{type:Boolean,default:!1},estimationLabel:{type:String,default:"Estimate"}},emits:["update:modelValue","isEstimated"],setup(D,{emit:$}){const t=D,q=$,s=y(!1),c=y(),m=y(t.modelValue.value?r(t.modelValue.value).date():void 0),v=y(t.modelValue.value?r(t.modelValue.value).month()+1:0),p=y(t.modelValue.value?r(t.modelValue.value).year():void 0),V=y(t.modelValue.value),C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],g=E(()=>{const e=typeof t.minDate=="function"?t.minDate():t.minDate;return _(e)?"":S(e)}),x=E(()=>{const e=typeof t.maxDate=="function"?t.maxDate():t.maxDate;return _(e)?"":S(e)}),l=E({get:()=>t.modelValue?t.modelValue:{},set:e=>q("update:modelValue",e)}),U=e=>{var a;l.value.error=(a=Z({value:e.target.value}))==null?void 0:a.join(),l.value.error||(c.value=parseInt(e.target.value)),i()},i=async()=>{let e="";if(s.value&&c.value)e=X(c.value);else if(m.value||v.value||p.value){const a="".concat(p.value,"-").concat(v.value,"-").concat(m.value);if(a.match(/^\d{4}-(0?[1-9]|1[012])-(0?[1-9]|[12][0-9]|3[01])$/))e=S(a);else return l.value.error="Invalid date"}if(l.value.required&&!e)return l.value.error="This field is required";if(g.value&&new Date(e)<new Date(g.value))return l.value.error=s.value?"Estimated period must be less than or equal to ".concat(r().diff(g.value,"years")," years"):"Date must be after ".concat(L(g.value));if(x.value&&new Date(e)>new Date(x.value))return l.value.error=s.value?"Estimated period must be more than or equal to 0 years":"Date must be before ".concat(L(x.value));if(l.value.validation){const a=await l.value.validation({label:e,value:e},t.form);if(a&&a.length)return l.value.error+=a.toString()}l.value.error="",l.value.value=e};w(V,e=>{m.value=r(e).date(),v.value=r(e).month()+1,p.value=r(e).year(),i()});const M=()=>{c.value=void 0,m.value=void 0,v.value=0,p.value=void 0,l.value.error="",V.value=""};return w(()=>t.modelValue.value,e=>{m.value=e?r(e).date():void 0,v.value=e?r(e).month()+1:0,p.value=e?r(e).year():void 0,V.value=e}),w(s,e=>{M(),q("isEstimated",e)}),A(()=>ee.on(ae.ON_CLEAR,M)),(e,a)=>(n(),f(j,null,[l.value.label?(n(),F(u(K),{key:0,class:"ion-padding-bottom bold"},{default:b(()=>[s.value?(n(),f("span",te,I(D.estimationLabel),1)):(n(),f("span",oe,I(l.value.label),1)),l.value.required?(n(),f("span",ue," *")):k("",!0),D.allowEstimation?(n(),f("span",ne,[h(" Estimate "+I(l.value.label)+" ",1),d(u(z),{modelValue:s.value,"onUpdate:modelValue":a[0]||(a[0]=o=>s.value=o)},null,8,["modelValue"])])):k("",!0)]),_:1})):k("",!0),s.value?(n(),F(u(B),{key:1,type:"number",class:Y(["ion-margin-top",l.value.error?"box-input-error":"box-input"]),modelValue:c.value,"onUpdate:modelValue":a[1]||(a[1]=o=>c.value=o),placeholder:D.estimationLabel,disabled:l.value.disabled,min:1,onIonInput:U,onIonFocus:a[2]||(a[2]=()=>l.value.error="")},null,8,["class","modelValue","placeholder","disabled"])):(n(),f("div",re,[J("div",se,[d(u(le),{"auto-apply":"",modelValue:V.value,"onUpdate:modelValue":a[3]||(a[3]=o=>V.value=o),teleport:!0,"enable-time-picker":!1,maxDate:x.value,minDate:g.value},{trigger:b(()=>[d(u(T),null,{default:b(()=>[d(u(G),{icon:u(H)},null,8,["icon"])]),_:1})]),_:1},8,["modelValue","maxDate","minDate"])]),d(u(B),{modelValue:m.value,"onUpdate:modelValue":a[4]||(a[4]=o=>m.value=o),min:1,max:31,class:"ion-margin-top",fill:"outline",style:{"flex-grow":"2"},type:"number",placeholder:"DD",disabled:l.value.disabled,onIonFocus:a[5]||(a[5]=()=>l.value.error=""),onIonInput:i,onIonBlur:i},null,8,["modelValue","disabled"]),d(u(Q),{modelValue:v.value,"onUpdate:modelValue":a[6]||(a[6]=o=>v.value=o),"aria-label":"Months",interface:"popover",placeholder:"MM",class:"ion-margin-top ion-margin-horizontal",fill:"outline",justify:"end",disabled:l.value.disabled,onIonFocus:a[7]||(a[7]=()=>l.value.error=""),onIonInput:i,onIonBlur:i},{default:b(()=>[(n(),f(j,null,R(C,(o,N)=>d(u(P),{value:N+1,key:N},{default:b(()=>[h(I(o),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue","disabled"]),d(u(B),{modelValue:p.value,"onUpdate:modelValue":a[8]||(a[8]=o=>p.value=o),min:1900,class:"ion-margin-top",fill:"outline",style:{"flex-grow":"2"},type:"number",placeholder:"YYYY",disabled:l.value.disabled,onIonFocus:a[9]||(a[9]=()=>l.value.error=""),onIonInput:i,onIonBlur:i},null,8,["modelValue","disabled"])])),l.value.error?(n(),F(u(W),{key:3,color:"danger"},{default:b(()=>[h(I(l.value.error),1)]),_:1})):k("",!0)],64))}});export{ce as _};
