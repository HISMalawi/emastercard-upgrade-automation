import{l as m}from"./loader-464dccb0.js";import{_ as y}from"./ReportTable.vue_vue_type_style_index_0_lang-ef0d2343.js";import{t as o}from"./toasts-3ce877d4.js";import{P as w}from"./patient_identifier_service-2b86717b.js";import{t as g}from"./Strs-0c962638.js";import{t as c}from"./his_date-61f0525f.js";import{D as I}from"./DrilldownTable-195b2a77.js";import{d as D,r as a,h as B,i as F,j as M,am as p,an as N,o as S}from"./index-cea95aa1.js";import{p as T}from"./VoidReason-82640d50.js";import"./exports-7e778375.js";import"./index-b9b8006b.js";import"./vue-datepicker-f625d37c.js";import"./common-abc2f84d.js";import"./arrays-1b521787.js";const E=D({__name:"MultipleIdentifiers",setup(k){const n=a([]),l=a(),i=new w,s=a([]),f=[{path:"given_name",label:"First Name"},{path:"family_name",label:"Last Name"},{path:"gender",label:"Gender",formatter:g},{path:"birthdate",label:"Date of Birth",formatter:c},{path:"latest_identifier",label:"Latest Identifier"},{path:"identifiers",label:"Number of Identifiers",drillable:!0}],u=[{path:"identifier",label:"Identifier"},{path:"date_created",label:"Date created",formatter:c}],h=B(()=>[{id:"identifier",label:"Select Identifier type",type:"select",gridSize:5,options:s.value}]);async function _(e){return p.show(I,{title:"Identifiers belonging to client: ".concat(e.row.given_name," ").concat(e.row.family_name),columns:u,rows:e.row.identifiers,rowActionButtons:[{label:"void",color:"danger",icon:N,action:t=>T(async r=>{var d;try{await i.voidMultipleIdentifiers([t.identifier],r,Number((d=l.value)==null?void 0:d.value)),p.hide()}catch(v){o("Failed to void identifier"),console.error(v)}},"void-modal custom-modal-backdrop")}]})}async function b({identifier:e}){var t;try{m.show(),l.value=e,n.value=(t=await i.getMultipleIdentifiers(e.value))!=null?t:[]}catch(r){o("Failed to load report data"),console.error(r)}finally{m.hide()}}return F(async()=>{try{const e=await i.getIdentifierTypes();s.value=e.map(t=>({label:t.name,value:t.patient_identifier_type_id,other:t}))}catch(e){console.error(e),o("Failed to load identifier types")}}),(e,t)=>(S(),M(y,{title:"Multiple Identifiers",columns:f,rows:n.value,"custom-filters":h.value,"custom-drill-handler":_,onGenerate:b},null,8,["rows","custom-filters"]))}});export{E as default};
