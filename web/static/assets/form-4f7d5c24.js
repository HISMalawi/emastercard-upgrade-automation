import{a as u}from"./Strs-0c962638.js";import{i as l}from"./common-abc2f84d.js";import{t as f}from"./toasts-b005746b.js";import{l as c}from"./loader-4fe30858.js";async function d(r){for(const t in r){const{required:s,value:e,validation:a}=r[t];if(s&&l(e)){r[t].error="This field is required";continue}if(typeof a=="function"){const i=await a(typeof e=="object"?e:{label:e,value:e},r);r[t].error=l(i)?"":i.join()}else r[t].error=""}return Object.values(r).every(({error:t})=>!t)}function y(r,t=!1){const s={},e={};for(const a in r){const{value:o,computedValue:i}=r[a];if(o){const n=t?u(a):a;s[n]=o,typeof i=="function"&&(e[n]=i(r[a].value,r))}}return{formData:s,computedFormData:e}}function h(r,t=""){const s=Object.values(r).filter(e=>e&&(e.tag===t||t==="")).reduce((e,a)=>{const o=a.obs?a.obs:a;return Array.isArray(o)?e=e.concat(o):e.push(o),e},[]);return Promise.all(s)}async function p(r,t,s){var a;if(!await d(r))return;const e=(a=s==null?void 0:s.showloader)!=null?a:!0;try{e&&await c.show();const{formData:o,computedFormData:i}=y(r,s==null?void 0:s.underscoreKeys);await t(o,i)}catch(o){f("".concat(o)),console.error("WELL HERE IS THE FAILURE",o)}finally{e&&await c.hide()}}export{h as a,d as i,y as r,p as s};
